<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>ContextLogger2 Logger Daemon Internals: libluasqlite3.c Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="dir_ce488f798153ac6666006744a35bf93c.html">src</a>
  </div>
</div>
<div class="contents">
<h1>libluasqlite3.c</h1><a href="libluasqlite3_8c.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/*</span>
<a name="l00002"></a>00002 <span class="comment"></span>
<a name="l00003"></a>00003 <span class="comment">lua-sqlite3 does not directly work for us. For one thing, we do not</span>
<a name="l00004"></a>00004 <span class="comment">want the user to be able to choose what database to open. The database</span>
<a name="l00005"></a>00005 <span class="comment">to access is our LogDb, and access to anything else is not to be</span>
<a name="l00006"></a>00006 <span class="comment">allowed. (ConfigDb database is not to be accessed directly at all.)</span>
<a name="l00007"></a>00007 <span class="comment"></span>
<a name="l00008"></a>00008 <span class="comment">lua-sqlite3 ought to nonetheless be as good a starting point as any</span>
<a name="l00009"></a>00009 <span class="comment">for implementing the access we require.</span>
<a name="l00010"></a>00010 <span class="comment"></span>
<a name="l00011"></a>00011 <span class="comment">LogDb access is also to be controlled quite carefully, and also, any</span>
<a name="l00012"></a>00012 <span class="comment">requirements for mutex access are to be implemented. Unfortunately, to</span>
<a name="l00013"></a>00013 <span class="comment">allow for interactive sessions, we cannot just go and lock the</span>
<a name="l00014"></a>00014 <span class="comment">database for the duration of any user session. Luckily, on Symbian we</span>
<a name="l00015"></a>00015 <span class="comment">presently have no need for MT, and Symbian&apos;s SQL Engine presumably</span>
<a name="l00016"></a>00016 <span class="comment">supports locking at the database level. And a proper SQLite library on</span>
<a name="l00017"></a>00017 <span class="comment">Linux should support locking. So there may be little that we have to</span>
<a name="l00018"></a>00018 <span class="comment">do when it comes to protection against concurrent modification, but</span>
<a name="l00019"></a>00019 <span class="comment">better keep this in mind.</span>
<a name="l00020"></a>00020 <span class="comment"></span>
<a name="l00021"></a>00021 <span class="comment">Note that most of the lua-sqlite3 functions like to just return an</span>
<a name="l00022"></a>00022 <span class="comment">error code, and are meant to be used with a Lua wrapper, I suppose. We</span>
<a name="l00023"></a>00023 <span class="comment">do not intend to use any wrapper, and hence shall be changing this for</span>
<a name="l00024"></a>00024 <span class="comment">any functions that we are planning to use. We shall be creating Lua</span>
<a name="l00025"></a>00025 <span class="comment">VMs left and right, and we want that to stay fast.</span>
<a name="l00026"></a>00026 <span class="comment"></span>
<a name="l00027"></a>00027 <span class="comment"> */</span>
<a name="l00028"></a>00028 
<a name="l00029"></a>00029 <span class="comment">// This file is derived from lua-sqlite3-0.4.1, used under the following</span>
<a name="l00030"></a>00030 <span class="comment">// license.</span>
<a name="l00031"></a>00031 <span class="comment">//</span>
<a name="l00032"></a>00032 <span class="comment">/*</span>
<a name="l00033"></a>00033 <span class="comment"> *  Author: Michael Roth &lt;mroth@nessie.de&gt;</span>
<a name="l00034"></a>00034 <span class="comment"> *</span>
<a name="l00035"></a>00035 <span class="comment"> *  Copyright (c) 2004, 2005, 2006 Michael Roth &lt;mroth@nessie.de&gt;</span>
<a name="l00036"></a>00036 <span class="comment"> *</span>
<a name="l00037"></a>00037 <span class="comment"> *  Permission is hereby granted, free of charge, to any person </span>
<a name="l00038"></a>00038 <span class="comment"> *  obtaining a copy of this software and associated documentation</span>
<a name="l00039"></a>00039 <span class="comment"> *  files (the &quot;Software&quot;), to deal in the Software without restriction,</span>
<a name="l00040"></a>00040 <span class="comment"> *  including without limitation the rights to use, copy, modify, merge,</span>
<a name="l00041"></a>00041 <span class="comment"> *  publish, distribute, sublicense, and/or sell copies of the Software,</span>
<a name="l00042"></a>00042 <span class="comment"> *  and to permit persons to whom the Software is furnished to do so,</span>
<a name="l00043"></a>00043 <span class="comment"> *  subject to the following conditions:</span>
<a name="l00044"></a>00044 <span class="comment"> *</span>
<a name="l00045"></a>00045 <span class="comment"> *  The above copyright notice and this permission notice shall be </span>
<a name="l00046"></a>00046 <span class="comment"> *  included in all copies or substantial portions of the Software.</span>
<a name="l00047"></a>00047 <span class="comment"> *</span>
<a name="l00048"></a>00048 <span class="comment"> *  THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND,</span>
<a name="l00049"></a>00049 <span class="comment"> *  EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF</span>
<a name="l00050"></a>00050 <span class="comment"> *  MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.</span>
<a name="l00051"></a>00051 <span class="comment"> *  IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY</span>
<a name="l00052"></a>00052 <span class="comment"> *  CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT,</span>
<a name="l00053"></a>00053 <span class="comment"> *  TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE</span>
<a name="l00054"></a>00054 <span class="comment"> *  SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.</span>
<a name="l00055"></a>00055 <span class="comment"> *</span>
<a name="l00056"></a>00056 <span class="comment"> */</span>
<a name="l00057"></a>00057 
<a name="l00058"></a>00058 
<a name="l00059"></a>00059 
<a name="l00060"></a>00060 <span class="preprocessor">#include &quot;<a class="code" href="libluasqlite3_8h.html">libluasqlite3.h</a>&quot;</span>
<a name="l00061"></a>00061 
<a name="l00062"></a>00062 <span class="preprocessor">#include &quot;<a class="code" href="ac__app__context_8h.html">ac_app_context.h</a>&quot;</span>
<a name="l00063"></a>00063 <span class="preprocessor">#include &quot;<a class="code" href="ld__private_8h.html">ld_private.h</a>&quot;</span>
<a name="l00064"></a>00064 <span class="preprocessor">#include &quot;<a class="code" href="sqlite__cl2_8h.html">sqlite_cl2.h</a>&quot;</span>
<a name="l00065"></a>00065 
<a name="l00066"></a>00066 <span class="preprocessor">#include &quot;<a class="code" href="lua_8h.html">lua.h</a>&quot;</span>
<a name="l00067"></a>00067 <span class="preprocessor">#include &quot;<a class="code" href="lauxlib_8h.html">lauxlib.h</a>&quot;</span>
<a name="l00068"></a>00068 
<a name="l00069"></a>00069 <span class="preprocessor">#include &lt;stdio.h&gt;</span>
<a name="l00070"></a>00070 
<a name="l00071"></a>00071 
<a name="l00072"></a>00072 
<a name="l00073"></a>00073 
<a name="l00074"></a><a class="code" href="libluasqlite3_8c.html#a9a7aaff48d1e77a5fcf16b0d6afc1bb8">00074</a> <span class="preprocessor">#define IS_INT(n)   ( ( (lua_Number) ((int)(n)) )  == (n) )</span>
<a name="l00075"></a>00075 <span class="preprocessor"></span>
<a name="l00076"></a><a class="code" href="libluasqlite3_8c.html#a11e9e37dd86abc52c88ca867db4eaa37">00076</a> <span class="preprocessor">#define CAST(type, arg)   ( (type)(arg) )</span>
<a name="l00077"></a>00077 <span class="preprocessor"></span>
<a name="l00078"></a><a class="code" href="libluasqlite3_8c.html#a4cb9e74c8e392bdf896eeca0586218cf">00078</a> <span class="preprocessor">#define FUNC(name)    static int name (lua_State * L)</span>
<a name="l00079"></a>00079 <span class="preprocessor"></span>
<a name="l00080"></a>00080 
<a name="l00081"></a>00081 
<a name="l00082"></a><a class="code" href="libluasqlite3_8c.html#a11b53e19fa1be7f2b3fe2c460a53ff44">00082</a> <span class="preprocessor">#define CB_DATA(ptr)    CAST(CB_Data *, (ptr))</span>
<a name="l00083"></a>00083 <span class="preprocessor"></span>
<a name="l00084"></a><a class="code" href="libluasqlite3_8c.html#a8afd3376c153ee4808b5b724af695b2a">00084</a> <span class="preprocessor">#define KEY(ptr, id)    CAST( void*, CAST(char*,(ptr))+(id) )</span>
<a name="l00085"></a>00085 <span class="preprocessor"></span>
<a name="l00086"></a><a class="code" href="libluasqlite3_8c.html#a37d5711c10f02872b3b2565ddd5a86f9">00086</a> <span class="preprocessor">#define KEY_KEY2VALUE_TABLE(p)  KEY((p), 1)</span>
<a name="l00087"></a><a class="code" href="libluasqlite3_8c.html#a877bfa4da6c23ab8940efe570c09b05c">00087</a> <span class="preprocessor"></span><span class="preprocessor">#define KEY_FUNCTION_TABLE(p) KEY((p), 2)</span>
<a name="l00088"></a><a class="code" href="libluasqlite3_8c.html#af3a3d29acde546c871908124cdb3d929">00088</a> <span class="preprocessor"></span><span class="preprocessor">#define KEY_COLLATION_TABLE(p)  KEY((p), 3)</span>
<a name="l00089"></a><a class="code" href="libluasqlite3_8c.html#ac51924fb7756cc6ef0b40a084f38b233">00089</a> <span class="preprocessor"></span><span class="preprocessor">#define KEY_COLLNEEDED_DATA(p)  KEY((p), 4)</span>
<a name="l00090"></a><a class="code" href="libluasqlite3_8c.html#a0c69391ae4878bc0db01ce618b203cb0">00090</a> <span class="preprocessor"></span><span class="preprocessor">#define KEY_AUTHORIZER_DATA(p)  KEY((p), 5)</span>
<a name="l00091"></a><a class="code" href="libluasqlite3_8c.html#a9bee9667089651f6ce79b15cb237ea6c">00091</a> <span class="preprocessor"></span><span class="preprocessor">#define KEY_PROGRESS_DATA(p)  KEY((p), 6)</span>
<a name="l00092"></a><a class="code" href="libluasqlite3_8c.html#a6123dcdcbd7a3a6b0410742bb1f4138e">00092</a> <span class="preprocessor"></span><span class="preprocessor">#define KEY_TRACE_DATA(p) KEY((p), 7)</span>
<a name="l00093"></a><a class="code" href="libluasqlite3_8c.html#a4c299c5f24c5cec0725df2f3f461ddbe">00093</a> <span class="preprocessor"></span><span class="preprocessor">#define KEY_BUSY_DATA(p)  KEY((p), 8)</span>
<a name="l00094"></a><a class="code" href="libluasqlite3_8c.html#a4a36a84fe00e2a130e132238a6d7df31">00094</a> <span class="preprocessor"></span><span class="preprocessor">#define KEY_COMMIT_DATA(p)  KEY((p), 9)</span>
<a name="l00095"></a>00095 <span class="preprocessor"></span>
<a name="l00096"></a><a class="code" href="libluasqlite3_8c.html#ab62094220b8c227ba9a5cc69b2341895">00096</a> <span class="preprocessor">#define KEY_XFUNC(p)    KEY((p), 1)</span>
<a name="l00097"></a><a class="code" href="libluasqlite3_8c.html#a4f86cddea86ddecbd10d2057be9521c7">00097</a> <span class="preprocessor"></span><span class="preprocessor">#define KEY_XSTEP(p)    KEY((p), 2)</span>
<a name="l00098"></a><a class="code" href="libluasqlite3_8c.html#a0a12b91afdb49303409fb925ba8f0de2">00098</a> <span class="preprocessor"></span><span class="preprocessor">#define KEY_XFINAL(p)   KEY((p), 3)</span>
<a name="l00099"></a><a class="code" href="libluasqlite3_8c.html#ac9c4ba5877b77ec72e69586a2348d0a9">00099</a> <span class="preprocessor"></span><span class="preprocessor">#define KEY_XCOMPARE(p)   KEY((p), 1)</span>
<a name="l00100"></a><a class="code" href="libluasqlite3_8c.html#a1be0c7df756fffc3bddcd5523e63e789">00100</a> <span class="preprocessor"></span><span class="preprocessor">#define KEY_XNEEDED(p)    KEY((p), 1)</span>
<a name="l00101"></a><a class="code" href="libluasqlite3_8c.html#a97101f83717487630cb479d9b2077ee2">00101</a> <span class="preprocessor"></span><span class="preprocessor">#define KEY_XAUTH(p)    KEY((p), 1)</span>
<a name="l00102"></a><a class="code" href="libluasqlite3_8c.html#a9f692022e7e45ff432a1c7b01ce30288">00102</a> <span class="preprocessor"></span><span class="preprocessor">#define KEY_XPROGRESS(p)  KEY((p), 1)</span>
<a name="l00103"></a><a class="code" href="libluasqlite3_8c.html#a4731b1ae7d1195180f1ca5a04d687976">00103</a> <span class="preprocessor"></span><span class="preprocessor">#define KEY_XTRACE(p)   KEY((p), 1)</span>
<a name="l00104"></a><a class="code" href="libluasqlite3_8c.html#a892e3185dab875c55427c635837ad0a3">00104</a> <span class="preprocessor"></span><span class="preprocessor">#define KEY_XBUSY(p)    KEY((p), 1)</span>
<a name="l00105"></a><a class="code" href="libluasqlite3_8c.html#a474a4965985855f9f8171bdf3e507d26">00105</a> <span class="preprocessor"></span><span class="preprocessor">#define KEY_XCOMMIT(p)    KEY((p), 1)</span>
<a name="l00106"></a>00106 <span class="preprocessor"></span>
<a name="l00107"></a>00107 
<a name="l00108"></a>00108 
<a name="l00109"></a><a class="code" href="structDB.html">00109</a> <span class="keyword">typedef</span> <span class="keyword">struct</span>
<a name="l00110"></a>00110 {
<a name="l00111"></a><a class="code" href="structDB.html#a6a6b21b3e3cea8111eb8010475b6603c">00111</a>   <a class="code" href="structsqlite3.html">sqlite3</a> *   kr_db;
<a name="l00112"></a><a class="code" href="structDB.html#a2e9a0a1c036dd716f5091edff395de52">00112</a>   <a class="code" href="structlua__State.html">lua_State</a> *   L;
<a name="l00113"></a><a class="code" href="structDB.html#a23e061ddc936889ce06d32279f78bc60">00113</a>   <span class="keywordtype">int</span>   key2value_pos;  <span class="comment">/* Used by callback wrappers to find the key2value array on the lua stack */</span>
<a name="l00114"></a>00114 } <a class="code" href="structDB.html">DB</a>;
<a name="l00115"></a>00115 
<a name="l00116"></a>00116 
<a name="l00117"></a><a class="code" href="structStmt.html">00117</a> <span class="keyword">typedef</span> <span class="keyword">struct</span>
<a name="l00118"></a>00118 {
<a name="l00119"></a><a class="code" href="structStmt.html#a822d805cab8195ae0e1ccde20aa3199c">00119</a>   <a class="code" href="structDB.html">DB</a> * <a class="code" href="shell_8c.html#ad6e663497d2c934364b3bcf07496b30b">db</a>;
<a name="l00120"></a><a class="code" href="structStmt.html#ad4c0b22d5bca2830edcb673e731d6fbe">00120</a>   <a class="code" href="sqlite3_8h.html#af2a033da1327cdd77f0a174a09aedd0c">sqlite3_stmt</a> * stmt;
<a name="l00121"></a>00121 } <a class="code" href="structStmt.html">Stmt</a>;
<a name="l00122"></a>00122 
<a name="l00123"></a>00123 
<a name="l00124"></a><a class="code" href="structCB__Data.html">00124</a> <span class="keyword">typedef</span> <span class="keyword">struct</span>
<a name="l00125"></a>00125 {
<a name="l00126"></a><a class="code" href="structCB__Data.html#acb1ae3d47bae0f31657afc7b1b18e23f">00126</a>   <a class="code" href="structDB.html">DB</a> * <a class="code" href="shell_8c.html#ad6e663497d2c934364b3bcf07496b30b">db</a>;
<a name="l00127"></a>00127 } <a class="code" href="structCB__Data.html">CB_Data</a>;
<a name="l00128"></a>00128 
<a name="l00129"></a>00129 
<a name="l00130"></a>00130 
<a name="l00131"></a>00131 
<a name="l00132"></a>00132 
<a name="l00133"></a>00133 
<a name="l00134"></a>00134 <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="libluasqlite3_8c.html#a88545b8bd0b9785f5f056875f1e9e9ef">push_private_table</a>(<a class="code" href="structlua__State.html">lua_State</a> * L, <span class="keywordtype">void</span> * table_key);
<a name="l00135"></a>00135 <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="libluasqlite3_8c.html#a45271b5e58171563de7a716bac2f625f">delete_private_value</a>(<a class="code" href="structlua__State.html">lua_State</a> * L, <span class="keywordtype">void</span> * value_key);
<a name="l00136"></a>00136 
<a name="l00137"></a>00137 <span class="keyword">static</span> <a class="code" href="structCB__Data.html">CB_Data</a> * <a class="code" href="libluasqlite3_8c.html#a17b60e1b8b069fe41516f08180e30896">new_cb_data</a>(<a class="code" href="structlua__State.html">lua_State</a> * L, <a class="code" href="structDB.html">DB</a> * <a class="code" href="shell_8c.html#ad6e663497d2c934364b3bcf07496b30b">db</a>);
<a name="l00138"></a>00138 <span class="keyword">static</span> <a class="code" href="structCB__Data.html">CB_Data</a> * <a class="code" href="libluasqlite3_8c.html#a9851578780576b91654d14958c53c7b8">get_cb_data</a>(<a class="code" href="structlua__State.html">lua_State</a> * L, <a class="code" href="structDB.html">DB</a> * <a class="code" href="shell_8c.html#ad6e663497d2c934364b3bcf07496b30b">db</a>, <span class="keywordtype">void</span> * data_key);
<a name="l00139"></a>00139 <span class="keyword">static</span> <a class="code" href="structCB__Data.html">CB_Data</a> * <a class="code" href="libluasqlite3_8c.html#ad63ddc8762583a4b57b4464778abb327">get_named_cb_data</a>(<a class="code" href="structlua__State.html">lua_State</a> * L, <a class="code" href="structDB.html">DB</a> * <a class="code" href="shell_8c.html#ad6e663497d2c934364b3bcf07496b30b">db</a>, <span class="keywordtype">void</span> * table_key, <span class="keywordtype">int</span> name_pos);
<a name="l00140"></a>00140 
<a name="l00141"></a><a class="code" href="libluasqlite3_8c.html#ad71654e9bcdbb86f4d9a7b015edd8a16">00141</a> <span class="preprocessor">#define get_function_cb_data(L, db, name_pos) get_named_cb_data((L), (db), KEY_FUNCTION_TABLE(db), name_pos)</span>
<a name="l00142"></a><a class="code" href="libluasqlite3_8c.html#ab1f36f2808caf9ffd385c573ca394a01">00142</a> <span class="preprocessor"></span><span class="preprocessor">#define get_collation_cb_data(L, db, name_pos)  get_named_cb_data((L), (db), KEY_COLLATION_TABLE(db), name_pos)</span>
<a name="l00143"></a><a class="code" href="libluasqlite3_8c.html#a8383a485f75d6697f0629316ffa2456f">00143</a> <span class="preprocessor"></span><span class="preprocessor">#define get_collneeded_cb_data(L, db)   get_cb_data((L), (db), KEY_COLLNEEDED_DATA(db))</span>
<a name="l00144"></a><a class="code" href="libluasqlite3_8c.html#a05fdaac447802e596d65b656b5b41e7c">00144</a> <span class="preprocessor"></span><span class="preprocessor">#define get_authorizer_cb_data(L, db)   get_cb_data((L), (db), KEY_AUTHORIZER_DATA(db))</span>
<a name="l00145"></a><a class="code" href="libluasqlite3_8c.html#a516af5b409f576b85db6be69c1ea3178">00145</a> <span class="preprocessor"></span><span class="preprocessor">#define get_progress_cb_data(L, db)   get_cb_data((L), (db), KEY_PROGRESS_DATA(db))</span>
<a name="l00146"></a><a class="code" href="libluasqlite3_8c.html#a332aa6ab34079e92d7ea5d136169559c">00146</a> <span class="preprocessor"></span><span class="preprocessor">#define get_trace_cb_data(L, db)    get_cb_data((L), (db), KEY_TRACE_DATA(db))</span>
<a name="l00147"></a><a class="code" href="libluasqlite3_8c.html#a226ba411222c799337e9be27c9fcb3a3">00147</a> <span class="preprocessor"></span><span class="preprocessor">#define get_busy_cb_data(L, db)     get_cb_data((L), (db), KEY_BUSY_DATA(db))</span>
<a name="l00148"></a><a class="code" href="libluasqlite3_8c.html#acc49927b08f0cda891f8ada9e62b1d53">00148</a> <span class="preprocessor"></span><span class="preprocessor">#define get_commit_cb_data(L, db)   get_cb_data((L), (db), KEY_COMMIT_DATA(db))</span>
<a name="l00149"></a>00149 <span class="preprocessor"></span>
<a name="l00150"></a>00150 <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="libluasqlite3_8c.html#aa7fe5f5eef5402785f2eecea3ebd1ecb">register_callback</a>(<a class="code" href="structlua__State.html">lua_State</a> * L, <a class="code" href="structDB.html">DB</a> * <a class="code" href="shell_8c.html#ad6e663497d2c934364b3bcf07496b30b">db</a>, <span class="keywordtype">void</span> * cb_key, <span class="keywordtype">int</span> callback_pos);
<a name="l00151"></a>00151 <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="libluasqlite3_8c.html#ac281ae73f1597e360da4091ca8cb1697">init_callback_usage</a>(<a class="code" href="structlua__State.html">lua_State</a> * L, <a class="code" href="structDB.html">DB</a> * <a class="code" href="shell_8c.html#ad6e663497d2c934364b3bcf07496b30b">db</a>);
<a name="l00152"></a>00152 <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="libluasqlite3_8c.html#a7fdf29de7ea3da9d847f28fe34f8ae15">push_callback</a>(<a class="code" href="structlua__State.html">lua_State</a> * L, <a class="code" href="structDB.html">DB</a> * <a class="code" href="shell_8c.html#ad6e663497d2c934364b3bcf07496b30b">db</a>, <span class="keywordtype">void</span> * cb_key);
<a name="l00153"></a>00153 
<a name="l00154"></a>00154 <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="libluasqlite3_8c.html#a7d339e5c09255a0cd52524cf4dea8801">pop_break_condition</a>(<a class="code" href="structlua__State.html">lua_State</a> * L);
<a name="l00155"></a>00155 <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="libluasqlite3_8c.html#a69f72323fbac40efe38eff5948922ebd">push_nil_or_string</a>(<a class="code" href="structlua__State.html">lua_State</a> * L, <span class="keyword">const</span> <span class="keywordtype">char</span> * str);
<a name="l00156"></a>00156 
<a name="l00157"></a>00157 
<a name="l00158"></a>00158 
<a name="l00159"></a>00159 
<a name="l00160"></a><a class="code" href="libluasqlite3_8c.html#a88545b8bd0b9785f5f056875f1e9e9ef">00160</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="libluasqlite3_8c.html#a88545b8bd0b9785f5f056875f1e9e9ef">push_private_table</a>(<a class="code" href="structlua__State.html">lua_State</a> * L, <span class="keywordtype">void</span> * table_key)
<a name="l00161"></a>00161 {
<a name="l00162"></a>00162   <a class="code" href="lapi_8c.html#a85e3e3d32b068aef62426828a104b561">lua_pushlightuserdata</a>(L, table_key);
<a name="l00163"></a>00163   <a class="code" href="lapi_8c.html#a43379a0ba1fb68a4c81d205ad60b3cc1">lua_rawget</a>(L, <a class="code" href="lua_8h.html#a3524c2bbc8fcf847dc083246b62945dd">LUA_REGISTRYINDEX</a>);
<a name="l00164"></a>00164   <span class="keywordflow">if</span> (<a class="code" href="lua_8h.html#a86d737d7002e7e94023765397c6eef20">lua_isnil</a>(L, -1))
<a name="l00165"></a>00165   {
<a name="l00166"></a>00166     <a class="code" href="lua_8h.html#abb8eae2164badeafdb037bc1e03cc822">lua_pop</a>(L, 1);
<a name="l00167"></a>00167     <a class="code" href="lua_8h.html#aa59db6b784aa1ec954599a44168c7761">lua_newtable</a>(L);
<a name="l00168"></a>00168     <a class="code" href="lapi_8c.html#a85e3e3d32b068aef62426828a104b561">lua_pushlightuserdata</a>(L, table_key);
<a name="l00169"></a>00169     <a class="code" href="lapi_8c.html#a602f61a9b583d69dc1c72c8970bd65e8">lua_pushvalue</a>(L, -2);
<a name="l00170"></a>00170     <a class="code" href="lapi_8c.html#afb2d27f421677ef40425f9054ae216a7">lua_rawset</a>(L, <a class="code" href="lua_8h.html#a3524c2bbc8fcf847dc083246b62945dd">LUA_REGISTRYINDEX</a>);
<a name="l00171"></a>00171   }
<a name="l00172"></a>00172 }
<a name="l00173"></a>00173 
<a name="l00174"></a>00174 
<a name="l00175"></a><a class="code" href="libluasqlite3_8c.html#a45271b5e58171563de7a716bac2f625f">00175</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="libluasqlite3_8c.html#a45271b5e58171563de7a716bac2f625f">delete_private_value</a>(<a class="code" href="structlua__State.html">lua_State</a> * L, <span class="keywordtype">void</span> * value_key)
<a name="l00176"></a>00176 {
<a name="l00177"></a>00177   <a class="code" href="lapi_8c.html#a85e3e3d32b068aef62426828a104b561">lua_pushlightuserdata</a>(L, value_key);
<a name="l00178"></a>00178   <a class="code" href="lapi_8c.html#a43379a0ba1fb68a4c81d205ad60b3cc1">lua_rawget</a>(L, <a class="code" href="lua_8h.html#a3524c2bbc8fcf847dc083246b62945dd">LUA_REGISTRYINDEX</a>);
<a name="l00179"></a>00179   <span class="keywordflow">if</span> (!<a class="code" href="lua_8h.html#a86d737d7002e7e94023765397c6eef20">lua_isnil</a>(L, -1))
<a name="l00180"></a>00180   {
<a name="l00181"></a>00181     <a class="code" href="lapi_8c.html#a85e3e3d32b068aef62426828a104b561">lua_pushlightuserdata</a>(L, value_key);
<a name="l00182"></a>00182     <a class="code" href="lapi_8c.html#a1b4cd0d80f51e5545a97ca6c28c03c50">lua_pushnil</a>(L);
<a name="l00183"></a>00183     <a class="code" href="lapi_8c.html#afb2d27f421677ef40425f9054ae216a7">lua_rawset</a>(L, <a class="code" href="lua_8h.html#a3524c2bbc8fcf847dc083246b62945dd">LUA_REGISTRYINDEX</a>);
<a name="l00184"></a>00184   }
<a name="l00185"></a>00185   <a class="code" href="lua_8h.html#abb8eae2164badeafdb037bc1e03cc822">lua_pop</a>(L, 1);
<a name="l00186"></a>00186 }
<a name="l00187"></a>00187 
<a name="l00188"></a>00188 
<a name="l00189"></a><a class="code" href="libluasqlite3_8c.html#a17b60e1b8b069fe41516f08180e30896">00189</a> <span class="keyword">static</span> <a class="code" href="structCB__Data.html">CB_Data</a> * <a class="code" href="libluasqlite3_8c.html#a17b60e1b8b069fe41516f08180e30896">new_cb_data</a>(<a class="code" href="structlua__State.html">lua_State</a> * L, <a class="code" href="structDB.html">DB</a> * <a class="code" href="shell_8c.html#ad6e663497d2c934364b3bcf07496b30b">db</a>)
<a name="l00190"></a>00190 {
<a name="l00191"></a>00191   <a class="code" href="structCB__Data.html">CB_Data</a> * cb_data = <a class="code" href="lapi_8c.html#a467bb6f4780b27d6e7de6ee10a80dac5">lua_newuserdata</a>(L, <span class="keyword">sizeof</span>(<a class="code" href="structCB__Data.html">CB_Data</a>));
<a name="l00192"></a>00192   cb_data-&gt;<a class="code" href="structCB__Data.html#acb1ae3d47bae0f31657afc7b1b18e23f">db</a> = db;
<a name="l00193"></a>00193   <span class="keywordflow">return</span> cb_data;
<a name="l00194"></a>00194 }
<a name="l00195"></a>00195 
<a name="l00196"></a>00196 
<a name="l00197"></a><a class="code" href="libluasqlite3_8c.html#a9851578780576b91654d14958c53c7b8">00197</a> <span class="keyword">static</span> <a class="code" href="structCB__Data.html">CB_Data</a> * <a class="code" href="libluasqlite3_8c.html#a9851578780576b91654d14958c53c7b8">get_cb_data</a>(<a class="code" href="structlua__State.html">lua_State</a> * L, <a class="code" href="structDB.html">DB</a> * <a class="code" href="shell_8c.html#ad6e663497d2c934364b3bcf07496b30b">db</a>, <span class="keywordtype">void</span> * data_key)
<a name="l00198"></a>00198 {
<a name="l00199"></a>00199   <a class="code" href="structCB__Data.html">CB_Data</a> * cb_data;
<a name="l00200"></a>00200   
<a name="l00201"></a>00201   <a class="code" href="lapi_8c.html#a85e3e3d32b068aef62426828a104b561">lua_pushlightuserdata</a>(L, data_key);
<a name="l00202"></a>00202   <a class="code" href="lapi_8c.html#a43379a0ba1fb68a4c81d205ad60b3cc1">lua_rawget</a>(L, <a class="code" href="lua_8h.html#a3524c2bbc8fcf847dc083246b62945dd">LUA_REGISTRYINDEX</a>);
<a name="l00203"></a>00203   
<a name="l00204"></a>00204   <span class="keywordflow">if</span> (<a class="code" href="lua_8h.html#a86d737d7002e7e94023765397c6eef20">lua_isnil</a>(L, -1))
<a name="l00205"></a>00205   {
<a name="l00206"></a>00206     <a class="code" href="lapi_8c.html#a85e3e3d32b068aef62426828a104b561">lua_pushlightuserdata</a>(L, data_key);
<a name="l00207"></a>00207     cb_data = <a class="code" href="libluasqlite3_8c.html#a17b60e1b8b069fe41516f08180e30896">new_cb_data</a>(L, db);
<a name="l00208"></a>00208     <a class="code" href="lapi_8c.html#afb2d27f421677ef40425f9054ae216a7">lua_rawset</a>(L, <a class="code" href="lua_8h.html#a3524c2bbc8fcf847dc083246b62945dd">LUA_REGISTRYINDEX</a>);
<a name="l00209"></a>00209   }
<a name="l00210"></a>00210   <span class="keywordflow">else</span>
<a name="l00211"></a>00211     cb_data = <a class="code" href="lapi_8c.html#a0444ddf13e5618bca969e4b3b47bc0cc">lua_touserdata</a>(L, -1);
<a name="l00212"></a>00212   
<a name="l00213"></a>00213   <a class="code" href="lua_8h.html#abb8eae2164badeafdb037bc1e03cc822">lua_pop</a>(L, 1);
<a name="l00214"></a>00214   <span class="keywordflow">return</span> cb_data;
<a name="l00215"></a>00215 }
<a name="l00216"></a>00216 
<a name="l00217"></a>00217 
<a name="l00218"></a><a class="code" href="libluasqlite3_8c.html#ad63ddc8762583a4b57b4464778abb327">00218</a> <span class="keyword">static</span> <a class="code" href="structCB__Data.html">CB_Data</a> * <a class="code" href="libluasqlite3_8c.html#ad63ddc8762583a4b57b4464778abb327">get_named_cb_data</a>(<a class="code" href="structlua__State.html">lua_State</a> * L, <a class="code" href="structDB.html">DB</a> * <a class="code" href="shell_8c.html#ad6e663497d2c934364b3bcf07496b30b">db</a>, <span class="keywordtype">void</span> * table_key, <span class="keywordtype">int</span> name_pos)
<a name="l00219"></a>00219 {
<a name="l00220"></a>00220   <a class="code" href="structCB__Data.html">CB_Data</a> * cb_data;
<a name="l00221"></a>00221   
<a name="l00222"></a>00222   <a class="code" href="libluasqlite3_8c.html#a88545b8bd0b9785f5f056875f1e9e9ef">push_private_table</a>(L, table_key);
<a name="l00223"></a>00223   <a class="code" href="lapi_8c.html#a602f61a9b583d69dc1c72c8970bd65e8">lua_pushvalue</a>(L, name_pos);
<a name="l00224"></a>00224   <a class="code" href="lapi_8c.html#a43379a0ba1fb68a4c81d205ad60b3cc1">lua_rawget</a>(L, -2);
<a name="l00225"></a>00225   
<a name="l00226"></a>00226   <span class="keywordflow">if</span> (<a class="code" href="lua_8h.html#a86d737d7002e7e94023765397c6eef20">lua_isnil</a>(L, -1))
<a name="l00227"></a>00227   {
<a name="l00228"></a>00228     <a class="code" href="lapi_8c.html#a602f61a9b583d69dc1c72c8970bd65e8">lua_pushvalue</a>(L, name_pos);
<a name="l00229"></a>00229     cb_data = <a class="code" href="libluasqlite3_8c.html#a17b60e1b8b069fe41516f08180e30896">new_cb_data</a>(L, db);
<a name="l00230"></a>00230     <a class="code" href="lapi_8c.html#afb2d27f421677ef40425f9054ae216a7">lua_rawset</a>(L, <a class="code" href="lua_8h.html#a3524c2bbc8fcf847dc083246b62945dd">LUA_REGISTRYINDEX</a>);
<a name="l00231"></a>00231   }
<a name="l00232"></a>00232   <span class="keywordflow">else</span>
<a name="l00233"></a>00233     cb_data = <a class="code" href="lapi_8c.html#a0444ddf13e5618bca969e4b3b47bc0cc">lua_touserdata</a>(L, -1);
<a name="l00234"></a>00234   
<a name="l00235"></a>00235   <a class="code" href="lua_8h.html#abb8eae2164badeafdb037bc1e03cc822">lua_pop</a>(L, 2);
<a name="l00236"></a>00236   <span class="keywordflow">return</span> cb_data;
<a name="l00237"></a>00237 }
<a name="l00238"></a>00238 
<a name="l00239"></a>00239 
<a name="l00240"></a><a class="code" href="libluasqlite3_8c.html#aa7fe5f5eef5402785f2eecea3ebd1ecb">00240</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="libluasqlite3_8c.html#aa7fe5f5eef5402785f2eecea3ebd1ecb">register_callback</a>(<a class="code" href="structlua__State.html">lua_State</a> * L, <a class="code" href="structDB.html">DB</a> * <a class="code" href="shell_8c.html#ad6e663497d2c934364b3bcf07496b30b">db</a>, <span class="keywordtype">void</span> * cb_key, <span class="keywordtype">int</span> callback_pos)
<a name="l00241"></a>00241 {
<a name="l00242"></a>00242   <a class="code" href="libluasqlite3_8c.html#a88545b8bd0b9785f5f056875f1e9e9ef">push_private_table</a>(L, <a class="code" href="libluasqlite3_8c.html#a37d5711c10f02872b3b2565ddd5a86f9">KEY_KEY2VALUE_TABLE</a>(db));
<a name="l00243"></a>00243   <a class="code" href="lapi_8c.html#a85e3e3d32b068aef62426828a104b561">lua_pushlightuserdata</a>(L, cb_key);
<a name="l00244"></a>00244   <a class="code" href="lapi_8c.html#a602f61a9b583d69dc1c72c8970bd65e8">lua_pushvalue</a>(L, callback_pos);
<a name="l00245"></a>00245   <a class="code" href="lapi_8c.html#afb2d27f421677ef40425f9054ae216a7">lua_rawset</a>(L, -3);
<a name="l00246"></a>00246   <a class="code" href="lua_8h.html#abb8eae2164badeafdb037bc1e03cc822">lua_pop</a>(L, 1);
<a name="l00247"></a>00247 }
<a name="l00248"></a>00248 
<a name="l00249"></a>00249 
<a name="l00250"></a><a class="code" href="libluasqlite3_8c.html#ac281ae73f1597e360da4091ca8cb1697">00250</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="libluasqlite3_8c.html#ac281ae73f1597e360da4091ca8cb1697">init_callback_usage</a>(<a class="code" href="structlua__State.html">lua_State</a> * L, <a class="code" href="structDB.html">DB</a> * <a class="code" href="shell_8c.html#ad6e663497d2c934364b3bcf07496b30b">db</a>)
<a name="l00251"></a>00251 {
<a name="l00252"></a>00252   db-&gt;<a class="code" href="structDB.html#a2e9a0a1c036dd716f5091edff395de52">L</a> = L;
<a name="l00253"></a>00253   db-&gt;<a class="code" href="structDB.html#a23e061ddc936889ce06d32279f78bc60">key2value_pos</a> = 0;  <span class="comment">/* lazy initialized in push_callback() */</span>
<a name="l00254"></a>00254 }
<a name="l00255"></a>00255 
<a name="l00256"></a>00256 
<a name="l00257"></a><a class="code" href="libluasqlite3_8c.html#a7fdf29de7ea3da9d847f28fe34f8ae15">00257</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="libluasqlite3_8c.html#a7fdf29de7ea3da9d847f28fe34f8ae15">push_callback</a>(<a class="code" href="structlua__State.html">lua_State</a> * L, <a class="code" href="structDB.html">DB</a> * <a class="code" href="shell_8c.html#ad6e663497d2c934364b3bcf07496b30b">db</a>, <span class="keywordtype">void</span> * cb_key)
<a name="l00258"></a>00258 {
<a name="l00259"></a>00259   <span class="keywordflow">if</span> (db-&gt;<a class="code" href="structDB.html#a23e061ddc936889ce06d32279f78bc60">key2value_pos</a> == 0) <span class="comment">/* lazy initializing of the key2value table */</span>
<a name="l00260"></a>00260   {
<a name="l00261"></a>00261     <a class="code" href="libluasqlite3_8c.html#a88545b8bd0b9785f5f056875f1e9e9ef">push_private_table</a>(L, <a class="code" href="libluasqlite3_8c.html#a37d5711c10f02872b3b2565ddd5a86f9">KEY_KEY2VALUE_TABLE</a>(db));
<a name="l00262"></a>00262     db-&gt;<a class="code" href="structDB.html#a23e061ddc936889ce06d32279f78bc60">key2value_pos</a> = <a class="code" href="lapi_8c.html#afbb08ecb69421875494105d4de68e5bf">lua_gettop</a>(L);
<a name="l00263"></a>00263   }
<a name="l00264"></a>00264   
<a name="l00265"></a>00265   <a class="code" href="lapi_8c.html#a85e3e3d32b068aef62426828a104b561">lua_pushlightuserdata</a>(L, cb_key);
<a name="l00266"></a>00266   <a class="code" href="lapi_8c.html#a43379a0ba1fb68a4c81d205ad60b3cc1">lua_rawget</a>(L, db-&gt;<a class="code" href="structDB.html#a23e061ddc936889ce06d32279f78bc60">key2value_pos</a>);
<a name="l00267"></a>00267 }
<a name="l00268"></a>00268 
<a name="l00269"></a>00269 
<a name="l00270"></a><a class="code" href="libluasqlite3_8c.html#a7d339e5c09255a0cd52524cf4dea8801">00270</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="libluasqlite3_8c.html#a7d339e5c09255a0cd52524cf4dea8801">pop_break_condition</a>(<a class="code" href="structlua__State.html">lua_State</a> * L)
<a name="l00271"></a>00271 {
<a name="l00272"></a>00272   <span class="keywordtype">int</span> result;
<a name="l00273"></a>00273   
<a name="l00274"></a>00274   <span class="keywordflow">if</span> (<a class="code" href="lua_8h.html#a86d737d7002e7e94023765397c6eef20">lua_isnil</a>(L, -1))
<a name="l00275"></a>00275     result = 0;
<a name="l00276"></a>00276   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="lua_8h.html#af4f579ead7d5ea837d8d708186033502">lua_isboolean</a>(L, -1))
<a name="l00277"></a>00277     result = <a class="code" href="lapi_8c.html#a444aee9aa56b0b06175ee3c7bcf7927c">lua_toboolean</a>(L, -1);
<a name="l00278"></a>00278   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="lapi_8c.html#a99451f234bf085c9c46c3d17a5aef905">lua_isnumber</a>(L, -1))
<a name="l00279"></a>00279     result = <a class="code" href="lapi_8c.html#a42c1f68101dc98a6ae4695c8577b17f8">lua_tonumber</a>(L, -1);
<a name="l00280"></a>00280   <span class="keywordflow">else</span>
<a name="l00281"></a>00281     result = 1;
<a name="l00282"></a>00282   
<a name="l00283"></a>00283   <a class="code" href="lua_8h.html#abb8eae2164badeafdb037bc1e03cc822">lua_pop</a>(L, 1);
<a name="l00284"></a>00284   <span class="keywordflow">return</span> result;
<a name="l00285"></a>00285 }
<a name="l00286"></a>00286 
<a name="l00287"></a>00287 
<a name="l00288"></a><a class="code" href="libluasqlite3_8c.html#a69f72323fbac40efe38eff5948922ebd">00288</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="libluasqlite3_8c.html#a69f72323fbac40efe38eff5948922ebd">push_nil_or_string</a>(<a class="code" href="structlua__State.html">lua_State</a> * L, <span class="keyword">const</span> <span class="keywordtype">char</span> * str)
<a name="l00289"></a>00289 {
<a name="l00290"></a>00290   <span class="keywordflow">if</span> (str)
<a name="l00291"></a>00291     <a class="code" href="lapi_8c.html#a1281a7e2b52370cc416123bfd32b1b29">lua_pushstring</a>(L, str);
<a name="l00292"></a>00292   <span class="keywordflow">else</span>
<a name="l00293"></a>00293     <a class="code" href="lapi_8c.html#a1b4cd0d80f51e5545a97ca6c28c03c50">lua_pushnil</a>(L);
<a name="l00294"></a>00294 }
<a name="l00295"></a>00295 
<a name="l00296"></a>00296 
<a name="l00297"></a>00297 
<a name="l00298"></a>00298 
<a name="l00299"></a>00299 <span class="comment">/*</span>
<a name="l00300"></a>00300 <span class="comment"> *  Error Handling</span>
<a name="l00301"></a>00301 <span class="comment"> *  ==============</span>
<a name="l00302"></a>00302 <span class="comment"> *</span>
<a name="l00303"></a>00303 <span class="comment"> *  We try to work hard to be bullet proof. We even try to function </span>
<a name="l00304"></a>00304 <span class="comment"> *  correctly in low memory situations.</span>
<a name="l00305"></a>00305 <span class="comment"> *  Usage errors of the API when detected raise an error also</span>
<a name="l00306"></a>00306 <span class="comment"> *  memory errors and such.</span>
<a name="l00307"></a>00307 <span class="comment"> *  Errors signaled from the sqlite library will result in the</span>
<a name="l00308"></a>00308 <span class="comment"> *  appropriate return codes.</span>
<a name="l00309"></a>00309 <span class="comment"> *</span>
<a name="l00310"></a>00310 <span class="comment"> */</span>
<a name="l00311"></a>00311 
<a name="l00312"></a>00312 
<a name="l00313"></a><a class="code" href="libluasqlite3_8c.html#a651d62983f0f11075ab3608c220fc397">00313</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="libluasqlite3_8c.html#a651d62983f0f11075ab3608c220fc397">report_error</a>(<a class="code" href="structlua__State.html">lua_State</a> * L, <span class="keyword">const</span> <span class="keywordtype">char</span> * msg)
<a name="l00314"></a>00314 {
<a name="l00315"></a>00315   <a class="code" href="lapi_8c.html#adaa30f0d34786144c94644039d1d1b6e">lua_settop</a>(L, 0); <span class="comment">/* Clear the stack to make sure, our error message will get a chance */</span>
<a name="l00316"></a>00316   <a class="code" href="lapi_8c.html#a1281a7e2b52370cc416123bfd32b1b29">lua_pushstring</a>(L, msg);
<a name="l00317"></a>00317   <a class="code" href="lapi_8c.html#a6ba7b91143fe8a03910420d800de8e97">lua_error</a>(L);
<a name="l00318"></a>00318 }
<a name="l00319"></a>00319 
<a name="l00320"></a>00320 
<a name="l00321"></a>00321 
<a name="l00322"></a><a class="code" href="libluasqlite3_8c.html#a45900f417bc5164c4c51114b801acdb0">00322</a> <span class="preprocessor">#define checkany(L, narg) ( luaL_checkany((L), (narg)) )</span>
<a name="l00323"></a><a class="code" href="libluasqlite3_8c.html#ab6b4e8ab6d4565c7048dd4afabd79b19">00323</a> <span class="preprocessor"></span><span class="preprocessor">#define checkstr(L, narg) ( luaL_checklstring((L), (narg), 0) )</span>
<a name="l00324"></a><a class="code" href="libluasqlite3_8c.html#ae422beb510500a68a8dc8813893d5798">00324</a> <span class="preprocessor"></span><span class="preprocessor">#define checknumber(L, narg)  ( luaL_checknumber((L), (narg)) )</span>
<a name="l00325"></a><a class="code" href="libluasqlite3_8c.html#a35c42e01e373065d3a0afe7367d364c1">00325</a> <span class="preprocessor"></span><span class="preprocessor">#define checkint(L, narg) ( (int)   checknumber((L), (narg)) )</span>
<a name="l00326"></a><a class="code" href="libluasqlite3_8c.html#a4c0d7e34c09fa9c5bf99eb953df4a953">00326</a> <span class="preprocessor"></span><span class="preprocessor">#define checkdouble(L, narg)  ( (double)  checknumber((L), (narg)) )</span>
<a name="l00327"></a>00327 <span class="preprocessor"></span>
<a name="l00328"></a><a class="code" href="libluasqlite3_8c.html#ad215c23e6c9410427391a8140ff66902">00328</a> <span class="keyword">static</span> <span class="keywordtype">void</span> * <a class="code" href="libluasqlite3_8c.html#ad215c23e6c9410427391a8140ff66902">checkudata</a>(<a class="code" href="structlua__State.html">lua_State</a> * L, <span class="keywordtype">int</span> narg)
<a name="l00329"></a>00329 {
<a name="l00330"></a>00330   <span class="keywordflow">if</span> (!<a class="code" href="lapi_8c.html#aa8a1dab86cfb4e0f9a4d1f699af0041b">lua_isuserdata</a>(L, narg))
<a name="l00331"></a>00331     <a class="code" href="lauxlib_8c.html#a0d3e0426c7d76f6187bf2a4a23b85021">luaL_typerror</a>(L, narg, <span class="stringliteral">&quot;userdata&quot;</span>);
<a name="l00332"></a>00332   <span class="keywordflow">return</span> <a class="code" href="lapi_8c.html#a0444ddf13e5618bca969e4b3b47bc0cc">lua_touserdata</a>(L, narg);
<a name="l00333"></a>00333 }
<a name="l00334"></a>00334 
<a name="l00335"></a><a class="code" href="libluasqlite3_8c.html#aee22b28f72d72e04595d1411ad9d94d3">00335</a> <span class="preprocessor">#define checkcontext(L, narg) ( (sqlite3_context *) checkudata((L), (narg)) )</span>
<a name="l00336"></a><a class="code" href="libluasqlite3_8c.html#a4680b8f082d847c367e9263cace94f23">00336</a> <span class="preprocessor"></span><span class="preprocessor">#define checkvalues(L, narg)  ( (sqlite3_value **)  checkudata((L), (narg)) )</span>
<a name="l00337"></a><a class="code" href="libluasqlite3_8c.html#a5d26f2f8d8b765e23c3d474c531fa22c">00337</a> <span class="preprocessor"></span><span class="preprocessor">#define checkstmt(L, narg)  ( (Stmt *)    checkudata((L), (narg)) )</span>
<a name="l00338"></a><a class="code" href="libluasqlite3_8c.html#ab0c20935a6010dcdbc203bd42e035c6f">00338</a> <span class="preprocessor"></span><span class="preprocessor">#define checkdb(L, narg)  ( (DB *)    checkudata((L), (narg)) )</span>
<a name="l00339"></a>00339 <span class="preprocessor"></span>
<a name="l00340"></a><a class="code" href="libluasqlite3_8c.html#a52bfdf41a0cbfdd865008b84e6974383">00340</a> <span class="keyword">static</span> <a class="code" href="sqlite3_8h.html#af2a033da1327cdd77f0a174a09aedd0c">sqlite3_stmt</a> * <a class="code" href="libluasqlite3_8c.html#a52bfdf41a0cbfdd865008b84e6974383">checkstmt_stmt</a>(<a class="code" href="structlua__State.html">lua_State</a> * L, <span class="keywordtype">int</span> narg)
<a name="l00341"></a>00341 {
<a name="l00342"></a>00342   <span class="keywordflow">return</span> <a class="code" href="libluasqlite3_8c.html#a5d26f2f8d8b765e23c3d474c531fa22c">checkstmt</a>(L, narg)-&gt;stmt;
<a name="l00343"></a>00343 }
<a name="l00344"></a>00344 
<a name="l00345"></a><a class="code" href="libluasqlite3_8c.html#ad6b640fae60f959363e6ef256b6307b2">00345</a> <span class="keyword">static</span> <a class="code" href="structsqlite3.html">sqlite3</a> * <a class="code" href="libluasqlite3_8c.html#ad6b640fae60f959363e6ef256b6307b2">checkdb_sqlite3</a>(<a class="code" href="structlua__State.html">lua_State</a> * L, <span class="keywordtype">int</span> narg)
<a name="l00346"></a>00346 {
<a name="l00347"></a>00347   <span class="keywordflow">return</span> <a class="code" href="libluasqlite3_8c.html#ab0c20935a6010dcdbc203bd42e035c6f">checkdb</a>(L, narg)-&gt;kr_db;
<a name="l00348"></a>00348 }
<a name="l00349"></a>00349 
<a name="l00350"></a>00350 <span class="comment">/*</span>
<a name="l00351"></a>00351 <span class="comment">static pthread_mutex_t* checkdb_mutex(lua_State * L, int narg)</span>
<a name="l00352"></a>00352 <span class="comment">{</span>
<a name="l00353"></a>00353 <span class="comment">  return &amp;(checkdb(L, narg)-&gt;mutex);</span>
<a name="l00354"></a>00354 <span class="comment">}</span>
<a name="l00355"></a>00355 <span class="comment">*/</span>
<a name="l00356"></a>00356 
<a name="l00357"></a><a class="code" href="libluasqlite3_8c.html#a7bb1bafa6db5663c092b378528d8f260">00357</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="libluasqlite3_8c.html#a7bb1bafa6db5663c092b378528d8f260">checknilornoneorfunc</a>(<a class="code" href="structlua__State.html">lua_State</a> * L, <span class="keywordtype">int</span> narg)
<a name="l00358"></a>00358 {
<a name="l00359"></a>00359   <span class="keywordflow">if</span> (<a class="code" href="lua_8h.html#a86d737d7002e7e94023765397c6eef20">lua_isnil</a>(L, narg) || <a class="code" href="lua_8h.html#ad054300429f1094d3692313abc733ddf">lua_isnone</a>(L, narg))
<a name="l00360"></a>00360     <span class="keywordflow">return</span> 0;
<a name="l00361"></a>00361   <span class="keywordflow">if</span> (<a class="code" href="lua_8h.html#a7537af276c81906c144f29cd25b93315">lua_isfunction</a>(L, narg))
<a name="l00362"></a>00362     <span class="keywordflow">return</span> 1;
<a name="l00363"></a>00363   <a class="code" href="lauxlib_8c.html#a0d3e0426c7d76f6187bf2a4a23b85021">luaL_typerror</a>(L, narg, <span class="stringliteral">&quot;nil, none or function&quot;</span>);
<a name="l00364"></a>00364   <span class="keywordflow">return</span> 0; <span class="comment">/* never reached, make compiler happy... */</span>
<a name="l00365"></a>00365 }
<a name="l00366"></a>00366 
<a name="l00367"></a>00367 
<a name="l00368"></a>00368 
<a name="l00369"></a>00369 
<a name="l00370"></a>00370 
<a name="l00371"></a>00371 
<a name="l00372"></a><a class="code" href="libluasqlite3_8c.html#a1acc71bf27996f19d5d4be7b7b6fd24f">00372</a> <a class="code" href="libluasqlite3_8c.html#a4cb9e74c8e392bdf896eeca0586218cf">FUNC</a>( l_sqlite3_bind_null )
<a name="l00373"></a>00373 {
<a name="l00374"></a>00374   <a class="code" href="lapi_8c.html#a328625a03fbb5548f27b1af10f109f6a">lua_pushnumber</a>(L, <a class="code" href="sqlite3_8h.html#a361e2e79de6e4a728c4ec7d48f1762ea">sqlite3_bind_null</a>(<a class="code" href="libluasqlite3_8c.html#a52bfdf41a0cbfdd865008b84e6974383">checkstmt_stmt</a>(L, 1), <a class="code" href="libluasqlite3_8c.html#a35c42e01e373065d3a0afe7367d364c1">checkint</a>(L, 2)) );
<a name="l00375"></a>00375   <span class="keywordflow">return</span> 1;
<a name="l00376"></a>00376 }
<a name="l00377"></a>00377 
<a name="l00378"></a>00378 
<a name="l00379"></a><a class="code" href="libluasqlite3_8c.html#a23760aeaaaa398c3d5d25d2d6a288e6d">00379</a> <a class="code" href="libluasqlite3_8c.html#a4cb9e74c8e392bdf896eeca0586218cf">FUNC</a>( l_sqlite3_bind_text )
<a name="l00380"></a>00380 {
<a name="l00381"></a>00381   <a class="code" href="lapi_8c.html#a328625a03fbb5548f27b1af10f109f6a">lua_pushnumber</a>(L, <a class="code" href="sqlite3_8h.html#a154a83560a7c30758ad266cbb248de11">sqlite3_bind_text</a>(<a class="code" href="libluasqlite3_8c.html#a52bfdf41a0cbfdd865008b84e6974383">checkstmt_stmt</a>(L, 1), <a class="code" href="libluasqlite3_8c.html#a35c42e01e373065d3a0afe7367d364c1">checkint</a>(L, 2), <a class="code" href="libluasqlite3_8c.html#ab6b4e8ab6d4565c7048dd4afabd79b19">checkstr</a>(L, 3), <a class="code" href="lua_8h.html#af1950fb3c542d036245559b5f5ae9346">lua_strlen</a>(L, 3), <a class="code" href="sqlite3_8h.html#adec3d88e3dff21d4c566daccbede9b3b">SQLITE_TRANSIENT</a>) );
<a name="l00382"></a>00382   <span class="keywordflow">return</span> 1;
<a name="l00383"></a>00383 }
<a name="l00384"></a>00384 
<a name="l00385"></a>00385 
<a name="l00386"></a><a class="code" href="libluasqlite3_8c.html#a654edc2e6e23be7f96f0dbb4fa64d014">00386</a> <a class="code" href="libluasqlite3_8c.html#a4cb9e74c8e392bdf896eeca0586218cf">FUNC</a>( l_sqlite3_bind_blob )
<a name="l00387"></a>00387 {
<a name="l00388"></a>00388   <a class="code" href="lapi_8c.html#a328625a03fbb5548f27b1af10f109f6a">lua_pushnumber</a>(L, <a class="code" href="sqlite3_8h.html#a31729e3159ba77c17d7fb51a7f468e8e">sqlite3_bind_blob</a>(<a class="code" href="libluasqlite3_8c.html#a52bfdf41a0cbfdd865008b84e6974383">checkstmt_stmt</a>(L, 1), <a class="code" href="libluasqlite3_8c.html#a35c42e01e373065d3a0afe7367d364c1">checkint</a>(L, 2), <a class="code" href="libluasqlite3_8c.html#ab6b4e8ab6d4565c7048dd4afabd79b19">checkstr</a>(L, 3), <a class="code" href="lua_8h.html#af1950fb3c542d036245559b5f5ae9346">lua_strlen</a>(L, 3), <a class="code" href="sqlite3_8h.html#adec3d88e3dff21d4c566daccbede9b3b">SQLITE_TRANSIENT</a>) );
<a name="l00389"></a>00389   <span class="keywordflow">return</span> 1;
<a name="l00390"></a>00390 }
<a name="l00391"></a>00391 
<a name="l00392"></a>00392 
<a name="l00393"></a><a class="code" href="libluasqlite3_8c.html#a76244a167ef7bd1bd2b6bd401da94cfa">00393</a> <a class="code" href="libluasqlite3_8c.html#a4cb9e74c8e392bdf896eeca0586218cf">FUNC</a>( l_sqlite3_bind_int )
<a name="l00394"></a>00394 {
<a name="l00395"></a>00395   <a class="code" href="lapi_8c.html#a328625a03fbb5548f27b1af10f109f6a">lua_pushnumber</a>(L, <a class="code" href="sqlite3_8h.html#acb3c1ebeca0b79c87807bf9d7c13ae9c">sqlite3_bind_int</a>(<a class="code" href="libluasqlite3_8c.html#a52bfdf41a0cbfdd865008b84e6974383">checkstmt_stmt</a>(L, 1), <a class="code" href="libluasqlite3_8c.html#a35c42e01e373065d3a0afe7367d364c1">checkint</a>(L, 2), <a class="code" href="libluasqlite3_8c.html#a35c42e01e373065d3a0afe7367d364c1">checkint</a>(L, 3)) );
<a name="l00396"></a>00396   <span class="keywordflow">return</span> 1;
<a name="l00397"></a>00397 }
<a name="l00398"></a>00398 
<a name="l00399"></a>00399 
<a name="l00400"></a><a class="code" href="libluasqlite3_8c.html#a79a2cbbebdd78cdbb69255151bc15cab">00400</a> <a class="code" href="libluasqlite3_8c.html#a4cb9e74c8e392bdf896eeca0586218cf">FUNC</a>( l_sqlite3_bind_double )
<a name="l00401"></a>00401 {
<a name="l00402"></a>00402   <a class="code" href="lapi_8c.html#a328625a03fbb5548f27b1af10f109f6a">lua_pushnumber</a>(L, <a class="code" href="sqlite3_8h.html#a1e47a8d85788a7b85a00f868e1df61c2">sqlite3_bind_double</a>(<a class="code" href="libluasqlite3_8c.html#a52bfdf41a0cbfdd865008b84e6974383">checkstmt_stmt</a>(L, 1), <a class="code" href="libluasqlite3_8c.html#a35c42e01e373065d3a0afe7367d364c1">checkint</a>(L, 2), <a class="code" href="libluasqlite3_8c.html#a4c0d7e34c09fa9c5bf99eb953df4a953">checkdouble</a>(L, 3)) );
<a name="l00403"></a>00403   <span class="keywordflow">return</span> 1;
<a name="l00404"></a>00404 }
<a name="l00405"></a>00405 
<a name="l00406"></a>00406 
<a name="l00407"></a><a class="code" href="libluasqlite3_8c.html#aea1b34bbe8a7b1ceb3e4716e41ee4c35">00407</a> <a class="code" href="libluasqlite3_8c.html#a4cb9e74c8e392bdf896eeca0586218cf">FUNC</a>( l_sqlite3_bind_number )
<a name="l00408"></a>00408 {
<a name="l00409"></a>00409   <a class="code" href="sqlite3_8h.html#af2a033da1327cdd77f0a174a09aedd0c">sqlite3_stmt</a> * stmt   = <a class="code" href="libluasqlite3_8c.html#a52bfdf41a0cbfdd865008b84e6974383">checkstmt_stmt</a>(L, 1);
<a name="l00410"></a>00410   <span class="keywordtype">int</span> index     = <a class="code" href="libluasqlite3_8c.html#a35c42e01e373065d3a0afe7367d364c1">checkint</a>(L, 2);
<a name="l00411"></a>00411   <a class="code" href="lua_8h.html#af0a6ed3b852d680769cfc410a0672172">lua_Number</a> number   = <a class="code" href="libluasqlite3_8c.html#ae422beb510500a68a8dc8813893d5798">checknumber</a>(L, 3);
<a name="l00412"></a>00412   
<a name="l00413"></a>00413   <span class="keywordflow">if</span> (<a class="code" href="libluasqlite3_8c.html#a9a7aaff48d1e77a5fcf16b0d6afc1bb8">IS_INT</a>(number))
<a name="l00414"></a>00414     <a class="code" href="lapi_8c.html#a328625a03fbb5548f27b1af10f109f6a">lua_pushnumber</a>(L, <a class="code" href="sqlite3_8h.html#acb3c1ebeca0b79c87807bf9d7c13ae9c">sqlite3_bind_int</a>(stmt, index, (<span class="keywordtype">int</span>)number) );
<a name="l00415"></a>00415   <span class="keywordflow">else</span>
<a name="l00416"></a>00416     <a class="code" href="lapi_8c.html#a328625a03fbb5548f27b1af10f109f6a">lua_pushnumber</a>(L, <a class="code" href="sqlite3_8h.html#a1e47a8d85788a7b85a00f868e1df61c2">sqlite3_bind_double</a>(stmt, index, (<span class="keywordtype">double</span>)number) );
<a name="l00417"></a>00417   
<a name="l00418"></a>00418   <span class="keywordflow">return</span> 1;
<a name="l00419"></a>00419 }
<a name="l00420"></a>00420 
<a name="l00421"></a>00421 
<a name="l00422"></a><a class="code" href="libluasqlite3_8c.html#a949720bf7544a67835388c5b54c6cf81">00422</a> <a class="code" href="libluasqlite3_8c.html#a4cb9e74c8e392bdf896eeca0586218cf">FUNC</a>( l_sqlite3_bind )
<a name="l00423"></a>00423 {
<a name="l00424"></a>00424   <a class="code" href="sqlite3_8h.html#af2a033da1327cdd77f0a174a09aedd0c">sqlite3_stmt</a> * stmt = <a class="code" href="libluasqlite3_8c.html#a52bfdf41a0cbfdd865008b84e6974383">checkstmt_stmt</a>(L, 1);
<a name="l00425"></a>00425   <span class="keywordtype">int</span> index   = <a class="code" href="libluasqlite3_8c.html#a35c42e01e373065d3a0afe7367d364c1">checkint</a>(L, 2);
<a name="l00426"></a>00426   
<a name="l00427"></a>00427   <span class="keywordflow">switch</span>(<a class="code" href="lapi_8c.html#a652b273947f0656686f998d8e90cd3ea">lua_type</a>(L, 3))
<a name="l00428"></a>00428   {
<a name="l00429"></a>00429     <span class="keywordflow">case</span> <a class="code" href="lua_8h.html#a39c27eef097c704eee3536906dea5380">LUA_TNONE</a>:
<a name="l00430"></a>00430     <span class="keywordflow">case</span> <a class="code" href="lua_8h.html#ae38a6fb8c687b8bfab211b7675a695ef">LUA_TNIL</a>:
<a name="l00431"></a>00431       <a class="code" href="lapi_8c.html#a328625a03fbb5548f27b1af10f109f6a">lua_pushnumber</a>(L, <a class="code" href="sqlite3_8h.html#a361e2e79de6e4a728c4ec7d48f1762ea">sqlite3_bind_null</a>(stmt, index) );
<a name="l00432"></a>00432       <span class="keywordflow">break</span>;
<a name="l00433"></a>00433     
<a name="l00434"></a>00434     <span class="keywordflow">case</span> <a class="code" href="lua_8h.html#a7f62ecb240cb38da9c8a53b41fe21ed9">LUA_TNUMBER</a>:
<a name="l00435"></a>00435       {
<a name="l00436"></a>00436         <a class="code" href="lua_8h.html#af0a6ed3b852d680769cfc410a0672172">lua_Number</a> number = <a class="code" href="lapi_8c.html#a42c1f68101dc98a6ae4695c8577b17f8">lua_tonumber</a>(L, 3);
<a name="l00437"></a>00437         
<a name="l00438"></a>00438         <span class="keywordflow">if</span> (<a class="code" href="libluasqlite3_8c.html#a9a7aaff48d1e77a5fcf16b0d6afc1bb8">IS_INT</a>(number))
<a name="l00439"></a>00439           <a class="code" href="lapi_8c.html#a328625a03fbb5548f27b1af10f109f6a">lua_pushnumber</a>(L, <a class="code" href="sqlite3_8h.html#acb3c1ebeca0b79c87807bf9d7c13ae9c">sqlite3_bind_int</a>(stmt, index, (<span class="keywordtype">int</span>)number) );
<a name="l00440"></a>00440         <span class="keywordflow">else</span>
<a name="l00441"></a>00441           <a class="code" href="lapi_8c.html#a328625a03fbb5548f27b1af10f109f6a">lua_pushnumber</a>(L, <a class="code" href="sqlite3_8h.html#a1e47a8d85788a7b85a00f868e1df61c2">sqlite3_bind_double</a>(stmt, index, (<span class="keywordtype">double</span>)number) );
<a name="l00442"></a>00442       }
<a name="l00443"></a>00443       <span class="keywordflow">break</span>;
<a name="l00444"></a>00444     
<a name="l00445"></a>00445     <span class="keywordflow">case</span> <a class="code" href="lua_8h.html#a611808ed12d4c2aee2a9e298a9d9a9bf">LUA_TBOOLEAN</a>:
<a name="l00446"></a>00446       <span class="keywordflow">if</span> (<a class="code" href="lapi_8c.html#a444aee9aa56b0b06175ee3c7bcf7927c">lua_toboolean</a>(L, 3))
<a name="l00447"></a>00447         <a class="code" href="lapi_8c.html#a328625a03fbb5548f27b1af10f109f6a">lua_pushnumber</a>(L, <a class="code" href="sqlite3_8h.html#acb3c1ebeca0b79c87807bf9d7c13ae9c">sqlite3_bind_int</a>(stmt, index, 1) );
<a name="l00448"></a>00448       <span class="keywordflow">else</span>
<a name="l00449"></a>00449         <a class="code" href="lapi_8c.html#a328625a03fbb5548f27b1af10f109f6a">lua_pushnumber</a>(L, <a class="code" href="sqlite3_8h.html#acb3c1ebeca0b79c87807bf9d7c13ae9c">sqlite3_bind_int</a>(stmt, index, 0) );
<a name="l00450"></a>00450       <span class="keywordflow">break</span>;
<a name="l00451"></a>00451     
<a name="l00452"></a>00452     <span class="keywordflow">case</span> <a class="code" href="lua_8h.html#a57de20d87bb5131a3159f2bd52e3fab6">LUA_TSTRING</a>:
<a name="l00453"></a>00453       <a class="code" href="lapi_8c.html#a328625a03fbb5548f27b1af10f109f6a">lua_pushnumber</a>(L, <a class="code" href="sqlite3_8h.html#a154a83560a7c30758ad266cbb248de11">sqlite3_bind_text</a>(stmt, index, <a class="code" href="lua_8h.html#ac813fc3bc1886ba17c363d5b4c6e7ef1">lua_tostring</a>(L, 3), <a class="code" href="lua_8h.html#af1950fb3c542d036245559b5f5ae9346">lua_strlen</a>(L, 3), <a class="code" href="sqlite3_8h.html#adec3d88e3dff21d4c566daccbede9b3b">SQLITE_TRANSIENT</a>) );
<a name="l00454"></a>00454       <span class="keywordflow">break</span>;
<a name="l00455"></a>00455     
<a name="l00456"></a>00456     <span class="keywordflow">default</span>:
<a name="l00457"></a>00457       <a class="code" href="lauxlib_8c.html#ad55b4b5fa169573bd0becaa38d7254c4">luaL_argerror</a>(L, 3, <span class="stringliteral">&quot;nil, boolean, number or string expected&quot;</span>);
<a name="l00458"></a>00458   }
<a name="l00459"></a>00459   
<a name="l00460"></a>00460   <span class="keywordflow">return</span> 1;
<a name="l00461"></a>00461 }
<a name="l00462"></a>00462 
<a name="l00463"></a>00463 
<a name="l00464"></a><a class="code" href="libluasqlite3_8c.html#a2c5ea738dfac073c8edaef7591f29745">00464</a> <a class="code" href="libluasqlite3_8c.html#a4cb9e74c8e392bdf896eeca0586218cf">FUNC</a>( l_sqlite3_bind_parameter_count )
<a name="l00465"></a>00465 {
<a name="l00466"></a>00466   <a class="code" href="lapi_8c.html#a328625a03fbb5548f27b1af10f109f6a">lua_pushnumber</a>(L, <a class="code" href="sqlite3_8h.html#ad664d81503303011b38a48547dd50391">sqlite3_bind_parameter_count</a>(<a class="code" href="libluasqlite3_8c.html#a52bfdf41a0cbfdd865008b84e6974383">checkstmt_stmt</a>(L, 1)) );
<a name="l00467"></a>00467   <span class="keywordflow">return</span> 1;
<a name="l00468"></a>00468 }
<a name="l00469"></a>00469 
<a name="l00470"></a>00470 
<a name="l00471"></a><a class="code" href="libluasqlite3_8c.html#a694d9c01503123ef6a6ab475c2a82c85">00471</a> <a class="code" href="libluasqlite3_8c.html#a4cb9e74c8e392bdf896eeca0586218cf">FUNC</a>( l_sqlite3_bind_parameter_name )
<a name="l00472"></a>00472 {
<a name="l00473"></a>00473   <span class="keyword">const</span> <span class="keywordtype">char</span> * name = <a class="code" href="sqlite3_8h.html#a812b6ded8a4fb9992d608e7f2cf4561e">sqlite3_bind_parameter_name</a>(<a class="code" href="libluasqlite3_8c.html#a52bfdf41a0cbfdd865008b84e6974383">checkstmt_stmt</a>(L, 1), <a class="code" href="libluasqlite3_8c.html#a35c42e01e373065d3a0afe7367d364c1">checkint</a>(L, 2));
<a name="l00474"></a>00474   <span class="keywordflow">if</span> (name)
<a name="l00475"></a>00475     <a class="code" href="lapi_8c.html#a1281a7e2b52370cc416123bfd32b1b29">lua_pushstring</a>(L, name);
<a name="l00476"></a>00476   <span class="keywordflow">else</span>
<a name="l00477"></a>00477     <a class="code" href="lapi_8c.html#a1b4cd0d80f51e5545a97ca6c28c03c50">lua_pushnil</a>(L);
<a name="l00478"></a>00478   <span class="keywordflow">return</span> 1;
<a name="l00479"></a>00479 }
<a name="l00480"></a>00480 
<a name="l00481"></a>00481 
<a name="l00482"></a><a class="code" href="libluasqlite3_8c.html#aad3c3e6a3827210342c8c8c3ef38a2fb">00482</a> <a class="code" href="libluasqlite3_8c.html#a4cb9e74c8e392bdf896eeca0586218cf">FUNC</a>( l_sqlite3_bind_parameter_name_x )
<a name="l00483"></a>00483 {
<a name="l00484"></a>00484   <span class="keyword">const</span> <span class="keywordtype">char</span> * name = <a class="code" href="sqlite3_8h.html#a812b6ded8a4fb9992d608e7f2cf4561e">sqlite3_bind_parameter_name</a>(<a class="code" href="libluasqlite3_8c.html#a52bfdf41a0cbfdd865008b84e6974383">checkstmt_stmt</a>(L, 1), <a class="code" href="libluasqlite3_8c.html#a35c42e01e373065d3a0afe7367d364c1">checkint</a>(L, 2));
<a name="l00485"></a>00485   <span class="keywordflow">if</span> (name &amp;&amp; *name)
<a name="l00486"></a>00486     <a class="code" href="lapi_8c.html#a1281a7e2b52370cc416123bfd32b1b29">lua_pushstring</a>(L, name + 1);  <span class="comment">/* Ignore leading &apos;$&apos; or &apos;:&apos; */</span>
<a name="l00487"></a>00487   <span class="keywordflow">else</span>
<a name="l00488"></a>00488     <a class="code" href="lapi_8c.html#a1b4cd0d80f51e5545a97ca6c28c03c50">lua_pushnil</a>(L);
<a name="l00489"></a>00489   <span class="keywordflow">return</span> 1;
<a name="l00490"></a>00490 }
<a name="l00491"></a>00491 
<a name="l00492"></a>00492 
<a name="l00493"></a><a class="code" href="libluasqlite3_8c.html#af1434fd3e30a88d25c6a2d2e7ba39aed">00493</a> <a class="code" href="libluasqlite3_8c.html#a4cb9e74c8e392bdf896eeca0586218cf">FUNC</a>( l_sqlite3_busy_timeout )
<a name="l00494"></a>00494 {
<a name="l00495"></a>00495   <a class="code" href="structDB.html">DB</a> * <a class="code" href="shell_8c.html#ad6e663497d2c934364b3bcf07496b30b">db</a> = <a class="code" href="libluasqlite3_8c.html#ab0c20935a6010dcdbc203bd42e035c6f">checkdb</a>(L, 1);
<a name="l00496"></a>00496   <span class="keywordtype">int</span> timeout = <a class="code" href="libluasqlite3_8c.html#a35c42e01e373065d3a0afe7367d364c1">checkint</a>(L, 2);
<a name="l00497"></a>00497   
<a name="l00498"></a>00498   <a class="code" href="libluasqlite3_8c.html#a45271b5e58171563de7a716bac2f625f">delete_private_value</a>(L, <a class="code" href="libluasqlite3_8c.html#a4c299c5f24c5cec0725df2f3f461ddbe">KEY_BUSY_DATA</a>(db));
<a name="l00499"></a>00499   
<a name="l00500"></a>00500   <a class="code" href="lapi_8c.html#a328625a03fbb5548f27b1af10f109f6a">lua_pushnumber</a>(L, <a class="code" href="main_8c.html#abb532938097030cd9a72bc442e12a549">sqlite3_busy_timeout</a>(db-&gt;<a class="code" href="structDB.html#a6a6b21b3e3cea8111eb8010475b6603c">kr_db</a>, timeout) );
<a name="l00501"></a>00501   <span class="keywordflow">return</span> 1;
<a name="l00502"></a>00502 }
<a name="l00503"></a>00503 
<a name="l00504"></a>00504 
<a name="l00505"></a><a class="code" href="libluasqlite3_8c.html#aad208772a71d4c3a6a59e79ee31f4253">00505</a> <a class="code" href="libluasqlite3_8c.html#a4cb9e74c8e392bdf896eeca0586218cf">FUNC</a>( l_sqlite3_changes )
<a name="l00506"></a>00506 {
<a name="l00507"></a>00507   <a class="code" href="lapi_8c.html#a328625a03fbb5548f27b1af10f109f6a">lua_pushnumber</a>(L, <a class="code" href="main_8c.html#a072b54e89366ed009ccb83972bee3cff">sqlite3_changes</a>(<a class="code" href="libluasqlite3_8c.html#ad6b640fae60f959363e6ef256b6307b2">checkdb_sqlite3</a>(L, 1)) );
<a name="l00508"></a>00508   <span class="keywordflow">return</span> 1;
<a name="l00509"></a>00509 }
<a name="l00510"></a>00510 
<a name="l00511"></a>00511 
<a name="l00512"></a><a class="code" href="libluasqlite3_8c.html#ad294830fe5f9f42c9deb870fa0a632e9">00512</a> <a class="code" href="libluasqlite3_8c.html#a4cb9e74c8e392bdf896eeca0586218cf">FUNC</a>( l_sqlite3_close )
<a name="l00513"></a>00513 {
<a name="l00514"></a>00514   <a class="code" href="structDB.html">DB</a> * <a class="code" href="shell_8c.html#ad6e663497d2c934364b3bcf07496b30b">db</a> = <a class="code" href="libluasqlite3_8c.html#ab0c20935a6010dcdbc203bd42e035c6f">checkdb</a>(L, 1); <span class="comment">// xxx the arg need not be popped, apparently</span>
<a name="l00515"></a>00515   
<a name="l00516"></a>00516   <a class="code" href="libluasqlite3_8c.html#a45271b5e58171563de7a716bac2f625f">delete_private_value</a>(L, <a class="code" href="libluasqlite3_8c.html#a37d5711c10f02872b3b2565ddd5a86f9">KEY_KEY2VALUE_TABLE</a>(db));
<a name="l00517"></a>00517   <a class="code" href="libluasqlite3_8c.html#a45271b5e58171563de7a716bac2f625f">delete_private_value</a>(L, <a class="code" href="libluasqlite3_8c.html#a877bfa4da6c23ab8940efe570c09b05c">KEY_FUNCTION_TABLE</a>(db));
<a name="l00518"></a>00518   <a class="code" href="libluasqlite3_8c.html#a45271b5e58171563de7a716bac2f625f">delete_private_value</a>(L, <a class="code" href="libluasqlite3_8c.html#af3a3d29acde546c871908124cdb3d929">KEY_COLLATION_TABLE</a>(db));
<a name="l00519"></a>00519   <a class="code" href="libluasqlite3_8c.html#a45271b5e58171563de7a716bac2f625f">delete_private_value</a>(L, <a class="code" href="libluasqlite3_8c.html#ac51924fb7756cc6ef0b40a084f38b233">KEY_COLLNEEDED_DATA</a>(db));
<a name="l00520"></a>00520   <a class="code" href="libluasqlite3_8c.html#a45271b5e58171563de7a716bac2f625f">delete_private_value</a>(L, <a class="code" href="libluasqlite3_8c.html#a0c69391ae4878bc0db01ce618b203cb0">KEY_AUTHORIZER_DATA</a>(db));
<a name="l00521"></a>00521   <a class="code" href="libluasqlite3_8c.html#a45271b5e58171563de7a716bac2f625f">delete_private_value</a>(L, <a class="code" href="libluasqlite3_8c.html#a9bee9667089651f6ce79b15cb237ea6c">KEY_PROGRESS_DATA</a>(db));
<a name="l00522"></a>00522   <a class="code" href="libluasqlite3_8c.html#a45271b5e58171563de7a716bac2f625f">delete_private_value</a>(L, <a class="code" href="libluasqlite3_8c.html#a6123dcdcbd7a3a6b0410742bb1f4138e">KEY_TRACE_DATA</a>(db));
<a name="l00523"></a>00523   <a class="code" href="libluasqlite3_8c.html#a45271b5e58171563de7a716bac2f625f">delete_private_value</a>(L, <a class="code" href="libluasqlite3_8c.html#a4c299c5f24c5cec0725df2f3f461ddbe">KEY_BUSY_DATA</a>(db));
<a name="l00524"></a>00524   <a class="code" href="libluasqlite3_8c.html#a45271b5e58171563de7a716bac2f625f">delete_private_value</a>(L, <a class="code" href="libluasqlite3_8c.html#a4a36a84fe00e2a130e132238a6d7df31">KEY_COMMIT_DATA</a>(db));
<a name="l00525"></a>00525 
<a name="l00526"></a>00526   <span class="comment">// I suppose Lua will GC the actual DB struct.</span>
<a name="l00527"></a>00527   <span class="keywordflow">return</span> 0;
<a name="l00528"></a>00528 }
<a name="l00529"></a>00529 
<a name="l00530"></a>00530 
<a name="l00531"></a><a class="code" href="libluasqlite3_8c.html#ae144eeb2a0c1b48ab28009e52ad4a1ba">00531</a> <span class="keyword">typedef</span> <span class="keyword">const</span> <span class="keywordtype">char</span> * (*column_text_blob_t)(<a class="code" href="sqlite3_8h.html#af2a033da1327cdd77f0a174a09aedd0c">sqlite3_stmt</a> *, int);
<a name="l00532"></a>00532 
<a name="l00533"></a><a class="code" href="libluasqlite3_8c.html#a3a3cbada7f01ea807eff28169bba43b6">00533</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="libluasqlite3_8c.html#a3a3cbada7f01ea807eff28169bba43b6">l_sqlite3_column_text_or_blob</a>(<a class="code" href="structlua__State.html">lua_State</a> * L, <a class="code" href="libluasqlite3_8c.html#ae144eeb2a0c1b48ab28009e52ad4a1ba">column_text_blob_t</a> column_text_blob)
<a name="l00534"></a>00534 {
<a name="l00535"></a>00535   <a class="code" href="sqlite3_8h.html#af2a033da1327cdd77f0a174a09aedd0c">sqlite3_stmt</a> * stmt =  <a class="code" href="libluasqlite3_8c.html#a52bfdf41a0cbfdd865008b84e6974383">checkstmt_stmt</a>(L, 1);
<a name="l00536"></a>00536   <span class="keywordtype">int</span> column    = <a class="code" href="libluasqlite3_8c.html#a35c42e01e373065d3a0afe7367d364c1">checkint</a>(L, 2);
<a name="l00537"></a>00537   
<a name="l00538"></a>00538   <a class="code" href="lapi_8c.html#ad457b6dc1bc1b6d5cf9b625c5b329e5e">lua_pushlstring</a>(L,  column_text_blob(stmt, column), <a class="code" href="sqlite3_8h.html#a139c52b22f8c1183edf7708fa291aec4">sqlite3_column_bytes</a>(stmt, column));
<a name="l00539"></a>00539   <span class="keywordflow">return</span> 1;
<a name="l00540"></a>00540 }
<a name="l00541"></a>00541 
<a name="l00542"></a><a class="code" href="libluasqlite3_8c.html#a1e016350402e39b74beb8358f38a62a4">00542</a> <a class="code" href="libluasqlite3_8c.html#a4cb9e74c8e392bdf896eeca0586218cf">FUNC</a>( l_sqlite3_column_blob )
<a name="l00543"></a>00543 {
<a name="l00544"></a>00544   <span class="keywordflow">return</span> <a class="code" href="libluasqlite3_8c.html#a3a3cbada7f01ea807eff28169bba43b6">l_sqlite3_column_text_or_blob</a>(L, (<a class="code" href="libluasqlite3_8c.html#ae144eeb2a0c1b48ab28009e52ad4a1ba">column_text_blob_t</a>)<a class="code" href="sqlite3_8h.html#a5d8f43f1554039ceb9bec0bbffd63887">sqlite3_column_blob</a>);
<a name="l00545"></a>00545 }
<a name="l00546"></a>00546 
<a name="l00547"></a><a class="code" href="libluasqlite3_8c.html#a7c8f14a8077e75c8bebca2b7930ef3cc">00547</a> <a class="code" href="libluasqlite3_8c.html#a4cb9e74c8e392bdf896eeca0586218cf">FUNC</a>( l_sqlite3_column_text )
<a name="l00548"></a>00548 {
<a name="l00549"></a>00549   <span class="keywordflow">return</span> <a class="code" href="libluasqlite3_8c.html#a3a3cbada7f01ea807eff28169bba43b6">l_sqlite3_column_text_or_blob</a>(L, (<a class="code" href="libluasqlite3_8c.html#ae144eeb2a0c1b48ab28009e52ad4a1ba">column_text_blob_t</a>)<a class="code" href="sqlite3_8h.html#adebe4cf494727dd2e9c0d22c2a629d2f">sqlite3_column_text</a>); <span class="comment">/* FIXME: remove cast when API changes!!! */</span>
<a name="l00550"></a>00550 }
<a name="l00551"></a>00551 
<a name="l00552"></a>00552 
<a name="l00553"></a><a class="code" href="libluasqlite3_8c.html#a797d98f2796da7333602650c026f80b1">00553</a> <a class="code" href="libluasqlite3_8c.html#a4cb9e74c8e392bdf896eeca0586218cf">FUNC</a>( l_sqlite3_column_int )
<a name="l00554"></a>00554 {
<a name="l00555"></a>00555   <a class="code" href="lapi_8c.html#a328625a03fbb5548f27b1af10f109f6a">lua_pushnumber</a>(L, <a class="code" href="sqlite3_8h.html#a2fb75f411c508be8480074c2b5528b5f">sqlite3_column_int</a>(<a class="code" href="libluasqlite3_8c.html#a52bfdf41a0cbfdd865008b84e6974383">checkstmt_stmt</a>(L, 1), <a class="code" href="libluasqlite3_8c.html#a35c42e01e373065d3a0afe7367d364c1">checkint</a>(L, 2)) );
<a name="l00556"></a>00556   <span class="keywordflow">return</span> 1;
<a name="l00557"></a>00557 }
<a name="l00558"></a>00558 
<a name="l00559"></a>00559 
<a name="l00560"></a><a class="code" href="libluasqlite3_8c.html#ad06bbe3df6d182b78a0a527d84724492">00560</a> <a class="code" href="libluasqlite3_8c.html#a4cb9e74c8e392bdf896eeca0586218cf">FUNC</a>( l_sqlite3_column_double )
<a name="l00561"></a>00561 {
<a name="l00562"></a>00562   <a class="code" href="lapi_8c.html#a328625a03fbb5548f27b1af10f109f6a">lua_pushnumber</a>(L, <a class="code" href="sqlite3_8h.html#a838a6af471e90bc080b08a6219099de9">sqlite3_column_double</a>(<a class="code" href="libluasqlite3_8c.html#a52bfdf41a0cbfdd865008b84e6974383">checkstmt_stmt</a>(L, 1), <a class="code" href="libluasqlite3_8c.html#a35c42e01e373065d3a0afe7367d364c1">checkint</a>(L, 2)) );
<a name="l00563"></a>00563   <span class="keywordflow">return</span> 1;
<a name="l00564"></a>00564 }
<a name="l00565"></a>00565 
<a name="l00566"></a>00566 
<a name="l00567"></a><a class="code" href="libluasqlite3_8c.html#a62ec168180a66699ee6040a0afcb84a9">00567</a> <a class="code" href="libluasqlite3_8c.html#a4cb9e74c8e392bdf896eeca0586218cf">FUNC</a>( l_sqlite3_column_number )
<a name="l00568"></a>00568 {
<a name="l00569"></a>00569   <a class="code" href="sqlite3_8h.html#af2a033da1327cdd77f0a174a09aedd0c">sqlite3_stmt</a> * stmt = <a class="code" href="libluasqlite3_8c.html#a52bfdf41a0cbfdd865008b84e6974383">checkstmt_stmt</a>(L, 1);
<a name="l00570"></a>00570   <span class="keywordtype">int</span> column    = <a class="code" href="libluasqlite3_8c.html#a35c42e01e373065d3a0afe7367d364c1">checkint</a>(L, 2);
<a name="l00571"></a>00571   
<a name="l00572"></a>00572   <span class="keywordflow">if</span> ( <a class="code" href="sqlite3_8h.html#a7e076f91f53b4936cd6f2ce4b078bcc1">sqlite3_column_type</a>(stmt, column) == <a class="code" href="sqlite3_8h.html#a7453d71905f10fa330940428f8abe21c">SQLITE_INTEGER</a> )
<a name="l00573"></a>00573     <a class="code" href="lapi_8c.html#a328625a03fbb5548f27b1af10f109f6a">lua_pushnumber</a>(L, <a class="code" href="sqlite3_8h.html#a2fb75f411c508be8480074c2b5528b5f">sqlite3_column_int</a>(stmt, column) );
<a name="l00574"></a>00574   <span class="keywordflow">else</span>
<a name="l00575"></a>00575     <a class="code" href="lapi_8c.html#a328625a03fbb5548f27b1af10f109f6a">lua_pushnumber</a>(L,<a class="code" href="sqlite3_8h.html#a838a6af471e90bc080b08a6219099de9">sqlite3_column_double</a>(stmt, column) );
<a name="l00576"></a>00576   
<a name="l00577"></a>00577   <span class="keywordflow">return</span> 1;
<a name="l00578"></a>00578 }
<a name="l00579"></a>00579 
<a name="l00580"></a>00580 
<a name="l00581"></a>00581 
<a name="l00582"></a>00582   
<a name="l00583"></a><a class="code" href="libluasqlite3_8c.html#aa27a11d1254cb7cee907e565edc41923">00583</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="libluasqlite3_8c.html#aa27a11d1254cb7cee907e565edc41923">push_column</a>(<a class="code" href="structlua__State.html">lua_State</a> * L, <a class="code" href="sqlite3_8h.html#af2a033da1327cdd77f0a174a09aedd0c">sqlite3_stmt</a> * stmt, <span class="keywordtype">int</span> column)
<a name="l00584"></a>00584 {
<a name="l00585"></a>00585   <span class="keywordflow">switch</span>(<a class="code" href="sqlite3_8h.html#a7e076f91f53b4936cd6f2ce4b078bcc1">sqlite3_column_type</a>(stmt, column))
<a name="l00586"></a>00586   {
<a name="l00587"></a>00587     <span class="keywordflow">case</span> <a class="code" href="sqlite3_8h.html#afd180931f2d06d6c245791d187da5802">SQLITE_NULL</a>:
<a name="l00588"></a>00588       <a class="code" href="lapi_8c.html#a1b4cd0d80f51e5545a97ca6c28c03c50">lua_pushnil</a>(L);
<a name="l00589"></a>00589       <span class="keywordflow">break</span>;
<a name="l00590"></a>00590     
<a name="l00591"></a>00591     <span class="keywordflow">case</span> <a class="code" href="sqlite3_8h.html#a7453d71905f10fa330940428f8abe21c">SQLITE_INTEGER</a>:
<a name="l00592"></a>00592       <a class="code" href="lapi_8c.html#a328625a03fbb5548f27b1af10f109f6a">lua_pushnumber</a>(L, <a class="code" href="sqlite3_8h.html#a2fb75f411c508be8480074c2b5528b5f">sqlite3_column_int</a>(stmt, column));
<a name="l00593"></a>00593       <span class="keywordflow">break</span>;
<a name="l00594"></a>00594     
<a name="l00595"></a>00595     <span class="keywordflow">case</span> <a class="code" href="sqlite3_8h.html#a0f415018bddf6542e69792aee0357984">SQLITE_FLOAT</a>:
<a name="l00596"></a>00596       <a class="code" href="lapi_8c.html#a328625a03fbb5548f27b1af10f109f6a">lua_pushnumber</a>(L, <a class="code" href="sqlite3_8h.html#a838a6af471e90bc080b08a6219099de9">sqlite3_column_double</a>(stmt, column));
<a name="l00597"></a>00597       <span class="keywordflow">break</span>;
<a name="l00598"></a>00598     
<a name="l00599"></a>00599     <span class="keywordflow">case</span> <a class="code" href="sqlite3_8h.html#accfdca5d473931c3959bbdf4fc5c2ead">SQLITE_TEXT</a>:
<a name="l00600"></a>00600       <a class="code" href="lapi_8c.html#ad457b6dc1bc1b6d5cf9b625c5b329e5e">lua_pushlstring</a>(L, (<span class="keyword">const</span> <span class="keywordtype">char</span>*)<a class="code" href="sqlite3_8h.html#adebe4cf494727dd2e9c0d22c2a629d2f">sqlite3_column_text</a>(stmt, column), <a class="code" href="sqlite3_8h.html#a139c52b22f8c1183edf7708fa291aec4">sqlite3_column_bytes</a>(stmt, column));
<a name="l00601"></a>00601       <span class="keywordflow">break</span>;
<a name="l00602"></a>00602     
<a name="l00603"></a>00603     <span class="keywordflow">case</span> <a class="code" href="sqlite3_8h.html#a26c29a137b2a35bbde7048e5e48b794a">SQLITE_BLOB</a>:
<a name="l00604"></a>00604       <a class="code" href="lapi_8c.html#ad457b6dc1bc1b6d5cf9b625c5b329e5e">lua_pushlstring</a>(L, <a class="code" href="sqlite3_8h.html#a5d8f43f1554039ceb9bec0bbffd63887">sqlite3_column_blob</a>(stmt, column), <a class="code" href="sqlite3_8h.html#a139c52b22f8c1183edf7708fa291aec4">sqlite3_column_bytes</a>(stmt, column));
<a name="l00605"></a>00605       <span class="keywordflow">break</span>;
<a name="l00606"></a>00606     
<a name="l00607"></a>00607     <span class="keywordflow">default</span>:
<a name="l00608"></a>00608       <a class="code" href="lapi_8c.html#a56bbb7479265e38da2e2596e6ec25faa">lua_pushboolean</a>(L, 0);
<a name="l00609"></a>00609   }
<a name="l00610"></a>00610 }
<a name="l00611"></a>00611 
<a name="l00612"></a>00612 
<a name="l00613"></a><a class="code" href="libluasqlite3_8c.html#ae65a75d0b0d95a954cc0778f2dab62f0">00613</a> <a class="code" href="libluasqlite3_8c.html#a4cb9e74c8e392bdf896eeca0586218cf">FUNC</a>( l_sqlite3_column )
<a name="l00614"></a>00614 {
<a name="l00615"></a>00615   <a class="code" href="libluasqlite3_8c.html#aa27a11d1254cb7cee907e565edc41923">push_column</a>(L, <a class="code" href="libluasqlite3_8c.html#a52bfdf41a0cbfdd865008b84e6974383">checkstmt_stmt</a>(L, 1), <a class="code" href="libluasqlite3_8c.html#a35c42e01e373065d3a0afe7367d364c1">checkint</a>(L, 2));
<a name="l00616"></a>00616   <span class="keywordflow">return</span> 1;
<a name="l00617"></a>00617 }
<a name="l00618"></a>00618 
<a name="l00619"></a>00619 
<a name="l00620"></a>00620 <span class="comment">/*</span>
<a name="l00621"></a>00621 <span class="comment"> * mode: 0 = direct, 1 = integer, 2 = alphanumeric</span>
<a name="l00622"></a>00622 <span class="comment"> */</span>
<a name="l00623"></a><a class="code" href="libluasqlite3_8c.html#a78bc52170fb8aca358afa69cbaddd194">00623</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="libluasqlite3_8c.html#a78bc52170fb8aca358afa69cbaddd194">l_sqlite3_row_mode</a>(<a class="code" href="structlua__State.html">lua_State</a> * L, <span class="keywordtype">int</span> mode)
<a name="l00624"></a>00624 {
<a name="l00625"></a>00625   <span class="comment">/* Old code / Just a reminder / To be removed: </span>
<a name="l00626"></a>00626 <span class="comment">  ** checkargs(L, 1, 2, CHECK_PTR, CHECK_NILTABLE, 0);</span>
<a name="l00627"></a>00627 <span class="comment">  */</span>
<a name="l00628"></a>00628   
<a name="l00629"></a>00629   <a class="code" href="sqlite3_8h.html#af2a033da1327cdd77f0a174a09aedd0c">sqlite3_stmt</a> * stmt = <a class="code" href="libluasqlite3_8c.html#a52bfdf41a0cbfdd865008b84e6974383">checkstmt_stmt</a>(L, 1);
<a name="l00630"></a>00630   <span class="keywordtype">int</span> num_columns = <a class="code" href="sqlite3_8h.html#ab1f136b177ca59a20354ab34163dc16b">sqlite3_data_count</a>(stmt); <span class="comment">/* Maybe wrong state, so don&apos;t use sqlite3_column_count */</span>
<a name="l00631"></a>00631   <span class="keywordtype">int</span> index;
<a name="l00632"></a>00632   
<a name="l00633"></a>00633   <span class="comment">/* XXX Should really be cleaned up... Fixme! */</span>
<a name="l00634"></a>00634   
<a name="l00635"></a>00635   <span class="keywordflow">if</span> (mode == 0)
<a name="l00636"></a>00636     <a class="code" href="lapi_8c.html#acea2383413b1e10bee681b109bad5b59">lua_checkstack</a>(L, num_columns);
<a name="l00637"></a>00637   <span class="keywordflow">else</span>
<a name="l00638"></a>00638     <span class="keywordflow">if</span> (!<a class="code" href="lua_8h.html#a161af51893c5f79dacc1c382416a5f27">lua_istable</a>(L, -1))
<a name="l00639"></a>00639       <a class="code" href="lua_8h.html#aa59db6b784aa1ec954599a44168c7761">lua_newtable</a>(L);
<a name="l00640"></a>00640   
<a name="l00641"></a>00641   <span class="keywordflow">for</span> (index=0; index&lt;num_columns; index++)
<a name="l00642"></a>00642     <span class="keywordflow">switch</span>(mode)
<a name="l00643"></a>00643     {
<a name="l00644"></a>00644       <span class="keywordflow">case</span> 0: <span class="comment">/* direct mode */</span>
<a name="l00645"></a>00645         <a class="code" href="libluasqlite3_8c.html#aa27a11d1254cb7cee907e565edc41923">push_column</a>(L, stmt, index);
<a name="l00646"></a>00646         <span class="keywordflow">break</span>;
<a name="l00647"></a>00647       
<a name="l00648"></a>00648       <span class="keywordflow">case</span> 1: <span class="comment">/* integer mode */</span>
<a name="l00649"></a>00649         <a class="code" href="libluasqlite3_8c.html#aa27a11d1254cb7cee907e565edc41923">push_column</a>(L, stmt, index);
<a name="l00650"></a>00650         <a class="code" href="lapi_8c.html#a89eb1578890571d202f8b3c357c822bc">lua_rawseti</a>(L, -2, index+1);
<a name="l00651"></a>00651         <span class="keywordflow">break</span>;
<a name="l00652"></a>00652       
<a name="l00653"></a>00653       <span class="keywordflow">case</span> 2: <span class="comment">/* alphanumeric mode */</span>
<a name="l00654"></a>00654         <a class="code" href="lapi_8c.html#a1281a7e2b52370cc416123bfd32b1b29">lua_pushstring</a>(L, <a class="code" href="sqlite3_8h.html#a91645a73cd77747f5ae81b35e43e7d3d">sqlite3_column_name</a>(stmt, index));
<a name="l00655"></a>00655         <a class="code" href="libluasqlite3_8c.html#aa27a11d1254cb7cee907e565edc41923">push_column</a>(L, stmt, index);
<a name="l00656"></a>00656         <a class="code" href="lapi_8c.html#afb2d27f421677ef40425f9054ae216a7">lua_rawset</a>(L, -3);
<a name="l00657"></a>00657         <span class="keywordflow">break</span>;
<a name="l00658"></a>00658       
<a name="l00659"></a>00659       <span class="keywordflow">default</span>:
<a name="l00660"></a>00660         <a class="code" href="libluasqlite3_8c.html#a651d62983f0f11075ab3608c220fc397">report_error</a>(L, <span class="stringliteral">&quot;libluasqlite3: Internal error in sqlite3_row_mode&quot;</span>);
<a name="l00661"></a>00661     }
<a name="l00662"></a>00662   
<a name="l00663"></a>00663   <span class="keywordflow">if</span> (mode)
<a name="l00664"></a>00664     <span class="keywordflow">return</span> 1;
<a name="l00665"></a>00665   <span class="keywordflow">else</span>
<a name="l00666"></a>00666     <span class="keywordflow">return</span> num_columns;
<a name="l00667"></a>00667 }
<a name="l00668"></a>00668 
<a name="l00669"></a><a class="code" href="libluasqlite3_8c.html#a3d7ca50fecd59c85e71a14b1da83499c">00669</a> <a class="code" href="libluasqlite3_8c.html#a4cb9e74c8e392bdf896eeca0586218cf">FUNC</a>( l_sqlite3_drow )
<a name="l00670"></a>00670 {
<a name="l00671"></a>00671   <span class="keywordflow">return</span> <a class="code" href="libluasqlite3_8c.html#a78bc52170fb8aca358afa69cbaddd194">l_sqlite3_row_mode</a>(L, 0);
<a name="l00672"></a>00672 }
<a name="l00673"></a>00673 
<a name="l00674"></a><a class="code" href="libluasqlite3_8c.html#a29ba677a74cb9d964b992d03b6ad97a9">00674</a> <a class="code" href="libluasqlite3_8c.html#a4cb9e74c8e392bdf896eeca0586218cf">FUNC</a>( l_sqlite3_irow )
<a name="l00675"></a>00675 {
<a name="l00676"></a>00676   <span class="keywordflow">return</span> <a class="code" href="libluasqlite3_8c.html#a78bc52170fb8aca358afa69cbaddd194">l_sqlite3_row_mode</a>(L, 1);
<a name="l00677"></a>00677 }
<a name="l00678"></a>00678 
<a name="l00679"></a><a class="code" href="libluasqlite3_8c.html#abe70bd30893fdbc8c1db97ad76fe42e2">00679</a> <a class="code" href="libluasqlite3_8c.html#a4cb9e74c8e392bdf896eeca0586218cf">FUNC</a>( l_sqlite3_arow )
<a name="l00680"></a>00680 {
<a name="l00681"></a>00681   <span class="keywordflow">return</span> <a class="code" href="libluasqlite3_8c.html#a78bc52170fb8aca358afa69cbaddd194">l_sqlite3_row_mode</a>(L, 2);
<a name="l00682"></a>00682 }
<a name="l00683"></a>00683 
<a name="l00684"></a>00684 
<a name="l00685"></a><a class="code" href="libluasqlite3_8c.html#a105a3089c046be6a7cc4de5c710af9d4">00685</a> <a class="code" href="libluasqlite3_8c.html#a4cb9e74c8e392bdf896eeca0586218cf">FUNC</a>( l_sqlite3_column_type )
<a name="l00686"></a>00686 {
<a name="l00687"></a>00687   <a class="code" href="lapi_8c.html#a328625a03fbb5548f27b1af10f109f6a">lua_pushnumber</a>(L, <a class="code" href="sqlite3_8h.html#a7e076f91f53b4936cd6f2ce4b078bcc1">sqlite3_column_type</a>(<a class="code" href="libluasqlite3_8c.html#a52bfdf41a0cbfdd865008b84e6974383">checkstmt_stmt</a>(L, 1), <a class="code" href="libluasqlite3_8c.html#a35c42e01e373065d3a0afe7367d364c1">checkint</a>(L, 2)) );
<a name="l00688"></a>00688   <span class="keywordflow">return</span> 1;
<a name="l00689"></a>00689 }
<a name="l00690"></a>00690 
<a name="l00691"></a>00691 
<a name="l00692"></a><a class="code" href="libluasqlite3_8c.html#abea37eafcc4cf47103cd6447bb13b70b">00692</a> <a class="code" href="libluasqlite3_8c.html#a4cb9e74c8e392bdf896eeca0586218cf">FUNC</a>( l_sqlite3_column_count )
<a name="l00693"></a>00693 {
<a name="l00694"></a>00694   <a class="code" href="lapi_8c.html#a328625a03fbb5548f27b1af10f109f6a">lua_pushnumber</a>(L, <a class="code" href="sqlite3_8h.html#a7a4eefc77c19b661a6ba063ddf12326a">sqlite3_column_count</a>(<a class="code" href="libluasqlite3_8c.html#a52bfdf41a0cbfdd865008b84e6974383">checkstmt_stmt</a>(L, 1)) );
<a name="l00695"></a>00695   <span class="keywordflow">return</span> 1;
<a name="l00696"></a>00696 }
<a name="l00697"></a>00697 
<a name="l00698"></a>00698 
<a name="l00699"></a>00699 
<a name="l00700"></a><a class="code" href="libluasqlite3_8c.html#a2d5f8335ae1d3725976e94b53051ec52">00700</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="libluasqlite3_8c.html#a2d5f8335ae1d3725976e94b53051ec52">l_sqlite3_column_info</a>(<a class="code" href="structlua__State.html">lua_State</a> * L, <span class="keyword">const</span> <span class="keywordtype">char</span> * (*info_func)(<a class="code" href="sqlite3_8h.html#af2a033da1327cdd77f0a174a09aedd0c">sqlite3_stmt</a>*,<span class="keywordtype">int</span>) )
<a name="l00701"></a>00701 {
<a name="l00702"></a>00702   <span class="keyword">const</span> <span class="keywordtype">char</span> * info = info_func(<a class="code" href="libluasqlite3_8c.html#a52bfdf41a0cbfdd865008b84e6974383">checkstmt_stmt</a>(L, 1), <a class="code" href="libluasqlite3_8c.html#a35c42e01e373065d3a0afe7367d364c1">checkint</a>(L, 2));
<a name="l00703"></a>00703   
<a name="l00704"></a>00704   <span class="keywordflow">if</span> (info)
<a name="l00705"></a>00705     <a class="code" href="lapi_8c.html#a1281a7e2b52370cc416123bfd32b1b29">lua_pushstring</a>(L, info);
<a name="l00706"></a>00706   <span class="keywordflow">else</span>
<a name="l00707"></a>00707     <a class="code" href="lapi_8c.html#a1281a7e2b52370cc416123bfd32b1b29">lua_pushstring</a>(L, <span class="stringliteral">&quot;&quot;</span>);
<a name="l00708"></a>00708   
<a name="l00709"></a>00709   <span class="keywordflow">return</span> 1;
<a name="l00710"></a>00710 }
<a name="l00711"></a>00711 
<a name="l00712"></a><a class="code" href="libluasqlite3_8c.html#a7f358ebf7f700eabaf5b02590121effd">00712</a> <a class="code" href="libluasqlite3_8c.html#a4cb9e74c8e392bdf896eeca0586218cf">FUNC</a>( l_sqlite3_column_decltype )
<a name="l00713"></a>00713 {
<a name="l00714"></a>00714   <span class="keywordflow">return</span> <a class="code" href="libluasqlite3_8c.html#a2d5f8335ae1d3725976e94b53051ec52">l_sqlite3_column_info</a>(L, <a class="code" href="sqlite3_8h.html#a03ceaf2a25b363cf4014171abc1781a6">sqlite3_column_decltype</a>);
<a name="l00715"></a>00715 }
<a name="l00716"></a>00716 
<a name="l00717"></a><a class="code" href="libluasqlite3_8c.html#a7dc8325a1ed5fb9b88b6e8d56ce0970e">00717</a> <a class="code" href="libluasqlite3_8c.html#a4cb9e74c8e392bdf896eeca0586218cf">FUNC</a>( l_sqlite3_column_name )
<a name="l00718"></a>00718 {
<a name="l00719"></a>00719   <span class="keywordflow">return</span> <a class="code" href="libluasqlite3_8c.html#a2d5f8335ae1d3725976e94b53051ec52">l_sqlite3_column_info</a>(L, <a class="code" href="sqlite3_8h.html#a91645a73cd77747f5ae81b35e43e7d3d">sqlite3_column_name</a>);
<a name="l00720"></a>00720 }
<a name="l00721"></a>00721 
<a name="l00722"></a>00722 
<a name="l00723"></a><a class="code" href="libluasqlite3_8c.html#a4d54b34329ebb463311428fa84dcdb1d">00723</a> <a class="code" href="libluasqlite3_8c.html#a4cb9e74c8e392bdf896eeca0586218cf">FUNC</a>( l_sqlite3_complete )
<a name="l00724"></a>00724 {
<a name="l00725"></a>00725   <a class="code" href="lapi_8c.html#a56bbb7479265e38da2e2596e6ec25faa">lua_pushboolean</a>(L, <a class="code" href="complete_8c.html#a8eec9a0a9bbde7efd4dd0cb6d15d2ddf">sqlite3_complete</a>(<a class="code" href="libluasqlite3_8c.html#ab6b4e8ab6d4565c7048dd4afabd79b19">checkstr</a>(L, 1)) );
<a name="l00726"></a>00726   <span class="keywordflow">return</span> 1;
<a name="l00727"></a>00727 }
<a name="l00728"></a>00728 
<a name="l00729"></a>00729 
<a name="l00730"></a><a class="code" href="libluasqlite3_8c.html#a393badcb1dae4a86b401d0ecf9711ae5">00730</a> <a class="code" href="libluasqlite3_8c.html#a4cb9e74c8e392bdf896eeca0586218cf">FUNC</a>( l_sqlite3_data_count )
<a name="l00731"></a>00731 {
<a name="l00732"></a>00732   <a class="code" href="lapi_8c.html#a328625a03fbb5548f27b1af10f109f6a">lua_pushnumber</a>(L, <a class="code" href="sqlite3_8h.html#ab1f136b177ca59a20354ab34163dc16b">sqlite3_data_count</a>(<a class="code" href="libluasqlite3_8c.html#a52bfdf41a0cbfdd865008b84e6974383">checkstmt_stmt</a>(L, 1)) );
<a name="l00733"></a>00733   <span class="keywordflow">return</span> 1;
<a name="l00734"></a>00734 }
<a name="l00735"></a>00735 
<a name="l00736"></a>00736 
<a name="l00737"></a><a class="code" href="libluasqlite3_8c.html#a525d2b6ae556a0576754fea9f8c911f6">00737</a> <a class="code" href="libluasqlite3_8c.html#a4cb9e74c8e392bdf896eeca0586218cf">FUNC</a>( l_sqlite3_errcode )
<a name="l00738"></a>00738 {
<a name="l00739"></a>00739   <a class="code" href="lapi_8c.html#a328625a03fbb5548f27b1af10f109f6a">lua_pushnumber</a>(L, <a class="code" href="main_8c.html#aacf8bb5cc3e174eca0c6aab77aa9d4ec">sqlite3_errcode</a>(<a class="code" href="libluasqlite3_8c.html#ad6b640fae60f959363e6ef256b6307b2">checkdb_sqlite3</a>(L, 1)) );
<a name="l00740"></a>00740   <span class="keywordflow">return</span> 1;
<a name="l00741"></a>00741 }
<a name="l00742"></a>00742 
<a name="l00743"></a>00743 
<a name="l00744"></a><a class="code" href="libluasqlite3_8c.html#ad39a41eb34ae19b6f20a1145318e7a0e">00744</a> <a class="code" href="libluasqlite3_8c.html#a4cb9e74c8e392bdf896eeca0586218cf">FUNC</a>( l_sqlite3_errmsg )
<a name="l00745"></a>00745 {
<a name="l00746"></a>00746   <a class="code" href="lapi_8c.html#a1281a7e2b52370cc416123bfd32b1b29">lua_pushstring</a>(L, <a class="code" href="main_8c.html#ad2a9feca40ee5a7c629c2af6d0ae1d27">sqlite3_errmsg</a>(<a class="code" href="libluasqlite3_8c.html#ad6b640fae60f959363e6ef256b6307b2">checkdb_sqlite3</a>(L, 1)) );
<a name="l00747"></a>00747   <span class="keywordflow">return</span> 1;
<a name="l00748"></a>00748 }
<a name="l00749"></a>00749 
<a name="l00750"></a>00750 
<a name="l00751"></a><a class="code" href="libluasqlite3_8c.html#a642092d8b34c01137f93a1284955da60">00751</a> <a class="code" href="libluasqlite3_8c.html#a4cb9e74c8e392bdf896eeca0586218cf">FUNC</a>( l_sqlite3_finalize )
<a name="l00752"></a>00752 {
<a name="l00753"></a>00753   <a class="code" href="lapi_8c.html#a328625a03fbb5548f27b1af10f109f6a">lua_pushnumber</a>(L, <a class="code" href="sqlite3_8h.html#aaf6c3dbc23f33c0752588425c7e9d498">sqlite3_finalize</a>(<a class="code" href="libluasqlite3_8c.html#a52bfdf41a0cbfdd865008b84e6974383">checkstmt_stmt</a>(L, 1)) );
<a name="l00754"></a>00754   <span class="keywordflow">return</span> 1;
<a name="l00755"></a>00755 }
<a name="l00756"></a>00756 
<a name="l00757"></a>00757 
<a name="l00758"></a><a class="code" href="libluasqlite3_8c.html#a330f1b2f2612c0f4e359fe517631700f">00758</a> <a class="code" href="libluasqlite3_8c.html#a4cb9e74c8e392bdf896eeca0586218cf">FUNC</a>( l_sqlite3_interrupt )
<a name="l00759"></a>00759 {
<a name="l00760"></a>00760   <a class="code" href="main_8c.html#a6105f4c9687e243ce3d1706b34100c5f">sqlite3_interrupt</a>(<a class="code" href="libluasqlite3_8c.html#ad6b640fae60f959363e6ef256b6307b2">checkdb_sqlite3</a>(L, 1));
<a name="l00761"></a>00761   <span class="keywordflow">return</span> 0;
<a name="l00762"></a>00762 }
<a name="l00763"></a>00763 
<a name="l00764"></a>00764 
<a name="l00765"></a><a class="code" href="libluasqlite3_8c.html#ad8e854ff94ed823d3b4f186edde858e7">00765</a> <a class="code" href="libluasqlite3_8c.html#a4cb9e74c8e392bdf896eeca0586218cf">FUNC</a>( l_sqlite3_last_insert_rowid )
<a name="l00766"></a>00766 {
<a name="l00767"></a>00767   <a class="code" href="lapi_8c.html#a328625a03fbb5548f27b1af10f109f6a">lua_pushnumber</a>(L, <a class="code" href="main_8c.html#ac09d49376c77414ba143635184b7ee10">sqlite3_last_insert_rowid</a>(<a class="code" href="libluasqlite3_8c.html#ad6b640fae60f959363e6ef256b6307b2">checkdb_sqlite3</a>(L, 1)) );
<a name="l00768"></a>00768   <span class="keywordflow">return</span> 1;
<a name="l00769"></a>00769 }
<a name="l00770"></a>00770 
<a name="l00771"></a>00771 
<a name="l00772"></a><a class="code" href="libluasqlite3_8c.html#a9698483ab385d7f2dc9fd3a2db6b7a68">00772</a> <a class="code" href="libluasqlite3_8c.html#a4cb9e74c8e392bdf896eeca0586218cf">FUNC</a>( l_sqlite3_open )
<a name="l00773"></a>00773 {
<a name="l00774"></a>00774   <a class="code" href="structsqlite3.html">sqlite3</a> * <a class="code" href="structsqlite3.html">sqlite3</a>   = <a class="code" href="ac__app__context_8h.html#aacd0e420aa8cad59d1073b70d614e481">ac_global_LogDb</a>-&gt;db;
<a name="l00775"></a>00775   <a class="code" href="structDB.html">DB</a> * <a class="code" href="shell_8c.html#ad6e663497d2c934364b3bcf07496b30b">db</a> = (<a class="code" href="structDB.html">DB</a> *) <a class="code" href="lapi_8c.html#a467bb6f4780b27d6e7de6ee10a80dac5">lua_newuserdata</a>(L, <span class="keyword">sizeof</span>(<a class="code" href="structDB.html">DB</a>));
<a name="l00776"></a>00776   db-&gt;<a class="code" href="structDB.html#a6a6b21b3e3cea8111eb8010475b6603c">kr_db</a> = sqlite3;
<a name="l00777"></a>00777   <span class="keywordflow">return</span> 1; <span class="comment">/* database */</span>
<a name="l00778"></a>00778 }
<a name="l00779"></a>00779 
<a name="l00780"></a>00780 
<a name="l00781"></a><a class="code" href="libluasqlite3_8c.html#a23f5388f3961c250970c50b1e3596da0">00781</a> <a class="code" href="libluasqlite3_8c.html#a4cb9e74c8e392bdf896eeca0586218cf">FUNC</a>( l_sqlite3_prepare )
<a name="l00782"></a>00782 {
<a name="l00783"></a>00783   <span class="comment">/* XXX This piece of code is not so nice. This piece should be redone... */</span>
<a name="l00784"></a>00784   
<a name="l00785"></a>00785   <a class="code" href="structDB.html">DB</a> * <a class="code" href="shell_8c.html#ad6e663497d2c934364b3bcf07496b30b">db</a>     = <a class="code" href="libluasqlite3_8c.html#ab0c20935a6010dcdbc203bd42e035c6f">checkdb</a>(L, 1);
<a name="l00786"></a>00786   <span class="keyword">const</span> <span class="keywordtype">char</span> * sql    = <a class="code" href="libluasqlite3_8c.html#ab6b4e8ab6d4565c7048dd4afabd79b19">checkstr</a>(L, 2);
<a name="l00787"></a>00787   <span class="keywordtype">int</span> sql_size      = <a class="code" href="lua_8h.html#af1950fb3c542d036245559b5f5ae9346">lua_strlen</a>(L, 2);
<a name="l00788"></a>00788   <span class="keyword">const</span> <span class="keywordtype">char</span> * leftover   = 0;
<a name="l00789"></a>00789   <a class="code" href="sqlite3_8h.html#af2a033da1327cdd77f0a174a09aedd0c">sqlite3_stmt</a> * <a class="code" href="sqlite3_8h.html#af2a033da1327cdd77f0a174a09aedd0c">sqlite3_stmt</a>   = 0;
<a name="l00790"></a>00790   <span class="keywordtype">int</span> <a class="code" href="lundump_8c.html#a6776ffdd5e2abf4119b1d45731e9e668">error</a>, leftover_size;
<a name="l00791"></a>00791   <a class="code" href="structStmt.html">Stmt</a> * stmt;
<a name="l00792"></a>00792   
<a name="l00793"></a>00793   <a class="code" href="libluasqlite3_8c.html#ac281ae73f1597e360da4091ca8cb1697">init_callback_usage</a>(L, db);   <span class="comment">/* Needed by trace handler... FIXME: maybe to be removed... */</span>
<a name="l00794"></a>00794   
<a name="l00795"></a>00795   error = <a class="code" href="prepare_8c.html#a2322405eadeb95539ec7c96e2cfdf38b">sqlite3_prepare</a>(db-&gt;<a class="code" href="structDB.html#a6a6b21b3e3cea8111eb8010475b6603c">kr_db</a>, sql, sql_size, &amp;sqlite3_stmt, &amp;leftover);
<a name="l00796"></a>00796   
<a name="l00797"></a>00797   leftover_size = leftover ? sql + sql_size - leftover : 0;
<a name="l00798"></a>00798   
<a name="l00799"></a>00799   <a class="code" href="lapi_8c.html#a328625a03fbb5548f27b1af10f109f6a">lua_pushnumber</a>(L, error);
<a name="l00800"></a>00800   
<a name="l00801"></a>00801   stmt = <a class="code" href="lapi_8c.html#a467bb6f4780b27d6e7de6ee10a80dac5">lua_newuserdata</a>(L, <span class="keyword">sizeof</span>(<a class="code" href="structStmt.html">Stmt</a>));
<a name="l00802"></a>00802   stmt-&gt;<a class="code" href="structStmt.html#a822d805cab8195ae0e1ccde20aa3199c">db</a> = <a class="code" href="libluasqlite3_8c.html#ab0c20935a6010dcdbc203bd42e035c6f">checkdb</a>(L, 1);
<a name="l00803"></a>00803   stmt-&gt;<a class="code" href="structStmt.html#ad4c0b22d5bca2830edcb673e731d6fbe">stmt</a> = sqlite3_stmt;
<a name="l00804"></a>00804   
<a name="l00805"></a>00805   <span class="keywordflow">if</span> (leftover_size &gt; 0)
<a name="l00806"></a>00806     <a class="code" href="lapi_8c.html#ad457b6dc1bc1b6d5cf9b625c5b329e5e">lua_pushlstring</a>(L, leftover, leftover_size);
<a name="l00807"></a>00807   <span class="keywordflow">else</span>
<a name="l00808"></a>00808     <a class="code" href="lapi_8c.html#a1b4cd0d80f51e5545a97ca6c28c03c50">lua_pushnil</a>(L);
<a name="l00809"></a>00809   
<a name="l00810"></a>00810   <span class="keywordflow">return</span> 3; <span class="comment">/* error code, statement, left over */</span>
<a name="l00811"></a>00811 }
<a name="l00812"></a>00812 
<a name="l00813"></a>00813 
<a name="l00814"></a><a class="code" href="libluasqlite3_8c.html#a4d7b0836336d53eefb4ff77aad2590da">00814</a> <a class="code" href="libluasqlite3_8c.html#a4cb9e74c8e392bdf896eeca0586218cf">FUNC</a>( l_sqlite3_reset )
<a name="l00815"></a>00815 {
<a name="l00816"></a>00816   <a class="code" href="lapi_8c.html#a328625a03fbb5548f27b1af10f109f6a">lua_pushnumber</a>(L, <a class="code" href="sqlite3_8h.html#a4f90cba6b396574cf3d5b1ac009de0c7">sqlite3_reset</a>(<a class="code" href="libluasqlite3_8c.html#a52bfdf41a0cbfdd865008b84e6974383">checkstmt_stmt</a>(L, 1)) );
<a name="l00817"></a>00817   <span class="keywordflow">return</span> 1;
<a name="l00818"></a>00818 }
<a name="l00819"></a>00819 
<a name="l00820"></a>00820 
<a name="l00821"></a><a class="code" href="libluasqlite3_8c.html#a44bfd2e42c27862798b6ec2ca0f268ee">00821</a> <a class="code" href="libluasqlite3_8c.html#a4cb9e74c8e392bdf896eeca0586218cf">FUNC</a>( l_sqlite3_step )
<a name="l00822"></a>00822 {
<a name="l00823"></a>00823   <a class="code" href="structStmt.html">Stmt</a> * stmt = <a class="code" href="libluasqlite3_8c.html#a5d26f2f8d8b765e23c3d474c531fa22c">checkstmt</a>(L, 1);
<a name="l00824"></a>00824   <a class="code" href="libluasqlite3_8c.html#ac281ae73f1597e360da4091ca8cb1697">init_callback_usage</a>(L, stmt-&gt;<a class="code" href="structStmt.html#a822d805cab8195ae0e1ccde20aa3199c">db</a>);
<a name="l00825"></a>00825   <a class="code" href="lapi_8c.html#a328625a03fbb5548f27b1af10f109f6a">lua_pushnumber</a>(L, <a class="code" href="sqlite3_8h.html#ae04a3cf3ae391dabf1161cc0e040e9e8">sqlite3_step</a>(stmt-&gt;<a class="code" href="structStmt.html#ad4c0b22d5bca2830edcb673e731d6fbe">stmt</a>) );
<a name="l00826"></a>00826   <span class="keywordflow">return</span> 1;
<a name="l00827"></a>00827 }
<a name="l00828"></a>00828 
<a name="l00829"></a>00829 
<a name="l00830"></a><a class="code" href="libluasqlite3_8c.html#aeb2012450a9637c5c746b9bb913ee289">00830</a> <a class="code" href="libluasqlite3_8c.html#a4cb9e74c8e392bdf896eeca0586218cf">FUNC</a>( l_sqlite3_total_changes )
<a name="l00831"></a>00831 {
<a name="l00832"></a>00832   <a class="code" href="lapi_8c.html#a328625a03fbb5548f27b1af10f109f6a">lua_pushnumber</a>(L, <a class="code" href="main_8c.html#ac49cd48c8f4de5e37ada7167342dcf97">sqlite3_total_changes</a>(<a class="code" href="libluasqlite3_8c.html#ad6b640fae60f959363e6ef256b6307b2">checkdb_sqlite3</a>(L, 1)) );
<a name="l00833"></a>00833   <span class="keywordflow">return</span> 1;
<a name="l00834"></a>00834 }
<a name="l00835"></a>00835 
<a name="l00836"></a>00836 
<a name="l00837"></a>00837 
<a name="l00838"></a><a class="code" href="libluasqlite3_8c.html#acfc7dc0f04f3b72171bd35a512bd0cdb">00838</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="libluasqlite3_8c.html#acfc7dc0f04f3b72171bd35a512bd0cdb">exec_callback_wrapper</a>(<span class="keywordtype">void</span> * cb_data, <span class="keywordtype">int</span> num_columns, <span class="keywordtype">char</span> ** values, <span class="keywordtype">char</span> ** names)
<a name="l00839"></a>00839 {
<a name="l00840"></a>00840   <span class="keywordtype">int</span> index;
<a name="l00841"></a>00841   <a class="code" href="structlua__State.html">lua_State</a> * L = (<a class="code" href="structlua__State.html">lua_State</a> *) cb_data;
<a name="l00842"></a>00842   
<a name="l00843"></a>00843   <a class="code" href="lapi_8c.html#a602f61a9b583d69dc1c72c8970bd65e8">lua_pushvalue</a>(L, 3);  <span class="comment">/* Callback function, resulting stack position 4 */</span>
<a name="l00844"></a>00844   <a class="code" href="lua_8h.html#aa59db6b784aa1ec954599a44168c7761">lua_newtable</a>(L);  <span class="comment">/* Value array, resulting stack position 5 */</span>
<a name="l00845"></a>00845   <a class="code" href="lua_8h.html#aa59db6b784aa1ec954599a44168c7761">lua_newtable</a>(L);  <span class="comment">/* Names array, resulting stack position 6 */</span>
<a name="l00846"></a>00846   
<a name="l00847"></a>00847   <span class="keywordflow">for</span>(index=0; index&lt;num_columns; index++)
<a name="l00848"></a>00848   {
<a name="l00849"></a>00849     <a class="code" href="lapi_8c.html#a1281a7e2b52370cc416123bfd32b1b29">lua_pushstring</a>(L, values[index]); <span class="comment">/* Value */</span>
<a name="l00850"></a>00850     <a class="code" href="lapi_8c.html#a89eb1578890571d202f8b3c357c822bc">lua_rawseti</a>(L, 5, index+1);   <span class="comment">/* C-index are 0 based, Lua index are 1 based... */</span>
<a name="l00851"></a>00851     
<a name="l00852"></a>00852     <a class="code" href="lapi_8c.html#a1281a7e2b52370cc416123bfd32b1b29">lua_pushstring</a>(L, names[index]);  <span class="comment">/* Name */</span>
<a name="l00853"></a>00853     <a class="code" href="lapi_8c.html#a89eb1578890571d202f8b3c357c822bc">lua_rawseti</a>(L, 6, index+1);
<a name="l00854"></a>00854   }
<a name="l00855"></a>00855   
<a name="l00856"></a>00856   <span class="keywordflow">if</span> ( <a class="code" href="lapi_8c.html#a2a6cbad7f1c567378d17ded68b47f8f3">lua_pcall</a>(L, 2, 1, 0) )    <span class="comment">/* In: 2 arrays, Out: result code, On error: leave */</span>
<a name="l00857"></a>00857   {
<a name="l00858"></a>00858     <a class="code" href="lua_8h.html#abb8eae2164badeafdb037bc1e03cc822">lua_pop</a>(L, 1);      <span class="comment">/* delete error message */</span>
<a name="l00859"></a>00859     <span class="keywordflow">return</span> 1;
<a name="l00860"></a>00860   }
<a name="l00861"></a>00861   
<a name="l00862"></a>00862   <span class="keywordflow">return</span> <a class="code" href="libluasqlite3_8c.html#a7d339e5c09255a0cd52524cf4dea8801">pop_break_condition</a>(L);
<a name="l00863"></a>00863 }
<a name="l00864"></a>00864 
<a name="l00865"></a><a class="code" href="libluasqlite3_8c.html#a4871af095243c2bea670de2914355891">00865</a> <a class="code" href="libluasqlite3_8c.html#a4cb9e74c8e392bdf896eeca0586218cf">FUNC</a>( l_sqlite3_exec )
<a name="l00866"></a>00866 {
<a name="l00867"></a>00867   <a class="code" href="structDB.html">DB</a> * <a class="code" href="shell_8c.html#ad6e663497d2c934364b3bcf07496b30b">db</a>   = <a class="code" href="libluasqlite3_8c.html#ab0c20935a6010dcdbc203bd42e035c6f">checkdb</a>(L, 1);
<a name="l00868"></a>00868   <a class="code" href="sqlite3_8h.html#adb558f903738a162410af19b774410fe">sqlite3_callback</a> cb;
<a name="l00869"></a>00869   <span class="keywordtype">void</span> * cb_data;
<a name="l00870"></a>00870   
<a name="l00871"></a>00871   <span class="keywordflow">if</span> ( <a class="code" href="libluasqlite3_8c.html#a7bb1bafa6db5663c092b378528d8f260">checknilornoneorfunc</a>(L, 3) )
<a name="l00872"></a>00872   {
<a name="l00873"></a>00873     cb = <a class="code" href="libluasqlite3_8c.html#acfc7dc0f04f3b72171bd35a512bd0cdb">exec_callback_wrapper</a>;
<a name="l00874"></a>00874     cb_data = L;
<a name="l00875"></a>00875   }
<a name="l00876"></a>00876   <span class="keywordflow">else</span>
<a name="l00877"></a>00877   {
<a name="l00878"></a>00878     cb      = 0;
<a name="l00879"></a>00879     cb_data = 0;
<a name="l00880"></a>00880   }
<a name="l00881"></a>00881   
<a name="l00882"></a>00882   <a class="code" href="libluasqlite3_8c.html#ac281ae73f1597e360da4091ca8cb1697">init_callback_usage</a>(L, db);
<a name="l00883"></a>00883   
<a name="l00884"></a>00884   <a class="code" href="lapi_8c.html#a328625a03fbb5548f27b1af10f109f6a">lua_pushnumber</a>(L, <a class="code" href="legacy_8c.html#ada787486cf95a994521cfd0c64e853e4">sqlite3_exec</a>(db-&gt;<a class="code" href="structDB.html#a6a6b21b3e3cea8111eb8010475b6603c">kr_db</a>, <a class="code" href="libluasqlite3_8c.html#ab6b4e8ab6d4565c7048dd4afabd79b19">checkstr</a>(L, 2), cb, cb_data, 0) );
<a name="l00885"></a>00885   <span class="keywordflow">return</span> 1;
<a name="l00886"></a>00886 }
<a name="l00887"></a>00887 
<a name="l00888"></a>00888 
<a name="l00889"></a>00889 
<a name="l00890"></a><a class="code" href="libluasqlite3_8c.html#a031639f36aa7820038b9eeda2bf15c41">00890</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="libluasqlite3_8c.html#a031639f36aa7820038b9eeda2bf15c41">func_callback_wrapper</a>(<span class="keywordtype">int</span> which, <a class="code" href="structsqlite3__context.html">sqlite3_context</a> * ctx, <span class="keywordtype">int</span> num_args, <a class="code" href="structMem.html">sqlite3_value</a> ** values)
<a name="l00891"></a>00891 {
<a name="l00892"></a>00892   <a class="code" href="structCB__Data.html">CB_Data</a> * cb_data = <a class="code" href="sqlite3_8h.html#ae36489c2fd5b8e831c359b32b04d38f3">sqlite3_user_data</a>(ctx);
<a name="l00893"></a>00893   <a class="code" href="structDB.html">DB</a> *    <a class="code" href="shell_8c.html#ad6e663497d2c934364b3bcf07496b30b">db</a>  = cb_data-&gt;<a class="code" href="structCB__Data.html#acb1ae3d47bae0f31657afc7b1b18e23f">db</a>;
<a name="l00894"></a>00894   <a class="code" href="structlua__State.html">lua_State</a> *   L = db-&gt;<a class="code" href="structDB.html#a2e9a0a1c036dd716f5091edff395de52">L</a>;
<a name="l00895"></a>00895   
<a name="l00896"></a>00896   <span class="keywordflow">switch</span>(which)
<a name="l00897"></a>00897   {
<a name="l00898"></a>00898     <span class="keywordflow">case</span> 0: <a class="code" href="libluasqlite3_8c.html#a7fdf29de7ea3da9d847f28fe34f8ae15">push_callback</a>(L, db, <a class="code" href="libluasqlite3_8c.html#ab62094220b8c227ba9a5cc69b2341895">KEY_XFUNC</a>(cb_data)); <span class="keywordflow">break</span>;
<a name="l00899"></a>00899     <span class="keywordflow">case</span> 1: <a class="code" href="libluasqlite3_8c.html#a7fdf29de7ea3da9d847f28fe34f8ae15">push_callback</a>(L, db, <a class="code" href="libluasqlite3_8c.html#a4f86cddea86ddecbd10d2057be9521c7">KEY_XSTEP</a>(cb_data)); <span class="keywordflow">break</span>;
<a name="l00900"></a>00900     <span class="keywordflow">case</span> 2: <a class="code" href="libluasqlite3_8c.html#a7fdf29de7ea3da9d847f28fe34f8ae15">push_callback</a>(L, db, <a class="code" href="libluasqlite3_8c.html#a0a12b91afdb49303409fb925ba8f0de2">KEY_XFINAL</a>(cb_data)); <span class="keywordflow">break</span>;
<a name="l00901"></a>00901   }
<a name="l00902"></a>00902   
<a name="l00903"></a>00903   <span class="keywordflow">if</span> (<a class="code" href="lua_8h.html#a86d737d7002e7e94023765397c6eef20">lua_isnil</a>(L, -1))
<a name="l00904"></a>00904   {
<a name="l00905"></a>00905     <a class="code" href="lua_8h.html#abb8eae2164badeafdb037bc1e03cc822">lua_pop</a>(L, 1);
<a name="l00906"></a>00906     fprintf(stderr, <span class="stringliteral">&quot;libluasqlite3: func_callback_wrapper: Warning: function is null\n&quot;</span>);
<a name="l00907"></a>00907     <span class="keywordflow">return</span>;
<a name="l00908"></a>00908   }
<a name="l00909"></a>00909   
<a name="l00910"></a>00910   <a class="code" href="lapi_8c.html#a85e3e3d32b068aef62426828a104b561">lua_pushlightuserdata</a>(L, ctx);
<a name="l00911"></a>00911   
<a name="l00912"></a>00912   <span class="keywordflow">if</span> (values)
<a name="l00913"></a>00913   {
<a name="l00914"></a>00914     <a class="code" href="lapi_8c.html#a328625a03fbb5548f27b1af10f109f6a">lua_pushnumber</a>(L, num_args);
<a name="l00915"></a>00915     <a class="code" href="lapi_8c.html#a85e3e3d32b068aef62426828a104b561">lua_pushlightuserdata</a>(L, values);
<a name="l00916"></a>00916   }
<a name="l00917"></a>00917   
<a name="l00918"></a>00918   <span class="keywordflow">if</span> (<a class="code" href="lapi_8c.html#a2a6cbad7f1c567378d17ded68b47f8f3">lua_pcall</a>(L, values ? 3 : 1, 0, 0))
<a name="l00919"></a>00919   {
<a name="l00920"></a>00920     fprintf(stderr, <span class="stringliteral">&quot;libluasqlite3: func_callback_wrapper: Warning: user function error: %s\n&quot;</span>, <a class="code" href="lua_8h.html#ac813fc3bc1886ba17c363d5b4c6e7ef1">lua_tostring</a>(L, -1));
<a name="l00921"></a>00921     <a class="code" href="sqlite3_8h.html#a02826d87e45fd4f04445a3c99a14b54e">sqlite3_result_error</a>(ctx, <a class="code" href="lua_8h.html#ac813fc3bc1886ba17c363d5b4c6e7ef1">lua_tostring</a>(L, -1), <a class="code" href="lua_8h.html#af1950fb3c542d036245559b5f5ae9346">lua_strlen</a>(L, -1));
<a name="l00922"></a>00922     <a class="code" href="lua_8h.html#abb8eae2164badeafdb037bc1e03cc822">lua_pop</a>(L, 1);
<a name="l00923"></a>00923   }
<a name="l00924"></a>00924 }
<a name="l00925"></a>00925 
<a name="l00926"></a><a class="code" href="libluasqlite3_8c.html#ae202359d9977db3a419cec87bb2db964">00926</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="libluasqlite3_8c.html#ae202359d9977db3a419cec87bb2db964">xfunc_callback_wrapper</a>(<a class="code" href="structsqlite3__context.html">sqlite3_context</a> * ctx, <span class="keywordtype">int</span> num_args, <a class="code" href="structMem.html">sqlite3_value</a> ** values)
<a name="l00927"></a>00927 {
<a name="l00928"></a>00928   <a class="code" href="libluasqlite3_8c.html#a031639f36aa7820038b9eeda2bf15c41">func_callback_wrapper</a>(0, ctx, num_args, values);
<a name="l00929"></a>00929 }
<a name="l00930"></a>00930 
<a name="l00931"></a><a class="code" href="libluasqlite3_8c.html#ac97a3bda60a3c0c02a559ef8befd616d">00931</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="libluasqlite3_8c.html#ac97a3bda60a3c0c02a559ef8befd616d">xstep_callback_wrapper</a>(<a class="code" href="structsqlite3__context.html">sqlite3_context</a> * ctx, <span class="keywordtype">int</span> num_args, <a class="code" href="structMem.html">sqlite3_value</a> ** values)
<a name="l00932"></a>00932 {
<a name="l00933"></a>00933   <a class="code" href="libluasqlite3_8c.html#a031639f36aa7820038b9eeda2bf15c41">func_callback_wrapper</a>(1, ctx, num_args, values);
<a name="l00934"></a>00934 }
<a name="l00935"></a>00935 
<a name="l00936"></a><a class="code" href="libluasqlite3_8c.html#aaaf16e2f6b291e505dd7d1caf3bc8195">00936</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="libluasqlite3_8c.html#aaaf16e2f6b291e505dd7d1caf3bc8195">xfinal_callback_wrapper</a>(<a class="code" href="structsqlite3__context.html">sqlite3_context</a> * ctx)
<a name="l00937"></a>00937 {
<a name="l00938"></a>00938   <a class="code" href="libluasqlite3_8c.html#a031639f36aa7820038b9eeda2bf15c41">func_callback_wrapper</a>(2, ctx, 0, 0);
<a name="l00939"></a>00939 }
<a name="l00940"></a>00940 
<a name="l00941"></a><a class="code" href="libluasqlite3_8c.html#ac3ccd4317ab7cfb5f6c2de111ef7e4eb">00941</a> <a class="code" href="libluasqlite3_8c.html#a4cb9e74c8e392bdf896eeca0586218cf">FUNC</a>( l_sqlite3_create_function )
<a name="l00942"></a>00942 {
<a name="l00943"></a>00943   <a class="code" href="structDB.html">DB</a> * <a class="code" href="shell_8c.html#ad6e663497d2c934364b3bcf07496b30b">db</a>   = <a class="code" href="libluasqlite3_8c.html#ab0c20935a6010dcdbc203bd42e035c6f">checkdb</a>(L, 1);
<a name="l00944"></a>00944   <a class="code" href="structCB__Data.html">CB_Data</a> * cb_data = <a class="code" href="libluasqlite3_8c.html#ad71654e9bcdbb86f4d9a7b015edd8a16">get_function_cb_data</a>(L, db, 2);
<a name="l00945"></a>00945   
<a name="l00946"></a>00946   void (*xfunc)(<a class="code" href="structsqlite3__context.html">sqlite3_context</a> *, int, <a class="code" href="structMem.html">sqlite3_value</a> **) = 0;
<a name="l00947"></a>00947   void (*xstep)(<a class="code" href="structsqlite3__context.html">sqlite3_context</a> *, int, <a class="code" href="structMem.html">sqlite3_value</a> **) = 0;
<a name="l00948"></a>00948   void (*xfinal)(<a class="code" href="structsqlite3__context.html">sqlite3_context</a> *) = 0;
<a name="l00949"></a>00949   
<a name="l00950"></a>00950   <span class="keywordflow">if</span> ( <a class="code" href="libluasqlite3_8c.html#a7bb1bafa6db5663c092b378528d8f260">checknilornoneorfunc</a>(L, 4) )
<a name="l00951"></a>00951     xfunc = <a class="code" href="libluasqlite3_8c.html#ae202359d9977db3a419cec87bb2db964">xfunc_callback_wrapper</a>;
<a name="l00952"></a>00952   <span class="keywordflow">else</span>
<a name="l00953"></a>00953     xfunc = 0;
<a name="l00954"></a>00954   
<a name="l00955"></a>00955   <span class="keywordflow">if</span> ( <a class="code" href="libluasqlite3_8c.html#a7bb1bafa6db5663c092b378528d8f260">checknilornoneorfunc</a>(L, 5) )
<a name="l00956"></a>00956     xstep = <a class="code" href="libluasqlite3_8c.html#ac97a3bda60a3c0c02a559ef8befd616d">xstep_callback_wrapper</a>;
<a name="l00957"></a>00957   <span class="keywordflow">else</span>
<a name="l00958"></a>00958     xstep = 0;
<a name="l00959"></a>00959   
<a name="l00960"></a>00960   <span class="keywordflow">if</span> ( <a class="code" href="libluasqlite3_8c.html#a7bb1bafa6db5663c092b378528d8f260">checknilornoneorfunc</a>(L, 6) )
<a name="l00961"></a>00961     xfinal = <a class="code" href="libluasqlite3_8c.html#aaaf16e2f6b291e505dd7d1caf3bc8195">xfinal_callback_wrapper</a>;
<a name="l00962"></a>00962   <span class="keywordflow">else</span>
<a name="l00963"></a>00963     xfinal = 0;
<a name="l00964"></a>00964   
<a name="l00965"></a>00965   <a class="code" href="libluasqlite3_8c.html#aa7fe5f5eef5402785f2eecea3ebd1ecb">register_callback</a>(L, db, <a class="code" href="libluasqlite3_8c.html#ab62094220b8c227ba9a5cc69b2341895">KEY_XFUNC</a>(cb_data), 4);
<a name="l00966"></a>00966   <a class="code" href="libluasqlite3_8c.html#aa7fe5f5eef5402785f2eecea3ebd1ecb">register_callback</a>(L, db, <a class="code" href="libluasqlite3_8c.html#a4f86cddea86ddecbd10d2057be9521c7">KEY_XSTEP</a>(cb_data), 5);
<a name="l00967"></a>00967   <a class="code" href="libluasqlite3_8c.html#aa7fe5f5eef5402785f2eecea3ebd1ecb">register_callback</a>(L, db, <a class="code" href="libluasqlite3_8c.html#a0a12b91afdb49303409fb925ba8f0de2">KEY_XFINAL</a>(cb_data), 6);
<a name="l00968"></a>00968   
<a name="l00969"></a>00969   <a class="code" href="lapi_8c.html#a328625a03fbb5548f27b1af10f109f6a">lua_pushnumber</a>(L,
<a name="l00970"></a>00970     <a class="code" href="main_8c.html#a41b5bf5dea935444f161b3e51b761b86">sqlite3_create_function</a> (
<a name="l00971"></a>00971       db-&gt;<a class="code" href="structDB.html#a6a6b21b3e3cea8111eb8010475b6603c">kr_db</a>,
<a name="l00972"></a>00972       <a class="code" href="libluasqlite3_8c.html#ab6b4e8ab6d4565c7048dd4afabd79b19">checkstr</a>(L, 2),
<a name="l00973"></a>00973       <a class="code" href="libluasqlite3_8c.html#a35c42e01e373065d3a0afe7367d364c1">checkint</a>(L, 3),
<a name="l00974"></a>00974       <a class="code" href="sqlite3_8h.html#a7a65f15cad0da22be8ebc0c70f526d32">SQLITE_UTF8</a>,
<a name="l00975"></a>00975       cb_data,
<a name="l00976"></a>00976       xfunc,
<a name="l00977"></a>00977       xstep,
<a name="l00978"></a>00978       xfinal ));
<a name="l00979"></a>00979   
<a name="l00980"></a>00980   <span class="keywordflow">return</span> 1;
<a name="l00981"></a>00981 }
<a name="l00982"></a>00982 
<a name="l00983"></a>00983 
<a name="l00984"></a><a class="code" href="libluasqlite3_8c.html#a2ab9703ec2b9e895196304f2a4450f6c">00984</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="libluasqlite3_8c.html#a2ab9703ec2b9e895196304f2a4450f6c">xcompare_callback_wrapper</a>(<span class="keywordtype">void</span> * cb_data, <span class="keywordtype">int</span> len_a, <span class="keyword">const</span> <span class="keywordtype">void</span> * str_a, <span class="keywordtype">int</span> len_b, <span class="keyword">const</span> <span class="keywordtype">void</span> * str_b)
<a name="l00985"></a>00985 {
<a name="l00986"></a>00986   <a class="code" href="structDB.html">DB</a> *    <a class="code" href="shell_8c.html#ad6e663497d2c934364b3bcf07496b30b">db</a> = <a class="code" href="libluasqlite3_8c.html#a11b53e19fa1be7f2b3fe2c460a53ff44">CB_DATA</a>(cb_data)-&gt;db;
<a name="l00987"></a>00987   <a class="code" href="structlua__State.html">lua_State</a> * L  = db-&gt;<a class="code" href="structDB.html#a2e9a0a1c036dd716f5091edff395de52">L</a>;
<a name="l00988"></a>00988   <span class="keywordtype">int</span> result;
<a name="l00989"></a>00989   
<a name="l00990"></a>00990   <a class="code" href="libluasqlite3_8c.html#a7fdf29de7ea3da9d847f28fe34f8ae15">push_callback</a>(L, db, <a class="code" href="libluasqlite3_8c.html#ac9c4ba5877b77ec72e69586a2348d0a9">KEY_XCOMPARE</a>(cb_data));
<a name="l00991"></a>00991   <a class="code" href="lapi_8c.html#ad457b6dc1bc1b6d5cf9b625c5b329e5e">lua_pushlstring</a>(L, str_a, len_a);
<a name="l00992"></a>00992   <a class="code" href="lapi_8c.html#ad457b6dc1bc1b6d5cf9b625c5b329e5e">lua_pushlstring</a>(L, str_b, len_b);
<a name="l00993"></a>00993   
<a name="l00994"></a>00994   <span class="keywordflow">if</span> ( <a class="code" href="lapi_8c.html#a2a6cbad7f1c567378d17ded68b47f8f3">lua_pcall</a>(L, 2, 1, 0) )
<a name="l00995"></a>00995     result = 0;     <span class="comment">/* No way to signal errors to sqlite */</span>
<a name="l00996"></a>00996   <span class="keywordflow">else</span>
<a name="l00997"></a>00997     result = (int) <a class="code" href="lapi_8c.html#a42c1f68101dc98a6ae4695c8577b17f8">lua_tonumber</a>(L, -1);
<a name="l00998"></a>00998   
<a name="l00999"></a>00999   <a class="code" href="lua_8h.html#abb8eae2164badeafdb037bc1e03cc822">lua_pop</a>(L, 1);
<a name="l01000"></a>01000   <span class="keywordflow">return</span> result;
<a name="l01001"></a>01001 }
<a name="l01002"></a>01002 
<a name="l01003"></a><a class="code" href="libluasqlite3_8c.html#a6b35d9bdcbb90628db92ce40a8e4ccf2">01003</a> <a class="code" href="libluasqlite3_8c.html#a4cb9e74c8e392bdf896eeca0586218cf">FUNC</a>( l_sqlite3_create_collation )
<a name="l01004"></a>01004 {
<a name="l01005"></a>01005   <a class="code" href="structDB.html">DB</a> * <a class="code" href="shell_8c.html#ad6e663497d2c934364b3bcf07496b30b">db</a>   = <a class="code" href="libluasqlite3_8c.html#ab0c20935a6010dcdbc203bd42e035c6f">checkdb</a>(L, 1);
<a name="l01006"></a>01006   <a class="code" href="structCB__Data.html">CB_Data</a> * cb_data = <a class="code" href="libluasqlite3_8c.html#ab1f36f2808caf9ffd385c573ca394a01">get_collation_cb_data</a>(L, db, 2);
<a name="l01007"></a>01007   
<a name="l01008"></a>01008   int (*xcompare)(<span class="keywordtype">void</span> *, int, <span class="keyword">const</span> <span class="keywordtype">void</span> *, int, <span class="keyword">const</span> <span class="keywordtype">void</span> *);
<a name="l01009"></a>01009   
<a name="l01010"></a>01010   <span class="keywordflow">if</span> ( <a class="code" href="libluasqlite3_8c.html#a7bb1bafa6db5663c092b378528d8f260">checknilornoneorfunc</a>(L, 3) )
<a name="l01011"></a>01011     xcompare = <a class="code" href="libluasqlite3_8c.html#a2ab9703ec2b9e895196304f2a4450f6c">xcompare_callback_wrapper</a>;
<a name="l01012"></a>01012   <span class="keywordflow">else</span>
<a name="l01013"></a>01013     xcompare = 0;
<a name="l01014"></a>01014   
<a name="l01015"></a>01015   <a class="code" href="libluasqlite3_8c.html#aa7fe5f5eef5402785f2eecea3ebd1ecb">register_callback</a>(L, db, <a class="code" href="libluasqlite3_8c.html#ac9c4ba5877b77ec72e69586a2348d0a9">KEY_XCOMPARE</a>(cb_data), 3);
<a name="l01016"></a>01016   
<a name="l01017"></a>01017   <a class="code" href="lapi_8c.html#a328625a03fbb5548f27b1af10f109f6a">lua_pushnumber</a>(L, <a class="code" href="main_8c.html#ad33fd4664f24cf7f5ab6cfa5238eca1a">sqlite3_create_collation</a>(
<a name="l01018"></a>01018                 db-&gt;<a class="code" href="structDB.html#a6a6b21b3e3cea8111eb8010475b6603c">kr_db</a>, <a class="code" href="libluasqlite3_8c.html#ab6b4e8ab6d4565c7048dd4afabd79b19">checkstr</a>(L, 2), <a class="code" href="sqlite3_8h.html#a7a65f15cad0da22be8ebc0c70f526d32">SQLITE_UTF8</a>, cb_data, xcompare) );
<a name="l01019"></a>01019   <span class="keywordflow">return</span> 1;
<a name="l01020"></a>01020 }
<a name="l01021"></a>01021 
<a name="l01022"></a>01022 
<a name="l01023"></a><a class="code" href="libluasqlite3_8c.html#a6f5654a23b4938919ca2b66a4bc85c1d">01023</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="libluasqlite3_8c.html#a6f5654a23b4938919ca2b66a4bc85c1d">xneeded_callback_wrapper</a>(<span class="keywordtype">void</span> * cb_data, <a class="code" href="structsqlite3.html">sqlite3</a> * <a class="code" href="structsqlite3.html">sqlite3</a>, <span class="keywordtype">int</span> eTextRep, <span class="keyword">const</span> <span class="keywordtype">char</span> * collation_name)
<a name="l01024"></a>01024 {
<a name="l01025"></a>01025   <a class="code" href="structDB.html">DB</a> *    <a class="code" href="shell_8c.html#ad6e663497d2c934364b3bcf07496b30b">db</a> = <a class="code" href="libluasqlite3_8c.html#a11b53e19fa1be7f2b3fe2c460a53ff44">CB_DATA</a>(cb_data)-&gt;db;
<a name="l01026"></a>01026   <a class="code" href="structlua__State.html">lua_State</a> *   L  = db-&gt;<a class="code" href="structDB.html#a2e9a0a1c036dd716f5091edff395de52">L</a>;
<a name="l01027"></a>01027 
<a name="l01028"></a>01028   (void)sqlite3;
<a name="l01029"></a>01029   (void)eTextRep;
<a name="l01030"></a>01030   
<a name="l01031"></a>01031   <a class="code" href="libluasqlite3_8c.html#a7fdf29de7ea3da9d847f28fe34f8ae15">push_callback</a>(L, db, <a class="code" href="libluasqlite3_8c.html#a1be0c7df756fffc3bddcd5523e63e789">KEY_XNEEDED</a>(cb_data));
<a name="l01032"></a>01032   <a class="code" href="lapi_8c.html#a1281a7e2b52370cc416123bfd32b1b29">lua_pushstring</a>(L, collation_name);
<a name="l01033"></a>01033   
<a name="l01034"></a>01034   <span class="keywordflow">if</span> (<a class="code" href="lapi_8c.html#a2a6cbad7f1c567378d17ded68b47f8f3">lua_pcall</a>(L, 1, 0, 0))
<a name="l01035"></a>01035     <a class="code" href="lua_8h.html#abb8eae2164badeafdb037bc1e03cc822">lua_pop</a>(L, 1);
<a name="l01036"></a>01036 }
<a name="l01037"></a>01037 
<a name="l01038"></a><a class="code" href="libluasqlite3_8c.html#a9190f402c4eba7b38a3ebfaa976064af">01038</a> <a class="code" href="libluasqlite3_8c.html#a4cb9e74c8e392bdf896eeca0586218cf">FUNC</a>( l_sqlite3_collation_needed )
<a name="l01039"></a>01039 {
<a name="l01040"></a>01040   <a class="code" href="structDB.html">DB</a> * <a class="code" href="shell_8c.html#ad6e663497d2c934364b3bcf07496b30b">db</a>   = <a class="code" href="libluasqlite3_8c.html#ab0c20935a6010dcdbc203bd42e035c6f">checkdb</a>(L, 1);
<a name="l01041"></a>01041   <a class="code" href="structCB__Data.html">CB_Data</a> * cb_data = <a class="code" href="libluasqlite3_8c.html#a8383a485f75d6697f0629316ffa2456f">get_collneeded_cb_data</a>(L, db);
<a name="l01042"></a>01042   
<a name="l01043"></a>01043   void (*xneeded)(<span class="keywordtype">void</span> *, <a class="code" href="structsqlite3.html">sqlite3</a> *, <span class="keywordtype">int</span> eTextRep, <span class="keyword">const</span> <span class="keywordtype">char</span> *);
<a name="l01044"></a>01044   
<a name="l01045"></a>01045   <span class="keywordflow">if</span> ( <a class="code" href="libluasqlite3_8c.html#a7bb1bafa6db5663c092b378528d8f260">checknilornoneorfunc</a>(L, 2) )
<a name="l01046"></a>01046     xneeded = <a class="code" href="libluasqlite3_8c.html#a6f5654a23b4938919ca2b66a4bc85c1d">xneeded_callback_wrapper</a>;
<a name="l01047"></a>01047   <span class="keywordflow">else</span>
<a name="l01048"></a>01048     xneeded = 0;
<a name="l01049"></a>01049   
<a name="l01050"></a>01050   <a class="code" href="libluasqlite3_8c.html#aa7fe5f5eef5402785f2eecea3ebd1ecb">register_callback</a>(L, db, <a class="code" href="libluasqlite3_8c.html#a1be0c7df756fffc3bddcd5523e63e789">KEY_XNEEDED</a>(cb_data), 2);
<a name="l01051"></a>01051   
<a name="l01052"></a>01052   <a class="code" href="lapi_8c.html#a328625a03fbb5548f27b1af10f109f6a">lua_pushnumber</a>(L, <a class="code" href="main_8c.html#aa86e42aa83812d262cf0bdfaabe7db19">sqlite3_collation_needed</a>(db-&gt;<a class="code" href="structDB.html#a6a6b21b3e3cea8111eb8010475b6603c">kr_db</a>, cb_data, xneeded) );
<a name="l01053"></a>01053   <span class="keywordflow">return</span> 1;
<a name="l01054"></a>01054 }
<a name="l01055"></a>01055 
<a name="l01056"></a>01056 
<a name="l01057"></a>01057 
<a name="l01058"></a>01058 
<a name="l01059"></a><a class="code" href="libluasqlite3_8c.html#af4aad0042a26b5185c99ca29f65e2d6a">01059</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="libluasqlite3_8c.html#af4aad0042a26b5185c99ca29f65e2d6a">xtrace_callback_wrapper</a>(<span class="keywordtype">void</span> * cb_data, <span class="keyword">const</span> <span class="keywordtype">char</span> * str)
<a name="l01060"></a>01060 {
<a name="l01061"></a>01061   <a class="code" href="structDB.html">DB</a> *    <a class="code" href="shell_8c.html#ad6e663497d2c934364b3bcf07496b30b">db</a> = <a class="code" href="libluasqlite3_8c.html#a11b53e19fa1be7f2b3fe2c460a53ff44">CB_DATA</a>(cb_data)-&gt;db;
<a name="l01062"></a>01062   <a class="code" href="structlua__State.html">lua_State</a> * L  = db-&gt;<a class="code" href="structDB.html#a2e9a0a1c036dd716f5091edff395de52">L</a>;
<a name="l01063"></a>01063   
<a name="l01064"></a>01064   <a class="code" href="libluasqlite3_8c.html#a7fdf29de7ea3da9d847f28fe34f8ae15">push_callback</a>(L, db, <a class="code" href="libluasqlite3_8c.html#a4731b1ae7d1195180f1ca5a04d687976">KEY_XTRACE</a>(cb_data));
<a name="l01065"></a>01065   <a class="code" href="lapi_8c.html#a1281a7e2b52370cc416123bfd32b1b29">lua_pushstring</a>(L, str);
<a name="l01066"></a>01066   
<a name="l01067"></a>01067   <span class="keywordflow">if</span> ( <a class="code" href="lapi_8c.html#a2a6cbad7f1c567378d17ded68b47f8f3">lua_pcall</a>(L, 1, 0, 0) )
<a name="l01068"></a>01068     <a class="code" href="lua_8h.html#abb8eae2164badeafdb037bc1e03cc822">lua_pop</a>(L, 1);    <span class="comment">/* pop error message and delete it (errors are ignored) */</span>
<a name="l01069"></a>01069 }
<a name="l01070"></a>01070 
<a name="l01071"></a><a class="code" href="libluasqlite3_8c.html#ad0bc270401891010f4d374bdef76710f">01071</a> <a class="code" href="libluasqlite3_8c.html#a4cb9e74c8e392bdf896eeca0586218cf">FUNC</a>( l_sqlite3_trace )
<a name="l01072"></a>01072 {
<a name="l01073"></a>01073   <a class="code" href="structDB.html">DB</a> * <a class="code" href="shell_8c.html#ad6e663497d2c934364b3bcf07496b30b">db</a>   = <a class="code" href="libluasqlite3_8c.html#ab0c20935a6010dcdbc203bd42e035c6f">checkdb</a>(L, 1);
<a name="l01074"></a>01074   <a class="code" href="structCB__Data.html">CB_Data</a> * cb_data = <a class="code" href="libluasqlite3_8c.html#a332aa6ab34079e92d7ea5d136169559c">get_trace_cb_data</a>(L, db);
<a name="l01075"></a>01075   
<a name="l01076"></a>01076   void (*xtrace)(<span class="keywordtype">void</span> *, <span class="keyword">const</span> <span class="keywordtype">char</span> *);
<a name="l01077"></a>01077   
<a name="l01078"></a>01078   <span class="keywordflow">if</span> ( <a class="code" href="libluasqlite3_8c.html#a7bb1bafa6db5663c092b378528d8f260">checknilornoneorfunc</a>(L, 2) )
<a name="l01079"></a>01079     xtrace = <a class="code" href="libluasqlite3_8c.html#af4aad0042a26b5185c99ca29f65e2d6a">xtrace_callback_wrapper</a>;
<a name="l01080"></a>01080   <span class="keywordflow">else</span>
<a name="l01081"></a>01081     xtrace = 0;
<a name="l01082"></a>01082   
<a name="l01083"></a>01083   <a class="code" href="libluasqlite3_8c.html#aa7fe5f5eef5402785f2eecea3ebd1ecb">register_callback</a>(L, db, <a class="code" href="libluasqlite3_8c.html#a4731b1ae7d1195180f1ca5a04d687976">KEY_XTRACE</a>(cb_data), 2);
<a name="l01084"></a>01084   
<a name="l01085"></a>01085   <a class="code" href="main_8c.html#aa2303296f1355f956c4f095e36b292a6">sqlite3_trace</a>(db-&gt;<a class="code" href="structDB.html#a6a6b21b3e3cea8111eb8010475b6603c">kr_db</a>, xtrace, cb_data);
<a name="l01086"></a>01086   
<a name="l01087"></a>01087   <a class="code" href="lapi_8c.html#a328625a03fbb5548f27b1af10f109f6a">lua_pushnumber</a>(L, <a class="code" href="sqlite3_8h.html#a650d09c7bec7ddadb7c8aa3519dc842c">SQLITE_OK</a>);
<a name="l01088"></a>01088   <span class="keywordflow">return</span> 1;
<a name="l01089"></a>01089 }
<a name="l01090"></a>01090 
<a name="l01091"></a>01091 
<a name="l01092"></a>01092 
<a name="l01093"></a>01093 
<a name="l01094"></a><a class="code" href="libluasqlite3_8c.html#a5f8ccf90d022464d1df6593cc3f0939f">01094</a> <a class="code" href="libluasqlite3_8c.html#a4cb9e74c8e392bdf896eeca0586218cf">FUNC</a>( l_sqlite3_result_null )
<a name="l01095"></a>01095 {
<a name="l01096"></a>01096   <a class="code" href="sqlite3_8h.html#aae1ddb43f87c897288e26fd7d890c6bd">sqlite3_result_null</a>(<a class="code" href="libluasqlite3_8c.html#aee22b28f72d72e04595d1411ad9d94d3">checkcontext</a>(L, 1));
<a name="l01097"></a>01097   <span class="keywordflow">return</span> 0;
<a name="l01098"></a>01098 }
<a name="l01099"></a>01099 
<a name="l01100"></a>01100 
<a name="l01101"></a><a class="code" href="libluasqlite3_8c.html#a03104d7d2983be32dd3d427ebaeed431">01101</a> <a class="code" href="libluasqlite3_8c.html#a4cb9e74c8e392bdf896eeca0586218cf">FUNC</a>( l_sqlite3_result_error )
<a name="l01102"></a>01102 {
<a name="l01103"></a>01103   <a class="code" href="sqlite3_8h.html#a02826d87e45fd4f04445a3c99a14b54e">sqlite3_result_error</a>(<a class="code" href="libluasqlite3_8c.html#aee22b28f72d72e04595d1411ad9d94d3">checkcontext</a>(L, 1), <a class="code" href="libluasqlite3_8c.html#ab6b4e8ab6d4565c7048dd4afabd79b19">checkstr</a>(L, 2), <a class="code" href="lua_8h.html#af1950fb3c542d036245559b5f5ae9346">lua_strlen</a>(L, 2));
<a name="l01104"></a>01104   <span class="keywordflow">return</span> 0;
<a name="l01105"></a>01105 }
<a name="l01106"></a>01106 
<a name="l01107"></a>01107 
<a name="l01108"></a><a class="code" href="libluasqlite3_8c.html#a15dab03d681108f94ab0dbafca9a7bb7">01108</a> <a class="code" href="libluasqlite3_8c.html#a4cb9e74c8e392bdf896eeca0586218cf">FUNC</a>( l_sqlite3_result_double )
<a name="l01109"></a>01109 {
<a name="l01110"></a>01110   <a class="code" href="sqlite3_8h.html#a75eacc6277e6988383e58509d4e59a16">sqlite3_result_double</a>(<a class="code" href="libluasqlite3_8c.html#aee22b28f72d72e04595d1411ad9d94d3">checkcontext</a>(L, 1), <a class="code" href="libluasqlite3_8c.html#a4c0d7e34c09fa9c5bf99eb953df4a953">checkdouble</a>(L, 2));
<a name="l01111"></a>01111   <span class="keywordflow">return</span> 0;
<a name="l01112"></a>01112 }
<a name="l01113"></a>01113 
<a name="l01114"></a>01114 
<a name="l01115"></a><a class="code" href="libluasqlite3_8c.html#ab6564d402786af96e456a6687451da2e">01115</a> <a class="code" href="libluasqlite3_8c.html#a4cb9e74c8e392bdf896eeca0586218cf">FUNC</a>( l_sqlite3_result_int )
<a name="l01116"></a>01116 {
<a name="l01117"></a>01117   <a class="code" href="sqlite3_8h.html#a127222e07afca28c77e0b8bab06c155d">sqlite3_result_int</a>(<a class="code" href="libluasqlite3_8c.html#aee22b28f72d72e04595d1411ad9d94d3">checkcontext</a>(L, 1), <a class="code" href="libluasqlite3_8c.html#a35c42e01e373065d3a0afe7367d364c1">checkint</a>(L, 2));
<a name="l01118"></a>01118   <span class="keywordflow">return</span> 0;
<a name="l01119"></a>01119 }
<a name="l01120"></a>01120 
<a name="l01121"></a>01121 
<a name="l01122"></a><a class="code" href="libluasqlite3_8c.html#a6e642bd545276faa9dc6fe3b22ece037">01122</a> <a class="code" href="libluasqlite3_8c.html#a4cb9e74c8e392bdf896eeca0586218cf">FUNC</a>( l_sqlite3_result_number )
<a name="l01123"></a>01123 {
<a name="l01124"></a>01124   <a class="code" href="lua_8h.html#af0a6ed3b852d680769cfc410a0672172">lua_Number</a> number = <a class="code" href="libluasqlite3_8c.html#ae422beb510500a68a8dc8813893d5798">checknumber</a>(L, 2);
<a name="l01125"></a>01125   
<a name="l01126"></a>01126   <span class="keywordflow">if</span> (<a class="code" href="libluasqlite3_8c.html#a9a7aaff48d1e77a5fcf16b0d6afc1bb8">IS_INT</a>(number))
<a name="l01127"></a>01127     <a class="code" href="sqlite3_8h.html#a127222e07afca28c77e0b8bab06c155d">sqlite3_result_int</a>(<a class="code" href="libluasqlite3_8c.html#aee22b28f72d72e04595d1411ad9d94d3">checkcontext</a>(L, 1), (<span class="keywordtype">int</span>)number);
<a name="l01128"></a>01128   <span class="keywordflow">else</span>
<a name="l01129"></a>01129     <a class="code" href="sqlite3_8h.html#a75eacc6277e6988383e58509d4e59a16">sqlite3_result_double</a>(<a class="code" href="libluasqlite3_8c.html#aee22b28f72d72e04595d1411ad9d94d3">checkcontext</a>(L, 1), (<span class="keywordtype">double</span>)number);
<a name="l01130"></a>01130   
<a name="l01131"></a>01131   <span class="keywordflow">return</span> 0;
<a name="l01132"></a>01132 }
<a name="l01133"></a>01133 
<a name="l01134"></a>01134 
<a name="l01135"></a><a class="code" href="libluasqlite3_8c.html#a391b9499329f464a09e130f4d1a3489d">01135</a> <a class="code" href="libluasqlite3_8c.html#a4cb9e74c8e392bdf896eeca0586218cf">FUNC</a>( l_sqlite3_result_blob )
<a name="l01136"></a>01136 {
<a name="l01137"></a>01137   <a class="code" href="sqlite3_8h.html#a7dabc96652dbaf414a4dc55176a11158">sqlite3_result_blob</a>(<a class="code" href="libluasqlite3_8c.html#aee22b28f72d72e04595d1411ad9d94d3">checkcontext</a>(L, 1), <a class="code" href="libluasqlite3_8c.html#ab6b4e8ab6d4565c7048dd4afabd79b19">checkstr</a>(L, 2), <a class="code" href="lua_8h.html#af1950fb3c542d036245559b5f5ae9346">lua_strlen</a>(L, 2), <a class="code" href="sqlite3_8h.html#adec3d88e3dff21d4c566daccbede9b3b">SQLITE_TRANSIENT</a>);
<a name="l01138"></a>01138   <span class="keywordflow">return</span> 0;
<a name="l01139"></a>01139 }
<a name="l01140"></a>01140 
<a name="l01141"></a>01141 
<a name="l01142"></a><a class="code" href="libluasqlite3_8c.html#a259108c2f6003d1f6caa3e4654e765cb">01142</a> <a class="code" href="libluasqlite3_8c.html#a4cb9e74c8e392bdf896eeca0586218cf">FUNC</a>( l_sqlite3_result_text )
<a name="l01143"></a>01143 {
<a name="l01144"></a>01144   <a class="code" href="sqlite3_8h.html#a2dfd2d971e743b8d5a24725606a733ac">sqlite3_result_text</a>(<a class="code" href="libluasqlite3_8c.html#aee22b28f72d72e04595d1411ad9d94d3">checkcontext</a>(L, 1), <a class="code" href="libluasqlite3_8c.html#ab6b4e8ab6d4565c7048dd4afabd79b19">checkstr</a>(L, 2), <a class="code" href="lua_8h.html#af1950fb3c542d036245559b5f5ae9346">lua_strlen</a>(L, 2), <a class="code" href="sqlite3_8h.html#adec3d88e3dff21d4c566daccbede9b3b">SQLITE_TRANSIENT</a>);
<a name="l01145"></a>01145   <span class="keywordflow">return</span> 0;
<a name="l01146"></a>01146 }
<a name="l01147"></a>01147 
<a name="l01148"></a>01148 
<a name="l01149"></a><a class="code" href="libluasqlite3_8c.html#a73a6d267854206c898e77f921a044942">01149</a> <a class="code" href="libluasqlite3_8c.html#a4cb9e74c8e392bdf896eeca0586218cf">FUNC</a>( l_sqlite3_result_value )
<a name="l01150"></a>01150 {
<a name="l01151"></a>01151   <a class="code" href="structMem.html">sqlite3_value</a> ** values = <a class="code" href="libluasqlite3_8c.html#a4680b8f082d847c367e9263cace94f23">checkvalues</a>(L, 2);
<a name="l01152"></a>01152   <span class="keywordtype">int</span> index = <a class="code" href="libluasqlite3_8c.html#a35c42e01e373065d3a0afe7367d364c1">checkint</a>(L, 3);
<a name="l01153"></a>01153   <a class="code" href="sqlite3_8h.html#a7cd28ba7a4256aec12262ed3d75bb39a">sqlite3_result_value</a>(<a class="code" href="libluasqlite3_8c.html#aee22b28f72d72e04595d1411ad9d94d3">checkcontext</a>(L, 1), values[index] );
<a name="l01154"></a>01154   <span class="keywordflow">return</span> 0;
<a name="l01155"></a>01155 }
<a name="l01156"></a>01156 
<a name="l01157"></a><a class="code" href="libluasqlite3_8c.html#a100273dfd022aaf9e3de1f174d00ef01">01157</a> <a class="code" href="libluasqlite3_8c.html#a4cb9e74c8e392bdf896eeca0586218cf">FUNC</a>( l_sqlite3_result )
<a name="l01158"></a>01158 {
<a name="l01159"></a>01159   <a class="code" href="structsqlite3__context.html">sqlite3_context</a> * context = <a class="code" href="libluasqlite3_8c.html#aee22b28f72d72e04595d1411ad9d94d3">checkcontext</a>(L, 1);
<a name="l01160"></a>01160   
<a name="l01161"></a>01161   <span class="keywordflow">switch</span>(<a class="code" href="lapi_8c.html#a652b273947f0656686f998d8e90cd3ea">lua_type</a>(L, 2))
<a name="l01162"></a>01162   {
<a name="l01163"></a>01163     <span class="keywordflow">case</span> <a class="code" href="lua_8h.html#a39c27eef097c704eee3536906dea5380">LUA_TNONE</a>:
<a name="l01164"></a>01164     <span class="keywordflow">case</span> <a class="code" href="lua_8h.html#ae38a6fb8c687b8bfab211b7675a695ef">LUA_TNIL</a>:
<a name="l01165"></a>01165       <a class="code" href="sqlite3_8h.html#aae1ddb43f87c897288e26fd7d890c6bd">sqlite3_result_null</a>(context);
<a name="l01166"></a>01166       <span class="keywordflow">break</span>;
<a name="l01167"></a>01167     
<a name="l01168"></a>01168     <span class="keywordflow">case</span> <a class="code" href="lua_8h.html#a7f62ecb240cb38da9c8a53b41fe21ed9">LUA_TNUMBER</a>:
<a name="l01169"></a>01169       {
<a name="l01170"></a>01170         <a class="code" href="lua_8h.html#af0a6ed3b852d680769cfc410a0672172">lua_Number</a> number = <a class="code" href="lapi_8c.html#a42c1f68101dc98a6ae4695c8577b17f8">lua_tonumber</a>(L, 2);
<a name="l01171"></a>01171         
<a name="l01172"></a>01172         <span class="keywordflow">if</span> (<a class="code" href="libluasqlite3_8c.html#a9a7aaff48d1e77a5fcf16b0d6afc1bb8">IS_INT</a>(number))
<a name="l01173"></a>01173           <a class="code" href="sqlite3_8h.html#a127222e07afca28c77e0b8bab06c155d">sqlite3_result_int</a>(context, (<span class="keywordtype">int</span>)number);
<a name="l01174"></a>01174         <span class="keywordflow">else</span>
<a name="l01175"></a>01175           <a class="code" href="sqlite3_8h.html#a75eacc6277e6988383e58509d4e59a16">sqlite3_result_double</a>(context, (<span class="keywordtype">double</span>)number);
<a name="l01176"></a>01176       }
<a name="l01177"></a>01177       <span class="keywordflow">break</span>;
<a name="l01178"></a>01178     
<a name="l01179"></a>01179     <span class="keywordflow">case</span> <a class="code" href="lua_8h.html#a611808ed12d4c2aee2a9e298a9d9a9bf">LUA_TBOOLEAN</a>:
<a name="l01180"></a>01180       <span class="keywordflow">if</span> (<a class="code" href="lapi_8c.html#a444aee9aa56b0b06175ee3c7bcf7927c">lua_toboolean</a>(L, 2))
<a name="l01181"></a>01181         <a class="code" href="sqlite3_8h.html#a127222e07afca28c77e0b8bab06c155d">sqlite3_result_int</a>(context, 1);
<a name="l01182"></a>01182       <span class="keywordflow">else</span>
<a name="l01183"></a>01183         <a class="code" href="sqlite3_8h.html#a127222e07afca28c77e0b8bab06c155d">sqlite3_result_int</a>(context, 0);
<a name="l01184"></a>01184       <span class="keywordflow">break</span>;
<a name="l01185"></a>01185     
<a name="l01186"></a>01186     <span class="keywordflow">case</span> <a class="code" href="lua_8h.html#a57de20d87bb5131a3159f2bd52e3fab6">LUA_TSTRING</a>:
<a name="l01187"></a>01187       <a class="code" href="sqlite3_8h.html#a2dfd2d971e743b8d5a24725606a733ac">sqlite3_result_text</a>(context, <a class="code" href="lua_8h.html#ac813fc3bc1886ba17c363d5b4c6e7ef1">lua_tostring</a>(L, 2), <a class="code" href="lua_8h.html#af1950fb3c542d036245559b5f5ae9346">lua_strlen</a>(L, 2), <a class="code" href="sqlite3_8h.html#adec3d88e3dff21d4c566daccbede9b3b">SQLITE_TRANSIENT</a>);
<a name="l01188"></a>01188       <span class="keywordflow">break</span>;
<a name="l01189"></a>01189     
<a name="l01190"></a>01190     <span class="keywordflow">default</span>:
<a name="l01191"></a>01191       <a class="code" href="libluasqlite3_8c.html#a651d62983f0f11075ab3608c220fc397">report_error</a>(L, <span class="stringliteral">&quot;libluasqlite3: Api usage error: Invalid argument to l_sqlite3_result:&quot;</span>);
<a name="l01192"></a>01192   }
<a name="l01193"></a>01193   
<a name="l01194"></a>01194   <span class="keywordflow">return</span> 0;
<a name="l01195"></a>01195 }
<a name="l01196"></a>01196 
<a name="l01197"></a>01197 
<a name="l01198"></a><a class="code" href="libluasqlite3_8c.html#a7e330cb036e5d99c43b727fd3d46d3dd">01198</a> <a class="code" href="libluasqlite3_8c.html#a4cb9e74c8e392bdf896eeca0586218cf">FUNC</a>( l_sqlite3_aggregate_count )
<a name="l01199"></a>01199 {
<a name="l01200"></a>01200   <a class="code" href="lapi_8c.html#a328625a03fbb5548f27b1af10f109f6a">lua_pushnumber</a>(L, <a class="code" href="sqlite3_8h.html#aedae00236c9ec0105f161bfc2ef548ed">sqlite3_aggregate_count</a>(<a class="code" href="libluasqlite3_8c.html#aee22b28f72d72e04595d1411ad9d94d3">checkcontext</a>(L, 1)) );
<a name="l01201"></a>01201   <span class="keywordflow">return</span> 1;
<a name="l01202"></a>01202 }
<a name="l01203"></a>01203 
<a name="l01204"></a>01204 
<a name="l01205"></a><a class="code" href="libluasqlite3_8c.html#a52831b89e208d4f601d6a9bccd028f6c">01205</a> <a class="code" href="libluasqlite3_8c.html#a4cb9e74c8e392bdf896eeca0586218cf">FUNC</a>( l_sqlite3_aggregate_context )
<a name="l01206"></a>01206 {
<a name="l01207"></a>01207   <a class="code" href="lapi_8c.html#a85e3e3d32b068aef62426828a104b561">lua_pushlightuserdata</a>(L, <a class="code" href="sqlite3_8h.html#aa98f50eacffd3613daa76cf59229b010">sqlite3_aggregate_context</a>(<a class="code" href="libluasqlite3_8c.html#aee22b28f72d72e04595d1411ad9d94d3">checkcontext</a>(L, 1), 1));
<a name="l01208"></a>01208   <span class="keywordflow">return</span> 1;
<a name="l01209"></a>01209 }
<a name="l01210"></a>01210 
<a name="l01211"></a>01211 
<a name="l01212"></a><a class="code" href="libluasqlite3_8c.html#ad52c0621b4f9059e300122c229f23024">01212</a> <a class="code" href="libluasqlite3_8c.html#a4cb9e74c8e392bdf896eeca0586218cf">FUNC</a>( l_sqlite3_value_int )
<a name="l01213"></a>01213 {
<a name="l01214"></a>01214   <a class="code" href="structMem.html">sqlite3_value</a> ** values = <a class="code" href="libluasqlite3_8c.html#a4680b8f082d847c367e9263cace94f23">checkvalues</a>(L, 1);
<a name="l01215"></a>01215   <span class="keywordtype">int</span> index = <a class="code" href="libluasqlite3_8c.html#a35c42e01e373065d3a0afe7367d364c1">checkint</a>(L, 2);
<a name="l01216"></a>01216   <a class="code" href="lapi_8c.html#a328625a03fbb5548f27b1af10f109f6a">lua_pushnumber</a>(L, <a class="code" href="sqlite3_8h.html#af85c1bccdd78d4eefdcdb0136aaf9149">sqlite3_value_int</a>(values[index]) );
<a name="l01217"></a>01217   <span class="keywordflow">return</span> 1;
<a name="l01218"></a>01218 }
<a name="l01219"></a>01219 
<a name="l01220"></a>01220 
<a name="l01221"></a><a class="code" href="libluasqlite3_8c.html#ae488f8ac24c8424086d68f55b5b5311a">01221</a> <a class="code" href="libluasqlite3_8c.html#a4cb9e74c8e392bdf896eeca0586218cf">FUNC</a>( l_sqlite3_value_double )
<a name="l01222"></a>01222 {
<a name="l01223"></a>01223   <a class="code" href="structMem.html">sqlite3_value</a> ** values = <a class="code" href="libluasqlite3_8c.html#a4680b8f082d847c367e9263cace94f23">checkvalues</a>(L, 1);
<a name="l01224"></a>01224   <span class="keywordtype">int</span> index = <a class="code" href="libluasqlite3_8c.html#a35c42e01e373065d3a0afe7367d364c1">checkint</a>(L, 2);
<a name="l01225"></a>01225   <a class="code" href="lapi_8c.html#a328625a03fbb5548f27b1af10f109f6a">lua_pushnumber</a>(L, <a class="code" href="sqlite3_8h.html#a0e5216b4627c5609b627c474617489bc">sqlite3_value_double</a>(values[index]) );
<a name="l01226"></a>01226   <span class="keywordflow">return</span> 1;
<a name="l01227"></a>01227 }
<a name="l01228"></a>01228 
<a name="l01229"></a>01229 
<a name="l01230"></a><a class="code" href="libluasqlite3_8c.html#a116db0cf046f2485f50fb6cf3aecb098">01230</a> <a class="code" href="libluasqlite3_8c.html#a4cb9e74c8e392bdf896eeca0586218cf">FUNC</a>( l_sqlite3_value_number )
<a name="l01231"></a>01231 {
<a name="l01232"></a>01232   <a class="code" href="structMem.html">sqlite3_value</a> ** values = <a class="code" href="libluasqlite3_8c.html#a4680b8f082d847c367e9263cace94f23">checkvalues</a>(L, 1);
<a name="l01233"></a>01233   <span class="keywordtype">int</span> index = <a class="code" href="libluasqlite3_8c.html#a35c42e01e373065d3a0afe7367d364c1">checkint</a>(L, 2);
<a name="l01234"></a>01234   <a class="code" href="structMem.html">sqlite3_value</a> * value = values[index];
<a name="l01235"></a>01235   <span class="keywordflow">if</span> (<a class="code" href="sqlite3_8h.html#aed137fb0d21554419bc7de5675057503">sqlite3_value_type</a>(value) == <a class="code" href="sqlite3_8h.html#a7453d71905f10fa330940428f8abe21c">SQLITE_INTEGER</a>)
<a name="l01236"></a>01236     <a class="code" href="lapi_8c.html#a328625a03fbb5548f27b1af10f109f6a">lua_pushnumber</a>(L, <a class="code" href="sqlite3_8h.html#af85c1bccdd78d4eefdcdb0136aaf9149">sqlite3_value_int</a>(value) );
<a name="l01237"></a>01237   <span class="keywordflow">else</span>
<a name="l01238"></a>01238     <a class="code" href="lapi_8c.html#a328625a03fbb5548f27b1af10f109f6a">lua_pushnumber</a>(L, <a class="code" href="sqlite3_8h.html#a0e5216b4627c5609b627c474617489bc">sqlite3_value_double</a>(value) );
<a name="l01239"></a>01239   <span class="keywordflow">return</span> 1;
<a name="l01240"></a>01240 }
<a name="l01241"></a>01241 
<a name="l01242"></a>01242 
<a name="l01243"></a><a class="code" href="libluasqlite3_8c.html#a0d5eca5a22d739c9a825e0b5683daa07">01243</a> <a class="code" href="libluasqlite3_8c.html#a4cb9e74c8e392bdf896eeca0586218cf">FUNC</a>( l_sqlite3_value_blob )
<a name="l01244"></a>01244 {
<a name="l01245"></a>01245   <a class="code" href="structMem.html">sqlite3_value</a> ** values = <a class="code" href="libluasqlite3_8c.html#a4680b8f082d847c367e9263cace94f23">checkvalues</a>(L, 1);
<a name="l01246"></a>01246   <span class="keywordtype">int</span> index = <a class="code" href="libluasqlite3_8c.html#a35c42e01e373065d3a0afe7367d364c1">checkint</a>(L, 2);
<a name="l01247"></a>01247   <a class="code" href="lapi_8c.html#ad457b6dc1bc1b6d5cf9b625c5b329e5e">lua_pushlstring</a>(L, <a class="code" href="sqlite3_8h.html#a81138be97f3e5124e33fb50925b710b6">sqlite3_value_blob</a>(values[index]), <a class="code" href="sqlite3_8h.html#a2aff2bf1311b5bd05d8e30738445b186">sqlite3_value_bytes</a>(values[index]) );
<a name="l01248"></a>01248   <span class="keywordflow">return</span> 1;
<a name="l01249"></a>01249 }
<a name="l01250"></a>01250 
<a name="l01251"></a>01251 
<a name="l01252"></a><a class="code" href="libluasqlite3_8c.html#aedfb9eecf378ad808bcb4444055f909c">01252</a> <a class="code" href="libluasqlite3_8c.html#a4cb9e74c8e392bdf896eeca0586218cf">FUNC</a>( l_sqlite3_value_text )
<a name="l01253"></a>01253 {
<a name="l01254"></a>01254   <a class="code" href="structMem.html">sqlite3_value</a> ** values = <a class="code" href="libluasqlite3_8c.html#a4680b8f082d847c367e9263cace94f23">checkvalues</a>(L, 1);
<a name="l01255"></a>01255   <span class="keywordtype">int</span> index = <a class="code" href="libluasqlite3_8c.html#a35c42e01e373065d3a0afe7367d364c1">checkint</a>(L, 2);
<a name="l01256"></a>01256   <a class="code" href="lapi_8c.html#ad457b6dc1bc1b6d5cf9b625c5b329e5e">lua_pushlstring</a>(L, (<span class="keyword">const</span> <span class="keywordtype">char</span>*)<a class="code" href="sqlite3_8h.html#a766575996a443f3405e197e0d74e3a9e">sqlite3_value_text</a>(values[index]), <a class="code" href="sqlite3_8h.html#a2aff2bf1311b5bd05d8e30738445b186">sqlite3_value_bytes</a>(values[index]) );
<a name="l01257"></a>01257   <span class="keywordflow">return</span> 1;
<a name="l01258"></a>01258 }
<a name="l01259"></a>01259 
<a name="l01260"></a>01260 
<a name="l01261"></a><a class="code" href="libluasqlite3_8c.html#af8aa2ff337ab3ef6b3d935f4fca986c7">01261</a> <a class="code" href="libluasqlite3_8c.html#a4cb9e74c8e392bdf896eeca0586218cf">FUNC</a>( l_sqlite3_value )
<a name="l01262"></a>01262 {
<a name="l01263"></a>01263   <a class="code" href="structMem.html">sqlite3_value</a> ** values = <a class="code" href="libluasqlite3_8c.html#a4680b8f082d847c367e9263cace94f23">checkvalues</a>(L, 1);
<a name="l01264"></a>01264   <span class="keywordtype">int</span> index     = <a class="code" href="libluasqlite3_8c.html#a35c42e01e373065d3a0afe7367d364c1">checkint</a>(L, 2);
<a name="l01265"></a>01265   <a class="code" href="structMem.html">sqlite3_value</a> * value   = values[index];
<a name="l01266"></a>01266   
<a name="l01267"></a>01267   <span class="keywordflow">switch</span>(<a class="code" href="sqlite3_8h.html#aed137fb0d21554419bc7de5675057503">sqlite3_value_type</a>(value))
<a name="l01268"></a>01268   {
<a name="l01269"></a>01269     <span class="keywordflow">case</span> <a class="code" href="sqlite3_8h.html#a7453d71905f10fa330940428f8abe21c">SQLITE_INTEGER</a>:
<a name="l01270"></a>01270       <a class="code" href="lapi_8c.html#a328625a03fbb5548f27b1af10f109f6a">lua_pushnumber</a>(L, <a class="code" href="sqlite3_8h.html#af85c1bccdd78d4eefdcdb0136aaf9149">sqlite3_value_int</a>(value) );
<a name="l01271"></a>01271       <span class="keywordflow">break</span>;
<a name="l01272"></a>01272     
<a name="l01273"></a>01273     <span class="keywordflow">case</span> <a class="code" href="sqlite3_8h.html#a0f415018bddf6542e69792aee0357984">SQLITE_FLOAT</a>:
<a name="l01274"></a>01274       <a class="code" href="lapi_8c.html#a328625a03fbb5548f27b1af10f109f6a">lua_pushnumber</a>(L, <a class="code" href="sqlite3_8h.html#a0e5216b4627c5609b627c474617489bc">sqlite3_value_double</a>(value) );
<a name="l01275"></a>01275       <span class="keywordflow">break</span>;
<a name="l01276"></a>01276     
<a name="l01277"></a>01277     <span class="keywordflow">case</span> <a class="code" href="sqlite3_8h.html#accfdca5d473931c3959bbdf4fc5c2ead">SQLITE_TEXT</a>:
<a name="l01278"></a>01278       <a class="code" href="lapi_8c.html#ad457b6dc1bc1b6d5cf9b625c5b329e5e">lua_pushlstring</a>(L, (<span class="keyword">const</span> <span class="keywordtype">char</span>*)<a class="code" href="sqlite3_8h.html#a766575996a443f3405e197e0d74e3a9e">sqlite3_value_text</a>(value), <a class="code" href="sqlite3_8h.html#a2aff2bf1311b5bd05d8e30738445b186">sqlite3_value_bytes</a>(value) );
<a name="l01279"></a>01279       <span class="keywordflow">break</span>;
<a name="l01280"></a>01280     
<a name="l01281"></a>01281     <span class="keywordflow">case</span> <a class="code" href="sqlite3_8h.html#a26c29a137b2a35bbde7048e5e48b794a">SQLITE_BLOB</a>:
<a name="l01282"></a>01282       <a class="code" href="lapi_8c.html#ad457b6dc1bc1b6d5cf9b625c5b329e5e">lua_pushlstring</a>(L, <a class="code" href="sqlite3_8h.html#a81138be97f3e5124e33fb50925b710b6">sqlite3_value_blob</a>(value), <a class="code" href="sqlite3_8h.html#a2aff2bf1311b5bd05d8e30738445b186">sqlite3_value_bytes</a>(value) );
<a name="l01283"></a>01283       <span class="keywordflow">break</span>;
<a name="l01284"></a>01284     
<a name="l01285"></a>01285     <span class="keywordflow">case</span> <a class="code" href="sqlite3_8h.html#afd180931f2d06d6c245791d187da5802">SQLITE_NULL</a>:
<a name="l01286"></a>01286       <a class="code" href="lapi_8c.html#a1b4cd0d80f51e5545a97ca6c28c03c50">lua_pushnil</a>(L);
<a name="l01287"></a>01287       <span class="keywordflow">break</span>;
<a name="l01288"></a>01288     
<a name="l01289"></a>01289     <span class="keywordflow">default</span>:
<a name="l01290"></a>01290       <a class="code" href="libluasqlite3_8c.html#a651d62983f0f11075ab3608c220fc397">report_error</a>(L, <span class="stringliteral">&quot;libluasqlite3: Internal error: Unknonw SQLITE data type.&quot;</span>);
<a name="l01291"></a>01291   }
<a name="l01292"></a>01292   <span class="keywordflow">return</span> 1;
<a name="l01293"></a>01293 }
<a name="l01294"></a>01294 
<a name="l01295"></a>01295 
<a name="l01296"></a><a class="code" href="libluasqlite3_8c.html#a3e95f9ad6b80e127ef51bb9709177d3a">01296</a> <a class="code" href="libluasqlite3_8c.html#a4cb9e74c8e392bdf896eeca0586218cf">FUNC</a>( l_sqlite3_value_type )
<a name="l01297"></a>01297 {
<a name="l01298"></a>01298   <a class="code" href="structMem.html">sqlite3_value</a> ** values = <a class="code" href="libluasqlite3_8c.html#a4680b8f082d847c367e9263cace94f23">checkvalues</a>(L, 1);
<a name="l01299"></a>01299   <span class="keywordtype">int</span> index = <a class="code" href="libluasqlite3_8c.html#a35c42e01e373065d3a0afe7367d364c1">checkint</a>(L, 2);
<a name="l01300"></a>01300   <a class="code" href="lapi_8c.html#a328625a03fbb5548f27b1af10f109f6a">lua_pushnumber</a>(L, <a class="code" href="sqlite3_8h.html#aed137fb0d21554419bc7de5675057503">sqlite3_value_type</a>(values[index]) );
<a name="l01301"></a>01301   <span class="keywordflow">return</span> 1;
<a name="l01302"></a>01302 }
<a name="l01303"></a>01303 
<a name="l01304"></a>01304 
<a name="l01305"></a><a class="code" href="libluasqlite3_8c.html#af3013918a5fdf519b5d3a2d1aa19aae5">01305</a> <a class="code" href="libluasqlite3_8c.html#a4cb9e74c8e392bdf896eeca0586218cf">FUNC</a>( l_sqlite3_libversion )
<a name="l01306"></a>01306 {
<a name="l01307"></a>01307   <a class="code" href="lapi_8c.html#a1281a7e2b52370cc416123bfd32b1b29">lua_pushstring</a>(L, <a class="code" href="main_8c.html#a56d672edfba3f5456e468cfb98061083">sqlite3_libversion</a>() );
<a name="l01308"></a>01308   <span class="keywordflow">return</span> 1;
<a name="l01309"></a>01309 }
<a name="l01310"></a>01310 
<a name="l01311"></a>01311 
<a name="l01312"></a><a class="code" href="libluasqlite3_8c.html#aa511bd93871c6e35c89d47a309a95d87">01312</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="libluasqlite3_8c.html#aa511bd93871c6e35c89d47a309a95d87">xcommit_callback_wrapper</a>(<span class="keywordtype">void</span> * cb_data)
<a name="l01313"></a>01313 {
<a name="l01314"></a>01314   <a class="code" href="structDB.html">DB</a> *    <a class="code" href="shell_8c.html#ad6e663497d2c934364b3bcf07496b30b">db</a> = <a class="code" href="libluasqlite3_8c.html#a11b53e19fa1be7f2b3fe2c460a53ff44">CB_DATA</a>(cb_data)-&gt;db;
<a name="l01315"></a>01315   <a class="code" href="structlua__State.html">lua_State</a> * L  = db-&gt;<a class="code" href="structDB.html#a2e9a0a1c036dd716f5091edff395de52">L</a>;
<a name="l01316"></a>01316   
<a name="l01317"></a>01317   <a class="code" href="libluasqlite3_8c.html#a7fdf29de7ea3da9d847f28fe34f8ae15">push_callback</a>(L, db, <a class="code" href="libluasqlite3_8c.html#a474a4965985855f9f8171bdf3e507d26">KEY_XCOMMIT</a>(cb_data));
<a name="l01318"></a>01318   
<a name="l01319"></a>01319   <span class="keywordflow">if</span> ( <a class="code" href="lapi_8c.html#a2a6cbad7f1c567378d17ded68b47f8f3">lua_pcall</a>(L, 0, 1, 0) )
<a name="l01320"></a>01320   {
<a name="l01321"></a>01321     <a class="code" href="lua_8h.html#abb8eae2164badeafdb037bc1e03cc822">lua_pop</a>(L, 1);
<a name="l01322"></a>01322     <span class="keywordflow">return</span> 1;   <span class="comment">/* on errors, rollback */</span>
<a name="l01323"></a>01323   }
<a name="l01324"></a>01324   
<a name="l01325"></a>01325   <span class="keywordflow">return</span> <a class="code" href="libluasqlite3_8c.html#a7d339e5c09255a0cd52524cf4dea8801">pop_break_condition</a>(L);
<a name="l01326"></a>01326 }
<a name="l01327"></a>01327 
<a name="l01328"></a><a class="code" href="libluasqlite3_8c.html#ac3bd3ed53a24d1682c337dfe2d2bec08">01328</a> <a class="code" href="libluasqlite3_8c.html#a4cb9e74c8e392bdf896eeca0586218cf">FUNC</a>( l_sqlite3_commit_hook )
<a name="l01329"></a>01329 {
<a name="l01330"></a>01330   <a class="code" href="structDB.html">DB</a> * <a class="code" href="shell_8c.html#ad6e663497d2c934364b3bcf07496b30b">db</a> = <a class="code" href="libluasqlite3_8c.html#ab0c20935a6010dcdbc203bd42e035c6f">checkdb</a>(L, 1);
<a name="l01331"></a>01331   <a class="code" href="structCB__Data.html">CB_Data</a> * cb_data = <a class="code" href="libluasqlite3_8c.html#acc49927b08f0cda891f8ada9e62b1d53">get_commit_cb_data</a>(L, db);
<a name="l01332"></a>01332   
<a name="l01333"></a>01333   int (*xcommit)(<span class="keywordtype">void</span> *);
<a name="l01334"></a>01334   
<a name="l01335"></a>01335   <span class="keywordflow">if</span> ( <a class="code" href="libluasqlite3_8c.html#a7bb1bafa6db5663c092b378528d8f260">checknilornoneorfunc</a>(L, 1) )
<a name="l01336"></a>01336     xcommit = <a class="code" href="libluasqlite3_8c.html#aa511bd93871c6e35c89d47a309a95d87">xcommit_callback_wrapper</a>;
<a name="l01337"></a>01337   <span class="keywordflow">else</span>
<a name="l01338"></a>01338     xcommit = 0;
<a name="l01339"></a>01339   
<a name="l01340"></a>01340   <a class="code" href="libluasqlite3_8c.html#aa7fe5f5eef5402785f2eecea3ebd1ecb">register_callback</a>(L, db, <a class="code" href="libluasqlite3_8c.html#a474a4965985855f9f8171bdf3e507d26">KEY_XCOMMIT</a>(cb_data), 2);
<a name="l01341"></a>01341   <a class="code" href="main_8c.html#a828725f97729a5bd0631ccffb8940b5c">sqlite3_commit_hook</a>(db-&gt;<a class="code" href="structDB.html#a6a6b21b3e3cea8111eb8010475b6603c">kr_db</a>, xcommit, cb_data);
<a name="l01342"></a>01342   
<a name="l01343"></a>01343   <a class="code" href="lapi_8c.html#a328625a03fbb5548f27b1af10f109f6a">lua_pushnumber</a>(L, <a class="code" href="main_8c.html#aacf8bb5cc3e174eca0c6aab77aa9d4ec">sqlite3_errcode</a>(db-&gt;<a class="code" href="structDB.html#a6a6b21b3e3cea8111eb8010475b6603c">kr_db</a>) );
<a name="l01344"></a>01344   <span class="keywordflow">return</span> 1;
<a name="l01345"></a>01345 }
<a name="l01346"></a>01346 
<a name="l01347"></a>01347 
<a name="l01348"></a><a class="code" href="libluasqlite3_8c.html#a25e0c7b6fd5dd913adcd0ac2f85b39d3">01348</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="libluasqlite3_8c.html#a25e0c7b6fd5dd913adcd0ac2f85b39d3">xprogress_callback_wrapper</a>(<span class="keywordtype">void</span> * cb_data)
<a name="l01349"></a>01349 {
<a name="l01350"></a>01350   <a class="code" href="structDB.html">DB</a> *    <a class="code" href="shell_8c.html#ad6e663497d2c934364b3bcf07496b30b">db</a> = <a class="code" href="libluasqlite3_8c.html#a11b53e19fa1be7f2b3fe2c460a53ff44">CB_DATA</a>(cb_data)-&gt;db;
<a name="l01351"></a>01351   <a class="code" href="structlua__State.html">lua_State</a> * L  = db-&gt;<a class="code" href="structDB.html#a2e9a0a1c036dd716f5091edff395de52">L</a>;
<a name="l01352"></a>01352   
<a name="l01353"></a>01353   <a class="code" href="libluasqlite3_8c.html#a7fdf29de7ea3da9d847f28fe34f8ae15">push_callback</a>(L, db, <a class="code" href="libluasqlite3_8c.html#a9f692022e7e45ff432a1c7b01ce30288">KEY_XPROGRESS</a>(cb_data));
<a name="l01354"></a>01354   
<a name="l01355"></a>01355   <span class="keywordflow">if</span> ( <a class="code" href="lapi_8c.html#a2a6cbad7f1c567378d17ded68b47f8f3">lua_pcall</a>(L, 0, 1, 0) )
<a name="l01356"></a>01356   {
<a name="l01357"></a>01357     <a class="code" href="lua_8h.html#abb8eae2164badeafdb037bc1e03cc822">lua_pop</a>(L, 1);
<a name="l01358"></a>01358     <span class="keywordflow">return</span> 1;   <span class="comment">/* on errors, rollback */</span>
<a name="l01359"></a>01359   }
<a name="l01360"></a>01360   
<a name="l01361"></a>01361   <span class="keywordflow">return</span> <a class="code" href="libluasqlite3_8c.html#a7d339e5c09255a0cd52524cf4dea8801">pop_break_condition</a>(L);
<a name="l01362"></a>01362   <span class="keywordflow">return</span> 1;
<a name="l01363"></a>01363 }
<a name="l01364"></a>01364 
<a name="l01365"></a><a class="code" href="libluasqlite3_8c.html#aa3a4106f5352c8eb658f4228c60a447b">01365</a> <a class="code" href="libluasqlite3_8c.html#a4cb9e74c8e392bdf896eeca0586218cf">FUNC</a>( l_sqlite3_progress_handler )
<a name="l01366"></a>01366 {
<a name="l01367"></a>01367   <a class="code" href="structDB.html">DB</a> * <a class="code" href="shell_8c.html#ad6e663497d2c934364b3bcf07496b30b">db</a>   = <a class="code" href="libluasqlite3_8c.html#ab0c20935a6010dcdbc203bd42e035c6f">checkdb</a>(L, 1);
<a name="l01368"></a>01368   <a class="code" href="structCB__Data.html">CB_Data</a> * cb_data = <a class="code" href="libluasqlite3_8c.html#a516af5b409f576b85db6be69c1ea3178">get_progress_cb_data</a>(L, db);
<a name="l01369"></a>01369   
<a name="l01370"></a>01370   int (*xprogress)(<span class="keywordtype">void</span> *);
<a name="l01371"></a>01371   
<a name="l01372"></a>01372   <span class="keywordflow">if</span> ( <a class="code" href="libluasqlite3_8c.html#a7bb1bafa6db5663c092b378528d8f260">checknilornoneorfunc</a>(L, 1) )
<a name="l01373"></a>01373     xprogress = <a class="code" href="libluasqlite3_8c.html#a25e0c7b6fd5dd913adcd0ac2f85b39d3">xprogress_callback_wrapper</a>;
<a name="l01374"></a>01374   <span class="keywordflow">else</span>
<a name="l01375"></a>01375     xprogress = 0;
<a name="l01376"></a>01376   
<a name="l01377"></a>01377   <a class="code" href="libluasqlite3_8c.html#aa7fe5f5eef5402785f2eecea3ebd1ecb">register_callback</a>(L, db, <a class="code" href="libluasqlite3_8c.html#a9f692022e7e45ff432a1c7b01ce30288">KEY_XPROGRESS</a>(cb_data), 3);
<a name="l01378"></a>01378   <a class="code" href="main_8c.html#a041dcfc0abb0d0cc1c3eb2f463eacf21">sqlite3_progress_handler</a>(db-&gt;<a class="code" href="structDB.html#a6a6b21b3e3cea8111eb8010475b6603c">kr_db</a>, <a class="code" href="libluasqlite3_8c.html#a35c42e01e373065d3a0afe7367d364c1">checkint</a>(L, 2), xprogress, cb_data);
<a name="l01379"></a>01379   
<a name="l01380"></a>01380   <a class="code" href="lapi_8c.html#a328625a03fbb5548f27b1af10f109f6a">lua_pushnumber</a>(L, <a class="code" href="main_8c.html#aacf8bb5cc3e174eca0c6aab77aa9d4ec">sqlite3_errcode</a>(db-&gt;<a class="code" href="structDB.html#a6a6b21b3e3cea8111eb8010475b6603c">kr_db</a>) );
<a name="l01381"></a>01381   <span class="keywordflow">return</span> 1;
<a name="l01382"></a>01382 }
<a name="l01383"></a>01383 
<a name="l01384"></a>01384 
<a name="l01385"></a><a class="code" href="libluasqlite3_8c.html#aff0972b233d912307cf1a6952a224706">01385</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="libluasqlite3_8c.html#aff0972b233d912307cf1a6952a224706">xbusy_callback_wrapper</a>(<span class="keywordtype">void</span> * cb_data, <span class="keywordtype">int</span> num_called)
<a name="l01386"></a>01386 {
<a name="l01387"></a>01387   <a class="code" href="structDB.html">DB</a> *    <a class="code" href="shell_8c.html#ad6e663497d2c934364b3bcf07496b30b">db</a> = <a class="code" href="libluasqlite3_8c.html#a11b53e19fa1be7f2b3fe2c460a53ff44">CB_DATA</a>(cb_data)-&gt;db;
<a name="l01388"></a>01388   <a class="code" href="structlua__State.html">lua_State</a> * L  = db-&gt;<a class="code" href="structDB.html#a2e9a0a1c036dd716f5091edff395de52">L</a>;
<a name="l01389"></a>01389   
<a name="l01390"></a>01390   <a class="code" href="libluasqlite3_8c.html#a7fdf29de7ea3da9d847f28fe34f8ae15">push_callback</a>(L, db, <a class="code" href="libluasqlite3_8c.html#a892e3185dab875c55427c635837ad0a3">KEY_XBUSY</a>(cb_data));
<a name="l01391"></a>01391   <a class="code" href="lapi_8c.html#a328625a03fbb5548f27b1af10f109f6a">lua_pushnumber</a>(L, num_called);
<a name="l01392"></a>01392   
<a name="l01393"></a>01393   <span class="keywordflow">if</span> ( <a class="code" href="lapi_8c.html#a2a6cbad7f1c567378d17ded68b47f8f3">lua_pcall</a>(L, 1, 1, 0) )
<a name="l01394"></a>01394   {
<a name="l01395"></a>01395     <a class="code" href="lua_8h.html#abb8eae2164badeafdb037bc1e03cc822">lua_pop</a>(L, 1);
<a name="l01396"></a>01396     <span class="keywordflow">return</span> 0;   <span class="comment">/* On errors, sqlite should return SQLITE_BUSY */</span>
<a name="l01397"></a>01397   }
<a name="l01398"></a>01398   
<a name="l01399"></a>01399   <span class="keywordflow">return</span> <a class="code" href="libluasqlite3_8c.html#a7d339e5c09255a0cd52524cf4dea8801">pop_break_condition</a>(L);  <span class="comment">/* WARNING: In reality, the semantic is inverted !!!*/</span>
<a name="l01400"></a>01400 }
<a name="l01401"></a>01401 
<a name="l01402"></a><a class="code" href="libluasqlite3_8c.html#af3a2297f9228c2770dd648261ca227ce">01402</a> <a class="code" href="libluasqlite3_8c.html#a4cb9e74c8e392bdf896eeca0586218cf">FUNC</a>( l_sqlite3_busy_handler )
<a name="l01403"></a>01403 {
<a name="l01404"></a>01404   <a class="code" href="structDB.html">DB</a> * <a class="code" href="shell_8c.html#ad6e663497d2c934364b3bcf07496b30b">db</a>   = <a class="code" href="libluasqlite3_8c.html#ab0c20935a6010dcdbc203bd42e035c6f">checkdb</a>(L, 1);
<a name="l01405"></a>01405   <a class="code" href="structCB__Data.html">CB_Data</a> * cb_data = <a class="code" href="libluasqlite3_8c.html#a226ba411222c799337e9be27c9fcb3a3">get_busy_cb_data</a>(L, db);
<a name="l01406"></a>01406   
<a name="l01407"></a>01407   int (*xbusy)(<span class="keywordtype">void</span> *, int);
<a name="l01408"></a>01408   
<a name="l01409"></a>01409   <span class="keywordflow">if</span> ( <a class="code" href="libluasqlite3_8c.html#a7bb1bafa6db5663c092b378528d8f260">checknilornoneorfunc</a>(L, 2) )
<a name="l01410"></a>01410     xbusy = <a class="code" href="libluasqlite3_8c.html#aff0972b233d912307cf1a6952a224706">xbusy_callback_wrapper</a>;
<a name="l01411"></a>01411   <span class="keywordflow">else</span>
<a name="l01412"></a>01412     xbusy = 0;
<a name="l01413"></a>01413   
<a name="l01414"></a>01414   <a class="code" href="libluasqlite3_8c.html#aa7fe5f5eef5402785f2eecea3ebd1ecb">register_callback</a>(L, db, <a class="code" href="libluasqlite3_8c.html#a892e3185dab875c55427c635837ad0a3">KEY_XBUSY</a>(cb_data), 2);
<a name="l01415"></a>01415   
<a name="l01416"></a>01416   <a class="code" href="lapi_8c.html#a328625a03fbb5548f27b1af10f109f6a">lua_pushnumber</a>(L, <a class="code" href="main_8c.html#ad9e56fa98ede849233984bfae15a82a0">sqlite3_busy_handler</a>(db-&gt;<a class="code" href="structDB.html#a6a6b21b3e3cea8111eb8010475b6603c">kr_db</a>, xbusy, cb_data) );
<a name="l01417"></a>01417   <span class="keywordflow">return</span> 1;
<a name="l01418"></a>01418 }
<a name="l01419"></a>01419 
<a name="l01420"></a>01420 
<a name="l01421"></a>01421 
<a name="l01422"></a><a class="code" href="libluasqlite3_8c.html#ad33a6bc641da92becce10c5013422ad7">01422</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="libluasqlite3_8c.html#ad33a6bc641da92becce10c5013422ad7">xauth_callback_wrapper</a>(<span class="keywordtype">void</span> * cb_data, <span class="keywordtype">int</span> auth_request, <span class="keyword">const</span> <span class="keywordtype">char</span> * name1, <span class="keyword">const</span> <span class="keywordtype">char</span> * name2, <span class="keyword">const</span> <span class="keywordtype">char</span> * db_name, <span class="keyword">const</span> <span class="keywordtype">char</span> * trigger_name)
<a name="l01423"></a>01423 {
<a name="l01424"></a>01424   <a class="code" href="structDB.html">DB</a> *    <a class="code" href="shell_8c.html#ad6e663497d2c934364b3bcf07496b30b">db</a> = <a class="code" href="libluasqlite3_8c.html#a11b53e19fa1be7f2b3fe2c460a53ff44">CB_DATA</a>(cb_data)-&gt;db;
<a name="l01425"></a>01425   <a class="code" href="structlua__State.html">lua_State</a> * L  = db-&gt;<a class="code" href="structDB.html#a2e9a0a1c036dd716f5091edff395de52">L</a>;
<a name="l01426"></a>01426   <span class="keywordtype">int</span> result;
<a name="l01427"></a>01427   
<a name="l01428"></a>01428   <a class="code" href="libluasqlite3_8c.html#a7fdf29de7ea3da9d847f28fe34f8ae15">push_callback</a>(L, db, <a class="code" href="libluasqlite3_8c.html#a97101f83717487630cb479d9b2077ee2">KEY_XAUTH</a>(cb_data));
<a name="l01429"></a>01429   <a class="code" href="lapi_8c.html#a328625a03fbb5548f27b1af10f109f6a">lua_pushnumber</a>(L, auth_request);
<a name="l01430"></a>01430   <a class="code" href="libluasqlite3_8c.html#a69f72323fbac40efe38eff5948922ebd">push_nil_or_string</a>(L, name1);
<a name="l01431"></a>01431   <a class="code" href="libluasqlite3_8c.html#a69f72323fbac40efe38eff5948922ebd">push_nil_or_string</a>(L, name2);
<a name="l01432"></a>01432   <a class="code" href="libluasqlite3_8c.html#a69f72323fbac40efe38eff5948922ebd">push_nil_or_string</a>(L, db_name);
<a name="l01433"></a>01433   <a class="code" href="libluasqlite3_8c.html#a69f72323fbac40efe38eff5948922ebd">push_nil_or_string</a>(L, trigger_name);
<a name="l01434"></a>01434   
<a name="l01435"></a>01435   <span class="keywordflow">if</span> ( <a class="code" href="lapi_8c.html#a2a6cbad7f1c567378d17ded68b47f8f3">lua_pcall</a>(L, 5, 1, 0) )
<a name="l01436"></a>01436   {
<a name="l01437"></a>01437     <a class="code" href="lua_8h.html#abb8eae2164badeafdb037bc1e03cc822">lua_pop</a>(L, 1);
<a name="l01438"></a>01438     <span class="keywordflow">return</span> <a class="code" href="sqlite3_8h.html#aac54c702b6175785e3300e9172b5f9bb">SQLITE_DENY</a>;   <span class="comment">/* On errors, sqlite should deny access */</span>
<a name="l01439"></a>01439   }
<a name="l01440"></a>01440   
<a name="l01441"></a>01441   <span class="keywordflow">if</span> (<a class="code" href="lapi_8c.html#a99451f234bf085c9c46c3d17a5aef905">lua_isnumber</a>(L, -1))
<a name="l01442"></a>01442     result = <a class="code" href="lapi_8c.html#a42c1f68101dc98a6ae4695c8577b17f8">lua_tonumber</a>(L, -1);
<a name="l01443"></a>01443   <span class="keywordflow">else</span>
<a name="l01444"></a>01444     result = <a class="code" href="sqlite3_8h.html#aac54c702b6175785e3300e9172b5f9bb">SQLITE_DENY</a>; <span class="comment">/* Wrong result values should deny access */</span>
<a name="l01445"></a>01445   
<a name="l01446"></a>01446   <a class="code" href="lua_8h.html#abb8eae2164badeafdb037bc1e03cc822">lua_pop</a>(L, 1);
<a name="l01447"></a>01447   <span class="keywordflow">return</span> result;
<a name="l01448"></a>01448 }
<a name="l01449"></a>01449 
<a name="l01450"></a><a class="code" href="libluasqlite3_8c.html#ad6b4ab9205402b8eed03c95f8ce666e5">01450</a> <a class="code" href="libluasqlite3_8c.html#a4cb9e74c8e392bdf896eeca0586218cf">FUNC</a>( l_sqlite3_set_authorizer )
<a name="l01451"></a>01451 {
<a name="l01452"></a>01452   <a class="code" href="structDB.html">DB</a> * <a class="code" href="shell_8c.html#ad6e663497d2c934364b3bcf07496b30b">db</a>   = <a class="code" href="libluasqlite3_8c.html#ab0c20935a6010dcdbc203bd42e035c6f">checkdb</a>(L, 1);
<a name="l01453"></a>01453   <a class="code" href="structCB__Data.html">CB_Data</a> * cb_data = <a class="code" href="libluasqlite3_8c.html#a05fdaac447802e596d65b656b5b41e7c">get_authorizer_cb_data</a>(L, db);
<a name="l01454"></a>01454   
<a name="l01455"></a>01455   int (*xauth)(<span class="keywordtype">void</span> *, int, <span class="keyword">const</span> <span class="keywordtype">char</span> *, <span class="keyword">const</span> <span class="keywordtype">char</span> *, <span class="keyword">const</span> <span class="keywordtype">char</span> *, <span class="keyword">const</span> <span class="keywordtype">char</span> *);
<a name="l01456"></a>01456   
<a name="l01457"></a>01457   <span class="keywordflow">if</span> ( <a class="code" href="libluasqlite3_8c.html#a7bb1bafa6db5663c092b378528d8f260">checknilornoneorfunc</a>(L, 2) )
<a name="l01458"></a>01458     xauth = <a class="code" href="libluasqlite3_8c.html#ad33a6bc641da92becce10c5013422ad7">xauth_callback_wrapper</a>;
<a name="l01459"></a>01459   <span class="keywordflow">else</span>
<a name="l01460"></a>01460     xauth = 0;
<a name="l01461"></a>01461   
<a name="l01462"></a>01462   <a class="code" href="libluasqlite3_8c.html#aa7fe5f5eef5402785f2eecea3ebd1ecb">register_callback</a>(L, db, <a class="code" href="libluasqlite3_8c.html#a97101f83717487630cb479d9b2077ee2">KEY_XAUTH</a>(cb_data), 2);
<a name="l01463"></a>01463 
<a name="l01464"></a>01464   <a class="code" href="lapi_8c.html#a328625a03fbb5548f27b1af10f109f6a">lua_pushnumber</a>(L, <a class="code" href="auth_8c.html#a4777b652e17be2d2c2ad64a2ea8eb735">sqlite3_set_authorizer</a>(db-&gt;<a class="code" href="structDB.html#a6a6b21b3e3cea8111eb8010475b6603c">kr_db</a>, xauth, cb_data) );
<a name="l01465"></a>01465   <span class="keywordflow">return</span> 1;
<a name="l01466"></a>01466 }
<a name="l01467"></a>01467 
<a name="l01468"></a>01468 
<a name="l01469"></a>01469 
<a name="l01470"></a>01470 
<a name="l01471"></a>01471 
<a name="l01472"></a>01472 
<a name="l01473"></a><a class="code" href="structf__entry.html#aac430888d1670b802d6d3260c2aa6517">01473</a> <span class="keyword">typedef</span> <span class="keyword">struct </span>{ <span class="keywordtype">char</span> * name; int (*func)(<a class="code" href="structlua__State.html">lua_State</a> *); } <a class="code" href="structf__entry.html">f_entry</a>;
<a name="l01474"></a><a class="code" href="structd__entry.html#a198c45552624d950ea2677a6ee51c86b">01474</a> <span class="keyword">typedef</span> <span class="keyword">struct </span>{ <span class="keywordtype">char</span> * name; <span class="keywordtype">int</span> value; } <a class="code" href="structd__entry.html">d_entry</a>;
<a name="l01475"></a>01475 
<a name="l01476"></a>01476 
<a name="l01477"></a>01477 
<a name="l01478"></a><a class="code" href="libluasqlite3_8c.html#ae16fcc70ad2cbf55b1906507bcb6fa33">01478</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="libluasqlite3_8c.html#ae16fcc70ad2cbf55b1906507bcb6fa33">f</a>(<a class="code" href="structlua__State.html">lua_State</a> * L, <a class="code" href="structf__entry.html">f_entry</a> entries[])
<a name="l01479"></a>01479 {
<a name="l01480"></a>01480   <span class="keywordtype">int</span> index;
<a name="l01481"></a>01481   <a class="code" href="lua_8h.html#aa59db6b784aa1ec954599a44168c7761">lua_newtable</a>(L);
<a name="l01482"></a>01482   <span class="keywordflow">for</span>( index=0; entries[index].<a class="code" href="structf__entry.html#aac430888d1670b802d6d3260c2aa6517">name</a>; index++)
<a name="l01483"></a>01483   {
<a name="l01484"></a>01484     <a class="code" href="lapi_8c.html#a1281a7e2b52370cc416123bfd32b1b29">lua_pushstring</a>(L, entries[index].name);
<a name="l01485"></a>01485     <a class="code" href="lua_8h.html#a2e4fbbe97182bf90004379202202f2b9">lua_pushcfunction</a>(L, entries[index].func);
<a name="l01486"></a>01486     <a class="code" href="lapi_8c.html#afb2d27f421677ef40425f9054ae216a7">lua_rawset</a>(L, -3);
<a name="l01487"></a>01487   }
<a name="l01488"></a>01488 }
<a name="l01489"></a>01489 
<a name="l01490"></a>01490 
<a name="l01491"></a>01491 
<a name="l01492"></a><a class="code" href="libluasqlite3_8c.html#a8d6141748244c12982deaaf0dafd7449">01492</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="libluasqlite3_8c.html#a8d6141748244c12982deaaf0dafd7449">d</a>(<a class="code" href="structlua__State.html">lua_State</a> * L, <a class="code" href="structd__entry.html">d_entry</a> entries[])
<a name="l01493"></a>01493 {
<a name="l01494"></a>01494   <span class="keywordtype">int</span> index;
<a name="l01495"></a>01495   <a class="code" href="lua_8h.html#aa59db6b784aa1ec954599a44168c7761">lua_newtable</a>(L);
<a name="l01496"></a>01496   <span class="keywordflow">for</span>( index=0; entries[index].<a class="code" href="structd__entry.html#af0b99acd284d7bbf0ef37bfa6dd46a91">name</a>; index++)
<a name="l01497"></a>01497   {
<a name="l01498"></a>01498     <a class="code" href="lapi_8c.html#a1281a7e2b52370cc416123bfd32b1b29">lua_pushstring</a>(L, entries[index].name);
<a name="l01499"></a>01499     <a class="code" href="lapi_8c.html#a328625a03fbb5548f27b1af10f109f6a">lua_pushnumber</a>(L, entries[index].value);
<a name="l01500"></a>01500     <a class="code" href="lapi_8c.html#afb2d27f421677ef40425f9054ae216a7">lua_rawset</a>(L, -3);
<a name="l01501"></a>01501   }
<a name="l01502"></a>01502 }
<a name="l01503"></a>01503 
<a name="l01504"></a>01504 
<a name="l01505"></a>01505 
<a name="l01506"></a><a class="code" href="libluasqlite3_8c.html#af16e12d2db6c0eabc176371abfe6b375">01506</a> <a class="code" href="structf__entry.html">f_entry</a> <a class="code" href="libluasqlite3_8c.html#af16e12d2db6c0eabc176371abfe6b375">api_entries</a>[] = {
<a name="l01507"></a>01507   { <span class="stringliteral">&quot;bind_null&quot;</span>,    l_sqlite3_bind_null },
<a name="l01508"></a>01508   { <span class="stringliteral">&quot;bind_text&quot;</span>,    l_sqlite3_bind_text },
<a name="l01509"></a>01509   { <span class="stringliteral">&quot;bind_blob&quot;</span>,    l_sqlite3_bind_blob },
<a name="l01510"></a>01510   { <span class="stringliteral">&quot;bind_int&quot;</span>,     l_sqlite3_bind_int },
<a name="l01511"></a>01511   { <span class="stringliteral">&quot;bind_double&quot;</span>,    l_sqlite3_bind_double },
<a name="l01512"></a>01512   { <span class="stringliteral">&quot;bind_number&quot;</span>,    l_sqlite3_bind_number },
<a name="l01513"></a>01513   { <span class="stringliteral">&quot;bind&quot;</span>,     l_sqlite3_bind },
<a name="l01514"></a>01514   { <span class="stringliteral">&quot;bind_parameter_name&quot;</span>,  l_sqlite3_bind_parameter_name },
<a name="l01515"></a>01515   { <span class="stringliteral">&quot;bind_parameter_name_x&quot;</span>,  l_sqlite3_bind_parameter_name_x },
<a name="l01516"></a>01516   { <span class="stringliteral">&quot;bind_parameter_count&quot;</span>, l_sqlite3_bind_parameter_count },
<a name="l01517"></a>01517   { <span class="stringliteral">&quot;busy_timeout&quot;</span>,   l_sqlite3_busy_timeout },
<a name="l01518"></a>01518   { <span class="stringliteral">&quot;changes&quot;</span>,      l_sqlite3_changes },
<a name="l01519"></a>01519   { <span class="stringliteral">&quot;close&quot;</span>,      l_sqlite3_close },
<a name="l01520"></a>01520   { <span class="stringliteral">&quot;column_blob&quot;</span>,    l_sqlite3_column_blob },
<a name="l01521"></a>01521   { <span class="stringliteral">&quot;column_text&quot;</span>,    l_sqlite3_column_text },
<a name="l01522"></a>01522   { <span class="stringliteral">&quot;column_int&quot;</span>,   l_sqlite3_column_int },
<a name="l01523"></a>01523   { <span class="stringliteral">&quot;column_double&quot;</span>,    l_sqlite3_column_double },
<a name="l01524"></a>01524   { <span class="stringliteral">&quot;column_number&quot;</span>,    l_sqlite3_column_number },
<a name="l01525"></a>01525   { <span class="stringliteral">&quot;column&quot;</span>,     l_sqlite3_column },
<a name="l01526"></a>01526   { <span class="stringliteral">&quot;column_type&quot;</span>,    l_sqlite3_column_type },
<a name="l01527"></a>01527   { <span class="stringliteral">&quot;column_count&quot;</span>,   l_sqlite3_column_count },
<a name="l01528"></a>01528   { <span class="stringliteral">&quot;column_decltype&quot;</span>,    l_sqlite3_column_decltype },
<a name="l01529"></a>01529   { <span class="stringliteral">&quot;column_name&quot;</span>,    l_sqlite3_column_name },
<a name="l01530"></a>01530   { <span class="stringliteral">&quot;complete&quot;</span>,     l_sqlite3_complete },
<a name="l01531"></a>01531   { <span class="stringliteral">&quot;data_count&quot;</span>,   l_sqlite3_data_count },
<a name="l01532"></a>01532   { <span class="stringliteral">&quot;errcode&quot;</span>,      l_sqlite3_errcode },
<a name="l01533"></a>01533   { <span class="stringliteral">&quot;errmsg&quot;</span>,     l_sqlite3_errmsg },
<a name="l01534"></a>01534   { <span class="stringliteral">&quot;finalize&quot;</span>,     l_sqlite3_finalize },
<a name="l01535"></a>01535   { <span class="stringliteral">&quot;interrupt&quot;</span>,    l_sqlite3_interrupt },
<a name="l01536"></a>01536   { <span class="stringliteral">&quot;last_insert_rowid&quot;</span>,  l_sqlite3_last_insert_rowid },
<a name="l01537"></a>01537   { <span class="stringliteral">&quot;open&quot;</span>,     l_sqlite3_open },
<a name="l01538"></a>01538   { <span class="stringliteral">&quot;prepare&quot;</span>,      l_sqlite3_prepare },
<a name="l01539"></a>01539   { <span class="stringliteral">&quot;reset&quot;</span>,      l_sqlite3_reset },
<a name="l01540"></a>01540   { <span class="stringliteral">&quot;step&quot;</span>,     l_sqlite3_step },
<a name="l01541"></a>01541   { <span class="stringliteral">&quot;total_changes&quot;</span>,    l_sqlite3_total_changes },
<a name="l01542"></a>01542   { <span class="stringliteral">&quot;exec&quot;</span>,     l_sqlite3_exec },
<a name="l01543"></a>01543   { <span class="stringliteral">&quot;create_function&quot;</span>,    l_sqlite3_create_function },
<a name="l01544"></a>01544   { <span class="stringliteral">&quot;create_collation&quot;</span>,   l_sqlite3_create_collation },
<a name="l01545"></a>01545   { <span class="stringliteral">&quot;trace&quot;</span>,      l_sqlite3_trace },
<a name="l01546"></a>01546   { <span class="stringliteral">&quot;collation_needed&quot;</span>,   l_sqlite3_collation_needed },
<a name="l01547"></a>01547   { <span class="stringliteral">&quot;result_null&quot;</span>,    l_sqlite3_result_null },
<a name="l01548"></a>01548   { <span class="stringliteral">&quot;result_error&quot;</span>,   l_sqlite3_result_error },
<a name="l01549"></a>01549   { <span class="stringliteral">&quot;result_double&quot;</span>,    l_sqlite3_result_double },
<a name="l01550"></a>01550   { <span class="stringliteral">&quot;result_int&quot;</span>,   l_sqlite3_result_int },
<a name="l01551"></a>01551   { <span class="stringliteral">&quot;result_number&quot;</span>,    l_sqlite3_result_number },
<a name="l01552"></a>01552   { <span class="stringliteral">&quot;result_blob&quot;</span>,    l_sqlite3_result_blob },
<a name="l01553"></a>01553   { <span class="stringliteral">&quot;result_text&quot;</span>,    l_sqlite3_result_text },
<a name="l01554"></a>01554   { <span class="stringliteral">&quot;result_value&quot;</span>,   l_sqlite3_result_value },
<a name="l01555"></a>01555   { <span class="stringliteral">&quot;result&quot;</span>,     l_sqlite3_result },
<a name="l01556"></a>01556   { <span class="stringliteral">&quot;aggregate_count&quot;</span>,    l_sqlite3_aggregate_count },
<a name="l01557"></a>01557   { <span class="stringliteral">&quot;aggregate_context&quot;</span>,  l_sqlite3_aggregate_context },
<a name="l01558"></a>01558   { <span class="stringliteral">&quot;value_int&quot;</span>,    l_sqlite3_value_int },
<a name="l01559"></a>01559   { <span class="stringliteral">&quot;value_double&quot;</span>,   l_sqlite3_value_double },
<a name="l01560"></a>01560   { <span class="stringliteral">&quot;value_number&quot;</span>,   l_sqlite3_value_number },
<a name="l01561"></a>01561   { <span class="stringliteral">&quot;value_blob&quot;</span>,   l_sqlite3_value_blob },
<a name="l01562"></a>01562   { <span class="stringliteral">&quot;value_text&quot;</span>,   l_sqlite3_value_text },
<a name="l01563"></a>01563   { <span class="stringliteral">&quot;value&quot;</span>,      l_sqlite3_value },
<a name="l01564"></a>01564   { <span class="stringliteral">&quot;value_type&quot;</span>,   l_sqlite3_value_type },
<a name="l01565"></a>01565   { <span class="stringliteral">&quot;libversion&quot;</span>,   l_sqlite3_libversion },
<a name="l01566"></a>01566   { <span class="stringliteral">&quot;commit_hook&quot;</span>,    l_sqlite3_commit_hook },
<a name="l01567"></a>01567   { <span class="stringliteral">&quot;progress_handler&quot;</span>,   l_sqlite3_progress_handler },
<a name="l01568"></a>01568   { <span class="stringliteral">&quot;busy_handler&quot;</span>,   l_sqlite3_busy_handler },
<a name="l01569"></a>01569   { <span class="stringliteral">&quot;set_authorizer&quot;</span>,   l_sqlite3_set_authorizer },
<a name="l01570"></a>01570   { <span class="stringliteral">&quot;drow&quot;</span>,     l_sqlite3_drow },
<a name="l01571"></a>01571   { <span class="stringliteral">&quot;irow&quot;</span>,     l_sqlite3_irow },
<a name="l01572"></a>01572   { <span class="stringliteral">&quot;arow&quot;</span>,     l_sqlite3_arow },
<a name="l01573"></a>01573   { 0, 0 }
<a name="l01574"></a>01574 };
<a name="l01575"></a>01575 
<a name="l01576"></a>01576 
<a name="l01577"></a><a class="code" href="libluasqlite3_8c.html#a5bc65ee03516839c0c9b3743571a3afa">01577</a> <a class="code" href="structd__entry.html">d_entry</a> <a class="code" href="libluasqlite3_8c.html#a5bc65ee03516839c0c9b3743571a3afa">error_entries</a>[] = {
<a name="l01578"></a>01578   { <span class="stringliteral">&quot;OK&quot;</span>,     <a class="code" href="sqlite3_8h.html#a650d09c7bec7ddadb7c8aa3519dc842c">SQLITE_OK</a> },
<a name="l01579"></a>01579   { <span class="stringliteral">&quot;ERROR&quot;</span>,      <a class="code" href="sqlite3_8h.html#afda25cd6575e87558d2b7cd4a6585f2f">SQLITE_ERROR</a> },
<a name="l01580"></a>01580   { <span class="stringliteral">&quot;INTERNAL&quot;</span>,     <a class="code" href="sqlite3_8h.html#a76bdc16193e1d007e258ca26e6ffd9f1">SQLITE_INTERNAL</a> },
<a name="l01581"></a>01581   { <span class="stringliteral">&quot;PERM&quot;</span>,     <a class="code" href="sqlite3_8h.html#af2561d6fe38a527e46e24db1952ee53a">SQLITE_PERM</a> },
<a name="l01582"></a>01582   { <span class="stringliteral">&quot;ABORT&quot;</span>,      <a class="code" href="sqlite3_8h.html#ab0c18279e950b695575a4667c7bb38b7">SQLITE_ABORT</a> },
<a name="l01583"></a>01583   { <span class="stringliteral">&quot;BUSY&quot;</span>,     <a class="code" href="sqlite3_8h.html#a2404c3c65a25e31de96f71d709c6b7c1">SQLITE_BUSY</a> },
<a name="l01584"></a>01584   { <span class="stringliteral">&quot;LOCKED&quot;</span>,     <a class="code" href="sqlite3_8h.html#ab1a65dcef7ac3d761c7f0a07e3428a58">SQLITE_LOCKED</a> },
<a name="l01585"></a>01585   { <span class="stringliteral">&quot;NOMEM&quot;</span>,      <a class="code" href="sqlite3_8h.html#a9e34c7a5186dc9095e108e517eaac9f6">SQLITE_NOMEM</a> },
<a name="l01586"></a>01586   { <span class="stringliteral">&quot;READONLY&quot;</span>,     <a class="code" href="sqlite3_8h.html#a1ee0a0db43018cda5ee64cf78abbd675">SQLITE_READONLY</a> },
<a name="l01587"></a>01587   { <span class="stringliteral">&quot;INTERRUPT&quot;</span>,    <a class="code" href="sqlite3_8h.html#a03c9b25faf07d0e47ce7a1b1e46b2adc">SQLITE_INTERRUPT</a> },
<a name="l01588"></a>01588   { <span class="stringliteral">&quot;IOERR&quot;</span>,      <a class="code" href="sqlite3_8h.html#a45a4718698f155ae3b45d37d3b94d9a2">SQLITE_IOERR</a> },
<a name="l01589"></a>01589   { <span class="stringliteral">&quot;CORRUPT&quot;</span>,      <a class="code" href="sqlite3_8h.html#a4b7e972bd61cc8f5fb639011d1807935">SQLITE_CORRUPT</a> },
<a name="l01590"></a>01590   { <span class="stringliteral">&quot;NOTFOUND&quot;</span>,     <a class="code" href="sqlite3_8h.html#a305a03273389c4fa6313181a6de78dff">SQLITE_NOTFOUND</a> },
<a name="l01591"></a>01591   { <span class="stringliteral">&quot;FULL&quot;</span>,     <a class="code" href="sqlite3_8h.html#a0e968a73ba9e13561c5dbf38f6ac7402">SQLITE_FULL</a> },
<a name="l01592"></a>01592   { <span class="stringliteral">&quot;CANTOPEN&quot;</span>,     <a class="code" href="sqlite3_8h.html#afd6b86c2df4363b6d0f18e16b76ff897">SQLITE_CANTOPEN</a> },
<a name="l01593"></a>01593   { <span class="stringliteral">&quot;PROTOCOL&quot;</span>,     <a class="code" href="sqlite3_8h.html#a9d36e4a7294f4df777bd4520489190c5">SQLITE_PROTOCOL</a> },
<a name="l01594"></a>01594   { <span class="stringliteral">&quot;EMPTY&quot;</span>,      <a class="code" href="sqlite3_8h.html#adb3ccb6413bc81a990cab25356ab092f">SQLITE_EMPTY</a> },
<a name="l01595"></a>01595   { <span class="stringliteral">&quot;SCHEMA&quot;</span>,     <a class="code" href="sqlite3_8h.html#a1671ab645a3331d997b4422dc334476a">SQLITE_SCHEMA</a> },
<a name="l01596"></a>01596   { <span class="stringliteral">&quot;TOOBIG&quot;</span>,     <a class="code" href="sqlite3_8h.html#a88e41cbe09fb26a267081d59316ef126">SQLITE_TOOBIG</a> },
<a name="l01597"></a>01597   { <span class="stringliteral">&quot;CONSTRAINT&quot;</span>,   <a class="code" href="sqlite3_8h.html#a60b2b65ad97f771203e26733f870af57">SQLITE_CONSTRAINT</a> },
<a name="l01598"></a>01598   { <span class="stringliteral">&quot;MISMATCH&quot;</span>,     <a class="code" href="sqlite3_8h.html#a788bd19e9f21649acfb6307801c6474f">SQLITE_MISMATCH</a> },
<a name="l01599"></a>01599   { <span class="stringliteral">&quot;MISUSE&quot;</span>,     <a class="code" href="sqlite3_8h.html#a34f01e4ee909e6b68be040868f7503bc">SQLITE_MISUSE</a> },
<a name="l01600"></a>01600   { <span class="stringliteral">&quot;NOLFS&quot;</span>,      <a class="code" href="sqlite3_8h.html#a667d508a9af9e6a08e18abfc81c986ee">SQLITE_NOLFS</a> },
<a name="l01601"></a>01601   { <span class="stringliteral">&quot;AUTH&quot;</span>,     <a class="code" href="sqlite3_8h.html#ab4954b805784b958300b203fda451283">SQLITE_AUTH</a> },
<a name="l01602"></a>01602   { <span class="stringliteral">&quot;ROW&quot;</span>,      <a class="code" href="sqlite3_8h.html#a624365823d0b11a99ccb49e9bb5f8fcf">SQLITE_ROW</a> },
<a name="l01603"></a>01603   { <span class="stringliteral">&quot;DONE&quot;</span>,     <a class="code" href="sqlite3_8h.html#afd1d7cc5f2e803af5e944f548e28f141">SQLITE_DONE</a> },
<a name="l01604"></a>01604   { <span class="stringliteral">&quot;DENY&quot;</span>,     <a class="code" href="sqlite3_8h.html#aac54c702b6175785e3300e9172b5f9bb">SQLITE_DENY</a> },
<a name="l01605"></a>01605   { <span class="stringliteral">&quot;IGNORE&quot;</span>,     <a class="code" href="sqlite3_8h.html#a5148e80e8b93241486549be6842ecb7b">SQLITE_IGNORE</a> },
<a name="l01606"></a>01606   { 0, 0 }
<a name="l01607"></a>01607 };
<a name="l01608"></a>01608 
<a name="l01609"></a>01609 
<a name="l01610"></a><a class="code" href="libluasqlite3_8c.html#a19e5cb5734ce61d53088e591a01dc797">01610</a> <a class="code" href="structd__entry.html">d_entry</a> <a class="code" href="libluasqlite3_8c.html#a19e5cb5734ce61d53088e591a01dc797">type_entries</a>[] = {
<a name="l01611"></a>01611   { <span class="stringliteral">&quot;INTEGER&quot;</span>,      <a class="code" href="sqlite3_8h.html#a7453d71905f10fa330940428f8abe21c">SQLITE_INTEGER</a> },
<a name="l01612"></a>01612   { <span class="stringliteral">&quot;INT&quot;</span>,      <a class="code" href="sqlite3_8h.html#a7453d71905f10fa330940428f8abe21c">SQLITE_INTEGER</a> },
<a name="l01613"></a>01613   { <span class="stringliteral">&quot;FLOAT&quot;</span>,      <a class="code" href="sqlite3_8h.html#a0f415018bddf6542e69792aee0357984">SQLITE_FLOAT</a> },
<a name="l01614"></a>01614   { <span class="stringliteral">&quot;DOUBLE&quot;</span>,     <a class="code" href="sqlite3_8h.html#a0f415018bddf6542e69792aee0357984">SQLITE_FLOAT</a> },
<a name="l01615"></a>01615   { <span class="stringliteral">&quot;TEXT&quot;</span>,     <a class="code" href="sqlite3_8h.html#accfdca5d473931c3959bbdf4fc5c2ead">SQLITE_TEXT</a> },
<a name="l01616"></a>01616   { <span class="stringliteral">&quot;BLOB&quot;</span>,     <a class="code" href="sqlite3_8h.html#a26c29a137b2a35bbde7048e5e48b794a">SQLITE_BLOB</a> },
<a name="l01617"></a>01617   { <span class="stringliteral">&quot;NULL&quot;</span>,     <a class="code" href="sqlite3_8h.html#afd180931f2d06d6c245791d187da5802">SQLITE_NULL</a> },
<a name="l01618"></a>01618   { 0, 0 }
<a name="l01619"></a>01619 };
<a name="l01620"></a>01620 
<a name="l01621"></a>01621 
<a name="l01622"></a><a class="code" href="libluasqlite3_8c.html#a6b0675e0e3a9a716942cbcffecf970ab">01622</a> <a class="code" href="structd__entry.html">d_entry</a> <a class="code" href="libluasqlite3_8c.html#a6b0675e0e3a9a716942cbcffecf970ab">auth_entries</a>[] = {
<a name="l01623"></a>01623   { <span class="stringliteral">&quot;CREATE_INDEX&quot;</span>,   <a class="code" href="sqlite3_8h.html#afbcb4b5ee1d5772cef588361efba0b68">SQLITE_CREATE_INDEX</a> },
<a name="l01624"></a>01624   { <span class="stringliteral">&quot;CREATE_TABLE&quot;</span>,   <a class="code" href="sqlite3_8h.html#a5c0aa6f25437e25456453c213b7a7626">SQLITE_CREATE_TABLE</a> },
<a name="l01625"></a>01625   { <span class="stringliteral">&quot;CREATE_TRIGGER&quot;</span>,   <a class="code" href="sqlite3_8h.html#a7dcc55ab50b69228d4a208293b43bd7d">SQLITE_CREATE_TRIGGER</a> },
<a name="l01626"></a>01626   { <span class="stringliteral">&quot;CREATE_VIEW&quot;</span>,    <a class="code" href="sqlite3_8h.html#ad7b8eb5c5c6545dd174090218ba2b894">SQLITE_CREATE_VIEW</a> },
<a name="l01627"></a>01627   { <span class="stringliteral">&quot;CREATE_TEMP_INDEX&quot;</span>,  <a class="code" href="sqlite3_8h.html#a9ec6a2ffcc0cfa3c36c8007141a38fa1">SQLITE_CREATE_TEMP_INDEX</a> },
<a name="l01628"></a>01628   { <span class="stringliteral">&quot;CREATE_TEMP_TABLE&quot;</span>,  <a class="code" href="sqlite3_8h.html#af45530e07634dde0993da64df8fac41a">SQLITE_CREATE_TEMP_TABLE</a> },
<a name="l01629"></a>01629   { <span class="stringliteral">&quot;CREATE_TEMP_TRIGGER&quot;</span>,  <a class="code" href="sqlite3_8h.html#a811f55a358da6ed4d1f9d95484bbdd5c">SQLITE_CREATE_TEMP_TRIGGER</a> },
<a name="l01630"></a>01630   { <span class="stringliteral">&quot;CREATE_TEMP_VIEW&quot;</span>, <a class="code" href="sqlite3_8h.html#a1d4f64f2b5baf8c638780511b27753a6">SQLITE_CREATE_TEMP_VIEW</a> },
<a name="l01631"></a>01631   { <span class="stringliteral">&quot;DROP_INDEX&quot;</span>,   <a class="code" href="sqlite3_8h.html#ac285cb102ca0ced83ce8eaf34de49f2c">SQLITE_DROP_INDEX</a> },
<a name="l01632"></a>01632   { <span class="stringliteral">&quot;DROP_TABLE&quot;</span>,   <a class="code" href="sqlite3_8h.html#a2438239bdc66129189a9f3cdcc41096e">SQLITE_DROP_TABLE</a> },
<a name="l01633"></a>01633   { <span class="stringliteral">&quot;DROP_TRIGGER&quot;</span>,   <a class="code" href="sqlite3_8h.html#ae3bf0ee40c4041190c5fed55e5504ed7">SQLITE_DROP_TRIGGER</a> },
<a name="l01634"></a>01634   { <span class="stringliteral">&quot;DROP_VIEW&quot;</span>,    <a class="code" href="sqlite3_8h.html#accc2ecaaf088bb98eaef53fefab83361">SQLITE_DROP_VIEW</a> },
<a name="l01635"></a>01635   { <span class="stringliteral">&quot;DROP_TEMP_INDEX&quot;</span>,    <a class="code" href="sqlite3_8h.html#a33f05725c280233f7a2bce538d862d63">SQLITE_DROP_TEMP_INDEX</a> },
<a name="l01636"></a>01636   { <span class="stringliteral">&quot;DROP_TEMP_TABLE&quot;</span>,    <a class="code" href="sqlite3_8h.html#a6fcdb2dc93b4c7937e58de176da508e3">SQLITE_DROP_TEMP_TABLE</a> },
<a name="l01637"></a>01637   { <span class="stringliteral">&quot;DROP_TEMP_TRIGGER&quot;</span>,  <a class="code" href="sqlite3_8h.html#a06e26767a0b03197b42d0cba590285e8">SQLITE_DROP_TEMP_TRIGGER</a> },
<a name="l01638"></a>01638   { <span class="stringliteral">&quot;DROP_TEMP_VIEW&quot;</span>,   <a class="code" href="sqlite3_8h.html#a0e8b3a8774a3f9e5ffa03220d4daa236">SQLITE_DROP_TEMP_VIEW</a> },
<a name="l01639"></a>01639   { <span class="stringliteral">&quot;INSERT&quot;</span>,     <a class="code" href="sqlite3_8h.html#a0d32c3f24fcfd33411eecb1e4da64a40">SQLITE_INSERT</a> },
<a name="l01640"></a>01640   { <span class="stringliteral">&quot;PRAGMA&quot;</span>,     <a class="code" href="sqlite3_8h.html#a3a4caf2970195e9221d677852b79e5b6">SQLITE_PRAGMA</a> },
<a name="l01641"></a>01641   { <span class="stringliteral">&quot;READ&quot;</span>,     <a class="code" href="sqlite3_8h.html#a3f1a55857de47148723f789496f8731b">SQLITE_READ</a> },
<a name="l01642"></a>01642   { <span class="stringliteral">&quot;SELECT&quot;</span>,     <a class="code" href="sqlite3_8h.html#aaf0f44e586b55ebc82bad16c31d86ba7">SQLITE_SELECT</a> },
<a name="l01643"></a>01643   { <span class="stringliteral">&quot;TRANSACTION&quot;</span>,    <a class="code" href="sqlite3_8h.html#a881c5f0d2da58a62833f97d55688df8e">SQLITE_TRANSACTION</a> },
<a name="l01644"></a>01644   { <span class="stringliteral">&quot;UPDATE&quot;</span>,     <a class="code" href="sqlite3_8h.html#abe5e121cf6a85525dae8c65cea7edd48">SQLITE_UPDATE</a> },
<a name="l01645"></a>01645   { <span class="stringliteral">&quot;ATTACH&quot;</span>,     <a class="code" href="sqlite3_8h.html#af6e738da0cab18033bfc290613d54d37">SQLITE_ATTACH</a> },
<a name="l01646"></a>01646   { <span class="stringliteral">&quot;DETACH&quot;</span>,     <a class="code" href="sqlite3_8h.html#a6e7e0bd673e34f1be10412263d2f0608">SQLITE_DETACH</a> },
<a name="l01647"></a>01647   { 0, 0 }
<a name="l01648"></a>01648 };
<a name="l01649"></a>01649 
<a name="l01650"></a>01650 
<a name="l01651"></a>01651 
<a name="l01652"></a>01652 
<a name="l01653"></a><a class="code" href="libluasqlite3_8h.html#ac05822c6ec829eba43e51df238aca83e">01653</a> <span class="keywordtype">int</span> <a class="code" href="libluasqlite3_8c.html#ac05822c6ec829eba43e51df238aca83e">luaopen_sqlite3</a>(<a class="code" href="structlua__State.html">lua_State</a> * L)
<a name="l01654"></a>01654 {
<a name="l01655"></a>01655   <a class="code" href="libluasqlite3_8c.html#ae16fcc70ad2cbf55b1906507bcb6fa33">f</a>(L, api_entries);
<a name="l01656"></a>01656   <a class="code" href="libluasqlite3_8c.html#a8d6141748244c12982deaaf0dafd7449">d</a>(L, error_entries);
<a name="l01657"></a>01657   <a class="code" href="libluasqlite3_8c.html#a8d6141748244c12982deaaf0dafd7449">d</a>(L, type_entries);
<a name="l01658"></a>01658   <a class="code" href="libluasqlite3_8c.html#a8d6141748244c12982deaaf0dafd7449">d</a>(L, auth_entries);
<a name="l01659"></a>01659   
<a name="l01660"></a>01660   <span class="keywordflow">return</span> 4; <span class="comment">/* api, error codes, type codes, auth requests */</span>
<a name="l01661"></a>01661 }
<a name="l01662"></a>01662 
<a name="l01663"></a>01663 
<a name="l01664"></a>01664 
</pre></div></div>
<hr size="1">

<p style="text-align: right;">
  <a href="http://www.contextlogger.org/">ContextLogger2</a>&#8212;ContextLogger2 Logger Daemon Internals&#8212;<small>Generated on Mon May 2 13:49:54 2011 by&nbsp;<a href="http://www.doxygen.org/">Doxygen</a> 1.6.1</small>
</p>

</body>
</html>
